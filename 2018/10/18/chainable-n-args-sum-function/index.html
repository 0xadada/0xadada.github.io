<!DOCTYPE html><html><head><meta charSet="utf-8"/><title>An Interview Question: Write a chainable n-argument sum function</title><meta property="og:site_name" content="0xADADA"/><meta property="og:title" content="An Interview Question: Write a chainable n-argument sum function"/><meta name="twitter:title" content="An Interview Question: Write a chainable n-argument sum function"/><link rel="canonical" href="https://0xadada.pub/2018/10/18/chainable-n-args-sum-function/"/><meta property="og:url" content="https://0xadada.pub/2018/10/18/chainable-n-args-sum-function/"/><meta name="twitter:url" content="https://0xadada.pub/2018/10/18/chainable-n-args-sum-function/"/><meta name="twitter:card" content="summary"/><meta name="twitter:site" content="@0xadada"/><meta name="author" content="0xADADA"/><meta property="og:type" content="article"/><meta name="description" content="Writing a javascript function to sum multiple inputs with chainable invocation"/><meta name="og:description" content="Writing a javascript function to sum multiple inputs with chainable invocation"/><meta name="twitter:description" content="Writing a javascript function to sum multiple inputs with chainable invocation"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="icon" href="https://0xadada.pub/favicon.ico"/><link rel="home" href="https://0xadada.pub/"/><link rel="alternate" type="application/rss+xml" href="https://0xadada.pub//rss.xml" title="0xADADA"/><link rel="manifest" href="https://0xadada.pub/static/images/meta/0xadada.webmanifest"/><link rel="apple-touch-icon" href="https://0xadada.pub/static/images/meta/apple-touch-icon.png"/><link rel="icon" type="image/png" href="https://0xadada.pub/static/images/meta/favicon-32x32.png" sizes="32x32"/><link rel="icon" type="image/png" href="https://0xadada.pub/static/images/meta/favicon-16x16.png" sizes="16x16"/><link rel="mask-icon" href="https://0xadada.pub/static/images/meta/safari-pinned-tab.svg" color="#5bbad5"/><meta name="theme-color" content="#FDF9F0"/><meta name="pocket-site-verification" content="7431f135e23a84de547e5b79dab406"/><meta name="next-head-count" content="26"/><link rel="preload" href="/_next/static/css/49969f6af05533cc.css" as="style"/><link rel="stylesheet" href="/_next/static/css/49969f6af05533cc.css" data-n-g=""/><link rel="preload" href="/_next/static/css/e491c5ad83d0116a.css" as="style"/><link rel="stylesheet" href="/_next/static/css/e491c5ad83d0116a.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-514908bffb652963.js" defer=""></script><script src="/_next/static/chunks/framework-91d7f78b5b4003c8.js" defer=""></script><script src="/_next/static/chunks/main-22b044904a3f81e0.js" defer=""></script><script src="/_next/static/chunks/pages/_app-929aade252cc0f2b.js" defer=""></script><script src="/_next/static/chunks/392-e44e3e95fe0288b1.js" defer=""></script><script src="/_next/static/chunks/pages/%5Byear%5D/%5Bmonth%5D/%5Bday%5D/%5Bslug%5D-0a1229f9e6020688.js" defer=""></script><script src="/_next/static/5I7MVMELaaHfLsOy373bz/_buildManifest.js" defer=""></script><script src="/_next/static/5I7MVMELaaHfLsOy373bz/_ssgManifest.js" defer=""></script><script src="/_next/static/5I7MVMELaaHfLsOy373bz/_middlewareManifest.js" defer=""></script></head><body><div id="__next" data-reactroot=""><main class="layout_layout__Xf50c"><article class="hentry h-entry" lang="en-US"><header><h1 class="entry-title p-name">An Interview Question: Write a chainable n-argument sum function</h1><time class="byline_published__8ePA_ dt-published" dateTime="2018-10-18T11:13:00.000Z">Thursday October 18, 2018</time><br/><span class="byline_byline__jNP6Q h-card">by: <span class="author fn p-author p-name">0xADADA</span></span></header><div class="entry-content e-content"><p>I came across an interesting interview question, along the lines of</p>
<blockquote>
<p>"How would you make this work?"</p>
</blockquote>
<pre><code class="language-javascript">add(2, 5); // multiple arguments style
> 7
add(2)(5); // currying, a chained invocation style
> 7
add(1,2)(3,4) // both
> 10
</code></pre>
<p>I thought this was a very interesting question, so took some time to
implement a multi-argument / curried function.</p>
<p>Heres what I got:</p>
<p>A solution to the multiple argument style is straightforward, theres just the bit to
change <code>arguments</code> into an Array, and to handle the case when nothing is
passed in.</p>
<pre><code class="language-javascript">let sum = function() {
  let args = arguments.length ? Array.from(arguments) : [0]; // convert arguments to array for .reduce
  return args.reduce((acc, i) => (acc += i));
};
</code></pre>
<p>Now, to get chained invocation style to work, I used <code>bind</code> to generate a new function
that would be returned to the caller, allowing for chained invocation. The
tricky bit is to set the <code>valueOf</code> function to return the sum, so when checked
for a value, the function returns a number.</p>
<p>Thus:</p>
<pre><code class="language-javascript">let sum = function() {
  let args = arguments.length ? Array.from(arguments) : [0]; // see (a)
  let sum = args.reduce((acc, i) => (acc += i)); 
  let f = sum.bind(null, sum); // see (b)
  f.valueOf = () => sum; // see (c)
  return f;
};
/* (a)
 * [0, ...arguments] will convert arguments to an Array
 * to allow the `reduce`. It will also create an initial item
 * `0` to handle the case no arguments are passed in. Thus
 * making `sumChainable()` possible.
 *
 * (b)
 * Generate a nested arrow function that will be returned, and pass
 * the sum to it. This allows the return value of the function
 * to be invoked in a chain, each changed invocation passing
 * the sum of its caller. Thus `sumChainable()()` is possible.
 *
 * (c)
 * Setting the `valueOf()` function on the returned function to
 * return the sum allows the comparison operator `==` to check
 * the value of the function against a number. Thus making operations
 * like `sumChainable() == 0` and `sumChainable(1, 1) + 2 == 4` possible.
 */
</code></pre>
<p>We can clean up this code by using the <code>...</code> rest parameters.</p>
<pre><code class="language-javascript">function sum(...args) {
  const value = args.reduce((acc, a) => acc + a, 0);
  const f = sum.bind(null, value);
  f.valueOf = () => value;
  return f;
}
</code></pre>
<p>added a function to run test conditions, and defined some tests:</p>
<pre><code class="language-javascript">function test(conditions) {
  conditions.forEach(([msg, cFn], i) => {
    const result = cFn();
    console.log(`${i} ${result ? 'âœ…' : 'ðŸš«'} ${msg}`);
    console.assert(cFn(), msg);
  });
  console.log(`${conditions.length} tests completed`);
}

let conditions = [
  ['sum() returns 0', () => sum() == 0],
  ['sum()() returns 0', () => sum()() == 0],
  ['typeof sum() returns "function"', () => typeof sum() == 'function'],
  ['typeof sum().valueOf() returns "number"', () => typeof sum().valueOf() == 'number'],
  ['sum(0) returns 0', () => sum(0) == 0],
  ['sum(0)(0) returns 0', () => sum(0)(0) == 0],
  ['sum()(1) returns 1', () => sum()(1) == 1],
  ['sum(1,2) returns 3', () => sum(1,2) == 3],
  ['sum(1,2,3) returns 6', () => sum(1,2,3) == 6],
  ['sum(1,2,3)() returns 6', () => sum(1,2,3)() == 6],
  ['sum(1,2,3)(1) returns 7', () => sum(1,2,3)(1) == 7],
  ['sum(1,2,3)(1) returns 7', () => sum(1,2,3)(1) == 7],
  ['sum(1,2,3)(1,2) returns 9', () => sum(1,2,3)(1,2) == 9],
];

test(conditions); // run the tests
</code></pre>
<p>viola!</p>
<p>Future improvements would be to get strict equality <code>===</code> operator to recognize the result
as type <code>number</code> rather than type <code>function</code>, but Javascript doesn't have a way to override operations.
We can also change the API slightly by
invoking <code>.valueOf()</code> at the end of the invocation chain to yield a <code>number</code> primative value.</p>
<pre><code class="language-javascript">// test for strict equality using .valueOf()
console.log( `sum(1,2,3)(4,5)(6).valueOf()`, sum(1,2,3)(4,5)(6).valueOf() === 21 ? 'passed' : 'failed' );
</code></pre>
<p>future would would be to get working:</p>
<pre><code class="language-javascript">console.log( `typeof sumChainable(1) === 'number'`, typeof sumChainable(1) === `number` ? 'passed' : 'failed' );
</code></pre>
</div><footer class="license_copyright__KOT7N">This is licensed under a Creative Commons <!-- -->cc-by-nc-sa<!-- --> International License</footer></article></main><div class="layout_layout__Xf50c"><footer class="footer_footer__OT4Wn layout_layout__Xf50c"><p>Â© 2003-<!-- -->2023<!-- --> 0xADADA (unless otherwise noted.)<br/><a title="0xADADA" href="/">Home</a> <a href="/rss.xml">RSS</a> <span class="h-card"><a class="c-Meta u-email" rel="me" title="0xADADA" href="mailto:0xadada.pub@protonmail.com">Email</a> </span><a rel="me nofollow external noopener" title="0xADADA on Mastodon" href="https://freeradical.zone/@0xadada">Mastodon</a> <a rel="me nofollow external noopener" title="0xADADA on Twitter" href="https://twitter.com/0xadada">Twitter</a> <a rel="me nofollow external noopener" title="0xADADA on GitHub" href="https://github.com/0xadada">GitHub</a> <a rel="me nofollow external noopener" title="0xADADA on Goodreads" href="https://www.goodreads.com/review/list/60524683-0xadada?shelf=wanted">Goodreads</a> </p></footer></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"slugs":{"year":"2018","month":"10","day":"18","slug":"chainable-n-args-sum-function"},"title":"An Interview Question: Write a chainable n-argument sum function","metaDescription":"Writing a javascript function to sum multiple inputs with chainable invocation","metaKeywords":"javascript","date":1539861180000,"author":"0xADADA","content":"\u003cp\u003eI came across an interesting interview question, along the lines of\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\"How would you make this work?\"\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cpre\u003e\u003ccode class=\"language-javascript\"\u003eadd(2, 5); // multiple arguments style\n\u003e 7\nadd(2)(5); // currying, a chained invocation style\n\u003e 7\nadd(1,2)(3,4) // both\n\u003e 10\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eI thought this was a very interesting question, so took some time to\nimplement a multi-argument / curried function.\u003c/p\u003e\n\u003cp\u003eHeres what I got:\u003c/p\u003e\n\u003cp\u003eA solution to the multiple argument style is straightforward, theres just the bit to\nchange \u003ccode\u003earguments\u003c/code\u003e into an Array, and to handle the case when nothing is\npassed in.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-javascript\"\u003elet sum = function() {\n  let args = arguments.length ? Array.from(arguments) : [0]; // convert arguments to array for .reduce\n  return args.reduce((acc, i) =\u003e (acc += i));\n};\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eNow, to get chained invocation style to work, I used \u003ccode\u003ebind\u003c/code\u003e to generate a new function\nthat would be returned to the caller, allowing for chained invocation. The\ntricky bit is to set the \u003ccode\u003evalueOf\u003c/code\u003e function to return the sum, so when checked\nfor a value, the function returns a number.\u003c/p\u003e\n\u003cp\u003eThus:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-javascript\"\u003elet sum = function() {\n  let args = arguments.length ? Array.from(arguments) : [0]; // see (a)\n  let sum = args.reduce((acc, i) =\u003e (acc += i)); \n  let f = sum.bind(null, sum); // see (b)\n  f.valueOf = () =\u003e sum; // see (c)\n  return f;\n};\n/* (a)\n * [0, ...arguments] will convert arguments to an Array\n * to allow the `reduce`. It will also create an initial item\n * `0` to handle the case no arguments are passed in. Thus\n * making `sumChainable()` possible.\n *\n * (b)\n * Generate a nested arrow function that will be returned, and pass\n * the sum to it. This allows the return value of the function\n * to be invoked in a chain, each changed invocation passing\n * the sum of its caller. Thus `sumChainable()()` is possible.\n *\n * (c)\n * Setting the `valueOf()` function on the returned function to\n * return the sum allows the comparison operator `==` to check\n * the value of the function against a number. Thus making operations\n * like `sumChainable() == 0` and `sumChainable(1, 1) + 2 == 4` possible.\n */\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eWe can clean up this code by using the \u003ccode\u003e...\u003c/code\u003e rest parameters.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-javascript\"\u003efunction sum(...args) {\n  const value = args.reduce((acc, a) =\u003e acc + a, 0);\n  const f = sum.bind(null, value);\n  f.valueOf = () =\u003e value;\n  return f;\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eadded a function to run test conditions, and defined some tests:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-javascript\"\u003efunction test(conditions) {\n  conditions.forEach(([msg, cFn], i) =\u003e {\n    const result = cFn();\n    console.log(`${i} ${result ? 'âœ…' : 'ðŸš«'} ${msg}`);\n    console.assert(cFn(), msg);\n  });\n  console.log(`${conditions.length} tests completed`);\n}\n\nlet conditions = [\n  ['sum() returns 0', () =\u003e sum() == 0],\n  ['sum()() returns 0', () =\u003e sum()() == 0],\n  ['typeof sum() returns \"function\"', () =\u003e typeof sum() == 'function'],\n  ['typeof sum().valueOf() returns \"number\"', () =\u003e typeof sum().valueOf() == 'number'],\n  ['sum(0) returns 0', () =\u003e sum(0) == 0],\n  ['sum(0)(0) returns 0', () =\u003e sum(0)(0) == 0],\n  ['sum()(1) returns 1', () =\u003e sum()(1) == 1],\n  ['sum(1,2) returns 3', () =\u003e sum(1,2) == 3],\n  ['sum(1,2,3) returns 6', () =\u003e sum(1,2,3) == 6],\n  ['sum(1,2,3)() returns 6', () =\u003e sum(1,2,3)() == 6],\n  ['sum(1,2,3)(1) returns 7', () =\u003e sum(1,2,3)(1) == 7],\n  ['sum(1,2,3)(1) returns 7', () =\u003e sum(1,2,3)(1) == 7],\n  ['sum(1,2,3)(1,2) returns 9', () =\u003e sum(1,2,3)(1,2) == 9],\n];\n\ntest(conditions); // run the tests\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eviola!\u003c/p\u003e\n\u003cp\u003eFuture improvements would be to get strict equality \u003ccode\u003e===\u003c/code\u003e operator to recognize the result\nas type \u003ccode\u003enumber\u003c/code\u003e rather than type \u003ccode\u003efunction\u003c/code\u003e, but Javascript doesn't have a way to override operations.\nWe can also change the API slightly by\ninvoking \u003ccode\u003e.valueOf()\u003c/code\u003e at the end of the invocation chain to yield a \u003ccode\u003enumber\u003c/code\u003e primative value.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-javascript\"\u003e// test for strict equality using .valueOf()\nconsole.log( `sum(1,2,3)(4,5)(6).valueOf()`, sum(1,2,3)(4,5)(6).valueOf() === 21 ? 'passed' : 'failed' );\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003efuture would would be to get working:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-javascript\"\u003econsole.log( `typeof sumChainable(1) === 'number'`, typeof sumChainable(1) === `number` ? 'passed' : 'failed' );\n\u003c/code\u003e\u003c/pre\u003e\n","slug":"2018-10-18-chainable-n-args-sum-function","license":"cc-by-nc-sa"}},"__N_SSG":true},"page":"/[year]/[month]/[day]/[slug]","query":{"year":"2018","month":"10","day":"18","slug":"chainable-n-args-sum-function"},"buildId":"5I7MVMELaaHfLsOy373bz","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>