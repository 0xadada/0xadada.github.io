<!DOCTYPE html><html><head><meta charSet="utf-8"/><title>Animating SVG with CSS</title><meta property="og:site_name" content="0xADADA"/><meta property="og:title" content="Animating SVG with CSS"/><meta name="twitter:title" content="Animating SVG with CSS"/><link rel="canonical" href="https://0xadada.pub/2017/01/08/animating-avatar-svg/"/><meta property="og:url" content="https://0xadada.pub/2017/01/08/animating-avatar-svg/"/><meta name="twitter:url" content="https://0xadada.pub/2017/01/08/animating-avatar-svg/"/><meta name="twitter:card" content="summary"/><meta name="twitter:site" content="@0xadada"/><meta name="author" content="0xADADA"/><meta property="og:type" content="article"/><meta name="description" content="How to use SVG and CSS to create dynamic imagery"/><meta name="twitter:description" content="How to use SVG and CSS to create dynamic imagery"/><meta property="og:image" content="https://0xadada.pub//static/images/meta/apple-touch-icon.png"/><meta property="og:image:height" content="180"/><meta property="og:image:width" content="180"/><meta name="twitter:image:height" content="512"/><meta name="twitter:image:width" content="512"/><meta property="twitter:image" content="https://0xadada.pub//static/images/meta/apple-touch-icon.png"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="icon" href="https://0xadada.pub/favicon.ico"/><link rel="home" href="https://0xadada.pub/"/><link rel="manifest" href="https://0xadada.pub/static/images/meta/0xadada.webmanifest"/><link rel="apple-touch-icon" href="https://0xadada.pub/static/images/meta/apple-touch-icon.png"/><link rel="icon" type="image/png" href="https://0xadada.pub/static/images/meta/favicon-32x32.png" sizes="32x32"/><link rel="icon" type="image/png" href="https://0xadada.pub/static/images/meta/favicon-16x16.png" sizes="16x16"/><link rel="mask-icon" href="https://0xadada.pub/static/images/meta/safari-pinned-tab.svg" color="#5bbad5"/><meta name="msapplication-config" content="https://0xadada.pub/static/images/meta/browserconfig.xml"/><meta name="theme-color" content="#FDF9F0"/><meta name="pocket-site-verification" content="7431f135e23a84de547e5b79dab406"/><meta name="next-head-count" content="31"/><link rel="preload" href="/_next/static/css/74865e03e3a036b2.css" as="style"/><link rel="stylesheet" href="/_next/static/css/74865e03e3a036b2.css" data-n-g=""/><link rel="preload" href="/_next/static/css/e491c5ad83d0116a.css" as="style"/><link rel="stylesheet" href="/_next/static/css/e491c5ad83d0116a.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-514908bffb652963.js" defer=""></script><script src="/_next/static/chunks/framework-91d7f78b5b4003c8.js" defer=""></script><script src="/_next/static/chunks/main-22b044904a3f81e0.js" defer=""></script><script src="/_next/static/chunks/pages/_app-929aade252cc0f2b.js" defer=""></script><script src="/_next/static/chunks/929-712c4c3eb0b6b9a9.js" defer=""></script><script src="/_next/static/chunks/pages/%5Byear%5D/%5Bmonth%5D/%5Bday%5D/%5Bslug%5D-3cef77e4e2f15fd3.js" defer=""></script><script src="/_next/static/-Lps6Ixny622rUaWZR2S7/_buildManifest.js" defer=""></script><script src="/_next/static/-Lps6Ixny622rUaWZR2S7/_ssgManifest.js" defer=""></script><script src="/_next/static/-Lps6Ixny622rUaWZR2S7/_middlewareManifest.js" defer=""></script></head><body><div id="__next" data-reactroot=""><main class="layout_layout__Xf50c"><article class="hentry h-entry" lang="en-US"><header><h1 class="entry-title p-name">Animating SVG with CSS</h1><time class="byline_published__8ePA_ dt-published" dateTime="2017-01-08T14:12:00.000Z">Sunday January 8, 2017</time><br/><span class="byline_byline__jNP6Q h-card">by: <span class="author fn p-author p-name">0xADADA</span></span></header><div class="entry-content e-content"><p>I finally got around to converting my avatar from a raster graphic to a vector
format. I wanted to be able to animate the polygons using JavaScript and CSS.
Another great advantage of a vector format is how the format lends itself to
generate a PNG or JPG in any size.</p>
<h2>Massaging the SVG File Format</h2>
<p>First things first, I took the source image and ran it through the
<a href="https://snorpey.github.io/triangulation/">delaunay triangulation - image triangulation experiment</a>
software, experimenting with various values for blur, accuracy and point count.
The output of this software was a <code>512Kb</code> SVG file.</p>
<p>Next I opened the file in <a href="https://inkscape.org/en/">Inkscape</a>, a SVG vector
graphics editor to remove the polygons in the background, cleanup some awkward
polys and make a few minor adjustments. Inkscape adds a bunch of metadata and
additional properties to the raw SVG that can be cleaned up.</p>
<p>Once I was happy with the results of my tweaking in Inkscape, I saved the SVG
and opened it in <a href="https://jakearchibald.github.io/svgomg/">SVGOMG</a> a web-based
SVG optimization GUI for the <a href="https://github.com/svg/svgo">SVGO</a> suite of tools.
This tool will output a much smaller SVG file that is ready for either editing
or delivery over HTTP. In this case, the file was reduced to <code>312Kb</code> a 40%
reduction in file size, primarily by transforming point-based <code>&#x3C;polygon></code>
elements to the more concise to <code>&#x3C;path></code> element.</p>
<h2>Animation</h2>
<p>With the SVG file ready, I moved on to the action animation work.</p>
<p>The animation would be a series of CSS keyframes that would simply toggle the
opacity level to produce a flickering affect. The artwork begins with all
opacity set to <code>0</code> (transparent), and each keyframe incrementally toggles
opacity until the last frame finally sets it to <code>1</code>.</p>
<pre><code class="language-css">.p {
  /* each polygon "path" starts fully transparent */
  opacity: 0;
}

/* a set of keyframes that incrementally toggle opacity, this */
/* keyframes set is called "slide-into-place" */
@keyframes slide-into-place {
  0% {
    opacity: 1;
  }
  5% {
    opacity: 0;
  }
  15% {
    opacity: 1;
  }
  17% {
    opacity: 0;
  }
  50% {
    opacity: 1;
  }
  55% {
    opacity: 0;
  }
  60% {
    opacity: 1;
  }
  75% {
    opacity: 0.25;
  }
  85% {
    opacity: 0.85;
  }
  90% {
    opacity: 0;
  }
  95% {
    opacity: 0.25;
  }
  100% {
    opacity: 1;
  }
}
</code></pre>
<p>Every <code>&#x3C;path></code> in the SVG document is given a classname <code>p</code> (for path), I then
use javascript to get references to these paths, and simply add a new classname
<code>is-animated</code> to their <code>class</code> attribute. This classname will be used to attach
the keyframes to the SVG paths.</p>
<pre><code class="language-css">.p.is-animated {
  /* sets the keyframes to use for animation */
  animation-name: slide-into-place;
  /* pause before animation starts */
  animation-delay: 1s;
  animation-timing-function: ease;
  animation-direction: normal;
  /* Run the animation only once */
  animation-iteration-count: 1;
  animation-fill-mode: forwards;
}
</code></pre>
<p>To attach the keyframe animation to the SVG <code>&#x3C;path></code>, the only think necessary
is to add the <code>is-animated</code> classname to the element. We do this on <code>Line-A</code>.
This is done inside a loop that iterates over all the <code>&#x3C;path></code> elements.</p>
<p>If I just add the <code>is-animated</code> class to the element, all polygons will flicker
at the same time, looking like the entire image is flickering- which isn't what
I want. To address this, I need to randomize the start-time of when each polygon
begins flickering. This makes each polygon flicker on its own timeline. I get a
random number on <code>Line-B</code> and use that as a delay to begin the flickering.</p>
<p><code>path.style.animationDelay</code> (on <code>Line-C</code>) is used to wait for a randomized
timeout (<code>Line-B</code>) period before animation starts.</p>
<pre><code class="language-javascript">function init() {
  var paths = document.querySelectorAll("path"),
    i = 0,
    randTimeout = null;
  path = null;
  for (i = 0; i &#x3C; paths.length; i++) {
    let path = paths[i];
    randTimeout = Math.floor(Math.random() * (1500 - 1) + 1); // Line-B
    path.style.animationDelay = randTimeout + "ms"; // Line-C
    path.classList.add("is-animated"); // Line-A
  }
}
</code></pre>
<p>The above <code>init()</code> function is called once the SVG document has finished
loading.</p>
<pre><code class="language-html">&#x3C;svg
  xmlns="http://www.w3.org/2000/svg"
  viewbox="0 0 660 660"
  onload="init()"
>&#x3C;/svg>
</code></pre>
<h2>Result</h2>
<p><object type="image/svg+xml" data="/static/images/meta/avatar-animated.svg"
height="660" width="660"> </object> <em>(Reload the page to view the animation
again)</em></p>
</div><footer class="license_copyright__KOT7N">This is licensed under a Creative Commons <!-- -->cc-by-nc-sa<!-- --> International License</footer></article></main><div class="layout_layout__Xf50c"><footer class="footer_footer__OT4Wn layout_layout__Xf50c"><p>Â© 2003-<!-- -->2022<!-- --> 0xADADA (unless otherwise noted.)<br/><a title="0xADADA" href="/">Home</a> <span class="h-card"><a class="c-Meta u-email" rel="me" title="0xADADA" href="mailto:0xadada.pub@protonmail.com">Email</a> </span><a rel="me nofollow external noopener" title="0xADADA on Twitter" href="https://twitter.com/0xadada">Twitter</a> <a rel="me nofollow external noopener" title="0xADADA on GitHub" href="https://github.com/0xadada">GitHub</a> <a rel="me nofollow external noopener" title="0xADADA on Goodreads" href="https://www.goodreads.com/review/list/60524683-0xadada?shelf=wanted">Goodreads</a> </p></footer></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"slugs":{"year":"2017","month":"01","day":"08","slug":"animating-avatar-svg"},"title":"Animating SVG with CSS","displayTitle":"Animating SVG with CSS","metaDescription":"How to use SVG and CSS to create dynamic imagery","metaKeywords":"graphics, vector, animation, css","metaImage":"/static/images/meta/apple-touch-icon.png","date":1483884720000,"author":"0xADADA","content":"\u003cp\u003eI finally got around to converting my avatar from a raster graphic to a vector\nformat. I wanted to be able to animate the polygons using JavaScript and CSS.\nAnother great advantage of a vector format is how the format lends itself to\ngenerate a PNG or JPG in any size.\u003c/p\u003e\n\u003ch2\u003eMassaging the SVG File Format\u003c/h2\u003e\n\u003cp\u003eFirst things first, I took the source image and ran it through the\n\u003ca href=\"https://snorpey.github.io/triangulation/\"\u003edelaunay triangulation - image triangulation experiment\u003c/a\u003e\nsoftware, experimenting with various values for blur, accuracy and point count.\nThe output of this software was a \u003ccode\u003e512Kb\u003c/code\u003e SVG file.\u003c/p\u003e\n\u003cp\u003eNext I opened the file in \u003ca href=\"https://inkscape.org/en/\"\u003eInkscape\u003c/a\u003e, a SVG vector\ngraphics editor to remove the polygons in the background, cleanup some awkward\npolys and make a few minor adjustments. Inkscape adds a bunch of metadata and\nadditional properties to the raw SVG that can be cleaned up.\u003c/p\u003e\n\u003cp\u003eOnce I was happy with the results of my tweaking in Inkscape, I saved the SVG\nand opened it in \u003ca href=\"https://jakearchibald.github.io/svgomg/\"\u003eSVGOMG\u003c/a\u003e a web-based\nSVG optimization GUI for the \u003ca href=\"https://github.com/svg/svgo\"\u003eSVGO\u003c/a\u003e suite of tools.\nThis tool will output a much smaller SVG file that is ready for either editing\nor delivery over HTTP. In this case, the file was reduced to \u003ccode\u003e312Kb\u003c/code\u003e a 40%\nreduction in file size, primarily by transforming point-based \u003ccode\u003e\u0026#x3C;polygon\u003e\u003c/code\u003e\nelements to the more concise to \u003ccode\u003e\u0026#x3C;path\u003e\u003c/code\u003e element.\u003c/p\u003e\n\u003ch2\u003eAnimation\u003c/h2\u003e\n\u003cp\u003eWith the SVG file ready, I moved on to the action animation work.\u003c/p\u003e\n\u003cp\u003eThe animation would be a series of CSS keyframes that would simply toggle the\nopacity level to produce a flickering affect. The artwork begins with all\nopacity set to \u003ccode\u003e0\u003c/code\u003e (transparent), and each keyframe incrementally toggles\nopacity until the last frame finally sets it to \u003ccode\u003e1\u003c/code\u003e.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-css\"\u003e.p {\n  /* each polygon \"path\" starts fully transparent */\n  opacity: 0;\n}\n\n/* a set of keyframes that incrementally toggle opacity, this */\n/* keyframes set is called \"slide-into-place\" */\n@keyframes slide-into-place {\n  0% {\n    opacity: 1;\n  }\n  5% {\n    opacity: 0;\n  }\n  15% {\n    opacity: 1;\n  }\n  17% {\n    opacity: 0;\n  }\n  50% {\n    opacity: 1;\n  }\n  55% {\n    opacity: 0;\n  }\n  60% {\n    opacity: 1;\n  }\n  75% {\n    opacity: 0.25;\n  }\n  85% {\n    opacity: 0.85;\n  }\n  90% {\n    opacity: 0;\n  }\n  95% {\n    opacity: 0.25;\n  }\n  100% {\n    opacity: 1;\n  }\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eEvery \u003ccode\u003e\u0026#x3C;path\u003e\u003c/code\u003e in the SVG document is given a classname \u003ccode\u003ep\u003c/code\u003e (for path), I then\nuse javascript to get references to these paths, and simply add a new classname\n\u003ccode\u003eis-animated\u003c/code\u003e to their \u003ccode\u003eclass\u003c/code\u003e attribute. This classname will be used to attach\nthe keyframes to the SVG paths.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-css\"\u003e.p.is-animated {\n  /* sets the keyframes to use for animation */\n  animation-name: slide-into-place;\n  /* pause before animation starts */\n  animation-delay: 1s;\n  animation-timing-function: ease;\n  animation-direction: normal;\n  /* Run the animation only once */\n  animation-iteration-count: 1;\n  animation-fill-mode: forwards;\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eTo attach the keyframe animation to the SVG \u003ccode\u003e\u0026#x3C;path\u003e\u003c/code\u003e, the only think necessary\nis to add the \u003ccode\u003eis-animated\u003c/code\u003e classname to the element. We do this on \u003ccode\u003eLine-A\u003c/code\u003e.\nThis is done inside a loop that iterates over all the \u003ccode\u003e\u0026#x3C;path\u003e\u003c/code\u003e elements.\u003c/p\u003e\n\u003cp\u003eIf I just add the \u003ccode\u003eis-animated\u003c/code\u003e class to the element, all polygons will flicker\nat the same time, looking like the entire image is flickering- which isn't what\nI want. To address this, I need to randomize the start-time of when each polygon\nbegins flickering. This makes each polygon flicker on its own timeline. I get a\nrandom number on \u003ccode\u003eLine-B\u003c/code\u003e and use that as a delay to begin the flickering.\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003epath.style.animationDelay\u003c/code\u003e (on \u003ccode\u003eLine-C\u003c/code\u003e) is used to wait for a randomized\ntimeout (\u003ccode\u003eLine-B\u003c/code\u003e) period before animation starts.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-javascript\"\u003efunction init() {\n  var paths = document.querySelectorAll(\"path\"),\n    i = 0,\n    randTimeout = null;\n  path = null;\n  for (i = 0; i \u0026#x3C; paths.length; i++) {\n    let path = paths[i];\n    randTimeout = Math.floor(Math.random() * (1500 - 1) + 1); // Line-B\n    path.style.animationDelay = randTimeout + \"ms\"; // Line-C\n    path.classList.add(\"is-animated\"); // Line-A\n  }\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThe above \u003ccode\u003einit()\u003c/code\u003e function is called once the SVG document has finished\nloading.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-html\"\u003e\u0026#x3C;svg\n  xmlns=\"http://www.w3.org/2000/svg\"\n  viewbox=\"0 0 660 660\"\n  onload=\"init()\"\n\u003e\u0026#x3C;/svg\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eResult\u003c/h2\u003e\n\u003cp\u003e\u003cobject type=\"image/svg+xml\" data=\"/static/images/meta/avatar-animated.svg\"\nheight=\"660\" width=\"660\"\u003e \u003c/object\u003e \u003cem\u003e(Reload the page to view the animation\nagain)\u003c/em\u003e\u003c/p\u003e\n","slug":"2017-01-08-animating-avatar-svg","license":"cc-by-nc-sa"}},"__N_SSG":true},"page":"/[year]/[month]/[day]/[slug]","query":{"year":"2017","month":"01","day":"08","slug":"animating-avatar-svg"},"buildId":"-Lps6Ixny622rUaWZR2S7","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>