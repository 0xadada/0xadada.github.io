<!DOCTYPE html><html><head><meta charSet="utf-8"/><title>JavaScript The Good Parts</title><meta property="og:site_name" content="0xADADA"/><meta property="og:title" content="JavaScript The Good Parts"/><meta name="twitter:title" content="JavaScript The Good Parts"/><link rel="canonical" href="https://0xadada.pub/2015/11/15/javascript-the-good-parts/"/><meta property="og:url" content="https://0xadada.pub/2015/11/15/javascript-the-good-parts/"/><meta name="twitter:url" content="https://0xadada.pub/2015/11/15/javascript-the-good-parts/"/><meta name="twitter:card" content="summary"/><meta name="twitter:site" content="@0xadada"/><meta name="author" content="0xADADA"/><meta property="og:type" content="article"/><meta name="description" content="Javascript The Good Parts notes"/><meta name="og:description" content="Javascript The Good Parts notes"/><meta name="twitter:description" content="Javascript The Good Parts notes"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="icon" href="https://0xadada.pub/favicon.ico"/><link rel="home" href="https://0xadada.pub/"/><link rel="manifest" href="https://0xadada.pub/static/images/meta/0xadada.webmanifest"/><link rel="apple-touch-icon" href="https://0xadada.pub/static/images/meta/apple-touch-icon.png"/><link rel="icon" type="image/png" href="https://0xadada.pub/static/images/meta/favicon-32x32.png" sizes="32x32"/><link rel="icon" type="image/png" href="https://0xadada.pub/static/images/meta/favicon-16x16.png" sizes="16x16"/><link rel="mask-icon" href="https://0xadada.pub/static/images/meta/safari-pinned-tab.svg" color="#5bbad5"/><meta name="msapplication-config" content="https://0xadada.pub/static/images/meta/browserconfig.xml"/><meta name="theme-color" content="#FDF9F0"/><meta name="pocket-site-verification" content="7431f135e23a84de547e5b79dab406"/><meta name="next-head-count" content="26"/><link rel="preload" href="/_next/static/css/d0809774977ec038.css" as="style"/><link rel="stylesheet" href="/_next/static/css/d0809774977ec038.css" data-n-g=""/><link rel="preload" href="/_next/static/css/e491c5ad83d0116a.css" as="style"/><link rel="stylesheet" href="/_next/static/css/e491c5ad83d0116a.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-514908bffb652963.js" defer=""></script><script src="/_next/static/chunks/framework-91d7f78b5b4003c8.js" defer=""></script><script src="/_next/static/chunks/main-22b044904a3f81e0.js" defer=""></script><script src="/_next/static/chunks/pages/_app-929aade252cc0f2b.js" defer=""></script><script src="/_next/static/chunks/392-e44e3e95fe0288b1.js" defer=""></script><script src="/_next/static/chunks/pages/%5Byear%5D/%5Bmonth%5D/%5Bday%5D/%5Bslug%5D-1dbbc016bd444fa6.js" defer=""></script><script src="/_next/static/MUtJuWnFmWCac3DQ1Ahc9/_buildManifest.js" defer=""></script><script src="/_next/static/MUtJuWnFmWCac3DQ1Ahc9/_ssgManifest.js" defer=""></script><script src="/_next/static/MUtJuWnFmWCac3DQ1Ahc9/_middlewareManifest.js" defer=""></script></head><body><div id="__next" data-reactroot=""><main class="layout_layout__Xf50c"><article class="hentry h-entry" lang="en-US"><header><h1 class="entry-title p-name">JavaScript The Good Parts</h1><time class="byline_published__8ePA_ dt-published" dateTime="2015-11-15T17:11:00.000Z">Sunday November 15, 2015</time><br/><span class="byline_byline__jNP6Q h-card">by: <span class="author fn p-author p-name">0xADADA</span></span></header><div class="entry-content e-content"><p><em>Notes from the book: JavaScript: The Good Parts by Douglas Crockford</em></p>
<h2>Index</h2>
<ul>
<li><a href="#javascript-the-good-parts">JavaScript: The Good Parts</a>
<ul>
<li><a href="#primitives">Primitives</a></li>
<li><a href="#execution-flow">Execution Flow</a></li>
<li><a href="#equality">Equality</a></li>
<li><a href="#loops--enumeration">Loops / Enumeration</a></li>
<li><a href="#object-literals">Object Literals</a></li>
<li><a href="#arrays">Arrays</a></li>
<li><a href="#delete">Delete</a></li>
<li><a href="#global-abatement">Global Abatement</a></li>
<li><a href="#reference">Reference</a></li>
<li><a href="#reflection">Reflection</a></li>
<li><a href="#functions">Functions</a></li>
<li><a href="#prototype">Prototype</a></li>
<li><a href="#function-invocation-pattern">Function Invocation Pattern</a></li>
<li><a href="#constructor-invocation-pattern">Constructor Invocation pattern</a></li>
<li><a href="#closure">Closure</a></li>
</ul>
</li>
<li><a href="#modules">Modules</a></li>
<li><a href="#wtf">WTF</a></li>
</ul>
<h2>JavaScript: The Good Parts</h2>
<p>A walkthrough many of the useful code examples from Douglas Crockfords' seminal
book,
<a href="http://shop.oreilly.com/product/9780596517748.do">JavaScript: The Good Parts</a>.</p>
<h3>Primitives</h3>
<p>JavaScript Reserved words:</p>
<pre><code class="language-javascript">abstract
boolean break byte
case catch char class const continue
debugger default delete do double
else enum export extends
false final finally float for function
goto
if implements import in instanceof int interface
long
native new null
package private protected public
return
short static super switch synchronized
this throw throws transient true try typeof
var volatile void
while with
</code></pre>
<p>Simple types</p>
<pre><code class="language-javascript">// Numbers: 1, 1.1, 1e10, 1e+10,
// Strings: "Hello", 'hello'
// Booleans: true, false
// null
// undefined
// Object
</code></pre>
<p>Built in values</p>
<pre><code class="language-javascript">true
false
null
undefined
NaN
Infinity
</code></pre>
<p>JavaScript represents all numbers internally as a 64-bit floating point value
(like Java's <code>double</code>).</p>
<pre><code class="language-javascript">// integer
1 === 1.0  // true

// fraction
.1 === 0.1 // true

// exponent: value is calculated by multiplying the part before the
// e by 10 raised to the power of the part after the e.
(1*10) * (1*10) === 1e2 // true
1e2 === 100 // true

// Infinity represents all values greater than:
1.79769313486231570e+103
typeof Infinity === 'number'; // true
</code></pre>
<p>Numbers, strings and booleans are object like in that they have methods, but
they are immutable.</p>
<p>Arrays, functions, regular expressions and objects are Objects. A simple object:</p>
<pre><code class="language-javascript">// simple object literal
var an_object = {};
// simple object literal with 2 values (comma-separated)
var another_object = {
  'my_value': 3.1,
  'your_value': 3.2
};
another_object.my_value == 3.1; // true

// attempts to access undefined properties will throw TypeError
another_object.fake.my_value // Throws TypeError
// Prevent TypeError by testing that all attributes exist before accessing
another_object.test &#x26;&#x26; another_object.test.test || "none" // "none"
</code></pre>
<p>Objects are class-free, which is to say that there is no constraint on the names
of its properties or their values. The object doesn't need to be defined before
it is instantiated.</p>
<p>JavaScript has prototype linkage, meaning an object can inherit the properties
of another object. This can be used to reduce object initialization time, memory
consumption and increase code reuse.</p>
<h3>Execution Flow</h3>
<p>Execution and flow statements.</p>
<pre><code class="language-javascript">// Conditional statements: if and switch
// Looping statements: do, for, while
// Disruptive statements: break, continue, return, throw
</code></pre>
<p>Falsy values. When conditional expressions evaluate to these values, the
expression will result in <code>false</code>.</p>
<pre><code class="language-javascript">false
null
undefined
''         // empty  string
0
NaN
</code></pre>
<p>Operators and statements of equality.</p>
<pre><code class="language-javascript">// Operator precedence
. [] ()                   // Refinement and invocation
delete new typeof + - !   // Unary operators
* / %                     // Multiplication, division, remainder
+ -                       // Addition/concatenation, subtraction
>= &#x3C;= > &#x3C;                 // Inequality
=== !==                   // Equality
&#x26;&#x26;                        // Logical and
||                        // Logical or
? :                       // Ternary
</code></pre>
<p>NaN</p>
<pre><code class="language-javascript">// NaN is a number value that is the result of an operation that
// cannot produce a normal result. It is not equal to anything else,
// including itself.
NaN == NaN;  // false
NaN === NaN; // false

// Use isNaN to detect if a value is NaN
isNaN(NaN);  // true
</code></pre>
<h3>Equality</h3>
<p>Rule of thumb, the following expressions are all false using <code>===</code> or <code>!==</code> so
use these operators instead.</p>
<pre><code class="language-javascript">'c' + 'a' + 't' === 'cat'; // true
'' == '0';                 // false
0 == '';                   // true, both are falsy
0 == '0';                  // true
false == 'false';          // false
false == '0';              // true
false == undefined;        // false
false == null;             // false
null == undefined;         // true
</code></pre>
<h3>Loops / Enumeration</h3>
<p>The <code>for in</code> statement can loop over all properties of an object, but will
include all object types (including functions) as well as all objects along the
prototype chain. The <code>for in</code> operator enumerates the property names on an
object.</p>
<pre><code class="language-javascript">var animal_names = {
    'dog': 'Piper',
    'cat': 'Snookins',
    'goat': 'Mr J'
};
for( var animal in animal_names ) {
    console.log( animal, animal_names[animal] );
}
> dog Piper
> cat Snookins
> goat Mr J
</code></pre>
<p>It is important to know the names can be in any order and can be any type
including functions.</p>
<h3>Object literals</h3>
<p>Object literal - pair of curly braces surrounding zero or more name: value
pairs.</p>
<pre><code class="language-javascript">var empty_object = {};
var stooge = {
    "first_name" : "Jerome",
    "last_name" : "Howard",
    'nickname' : 'Jer'
};
var jer1 = stooge['first_name'];
console.log(jer1);  // "Jerome"
var jer2 = stooge.first_name;
console.log(jer2); // "Jerome"
var jer3 = stooge.favorite &#x26;&#x26; stooge.favorite.color; // return undefined
console.log(jer3); // undefined
</code></pre>
<h3>Arrays</h3>
<p>Arrays have a length property.</p>
<pre><code class="language-javascript">var empty = [];
var numbers = [
    'zero', 'one', 'two', 'three', 'four', 'five', 'six', 'seven',
    'eight', 'nine'
];
empty.length
> 0
numbers.length
> 10
</code></pre>
<p>Objects have no length property</p>
<pre><code class="language-javascript">var numbers_object = {
    '0': 'zero',
    '1': 'one',
    '2': 'two',
    '3': 'three',
    '4': 'four',
    '5': 'five',
    '6': 'six',
    '7': 'seven',
    '8': 'eight',
    '9': 'nine'
};
numbers_object.length
> undefined

var myArray = [];
myArray.length
> 0
</code></pre>
<p>Arbitrary array indexes can be set, although there may not be items populating
the array before it.</p>
<pre><code class="language-javascript">// myArray = [];
myArray[1001] = true; // create and set value of index 1001 to true
console.log(myArray.length); // 1002 OMG!!

var arrayItemCount = 0;
for(var item in myArray) {
    arrayItemCount += 1;
}
console.log('myArray counted items: ' + arrayItemCount);
</code></pre>
<p>To delete from an array, use <code>Array.splice()</code>. This function takes 3 arguments,
<code>start</code> the index to start adding/removing items, <code>deleteCount</code> the number of
items to remove/replace, and finally n-arguments for the addition n-items to add
to the array.</p>
<pre><code class="language-javascript">var animals = ['cat', 'dog', 'pork', 'pig', 'fish'];

// remove 'pork'
a.splice(2,1)
// removed 'pork'
a
> ['cat', 'dog', 'pig', 'fish']

// add 'snake' before item 2.
a.splice(2,0,'snake')
> ['cat', 'dog', 'snake', 'pig', 'fish']
</code></pre>
<p>viola!</p>
<h3>Delete</h3>
<p>The <code>delete</code> operator removes a property from an object. If will not remove the
property if it only exists on parent objects along the prototype chain. It is
useful for removing the property from a leaf object so that the property along
the prototype chain is used.</p>
<h3>Global Abatement</h3>
<p>Global variables in general weaken the portability and resiliency of programs,
but in the case they're necessary, aim to limit them to a single global
variable. This is done by attaching all properties to a single global variable.</p>
<pre><code class="language-javascript">var MYAPP = {};
MYAPP.views = {};
</code></pre>
<p>This will reduce namespace or scope collisions with other applications or
libraries.</p>
<h3>Reference</h3>
<p>JavaScript passes objects around by reference, never by value.</p>
<pre><code class="language-javascript">var x = {
    fn: 'Jerome',
    ln: 'Howard',
    nn: 'Jer'
};
var y = x.nn; // new variable value: 'Jer'
x.nn = 'curly';
console.log(y); // 'curly'
</code></pre>
<h3>Reflection</h3>
<p>Reflection is the ability of a program to introspect is own code at runtime.</p>
<p>Javascript offers the <code>typeof</code> operator to check the type of a property, and
<code>hasOwnProperty()</code> which return true if the property exists directly on an
object, false if it does not (and possibly exists up the prototype chain.)</p>
<pre><code class="language-javascript">var a_var = "a message";
typeof a_var;
> 'string'

var an_object = {
    a_prop: true;
};
an_object.hasOwnProperty('a_prop');
> true
</code></pre>
<h3>Functions</h3>
<blockquote>
<p>"The craft of programming is the factoring of a set of requirements into a set
of functions and data structures." <cite>Douglas Crockford</cite></p>
</blockquote>
<p>Functions encapsulate a set of statements. They enable code reuse, information
hiding and behavior composition.</p>
<p>Functions in JavaScript are objects. Objects are collections of name-value pairs
that have a hidden prototype link to <code>Object.prototype</code>. The Objects produced
from object literals are linked to <code>Object.prototype</code>. Function objects are
linked to <code>Function.prototype</code>– which is linked to <code>Object.prototype</code>.
Functions are also created with two additional hidden properties: the function's
execution context (lexical scope) and the source code that implements the
function.</p>
<p>Functions have a <code>prototype</code> property whos value is an object with a
<code>constructor</code> property whos value is the function. This is distinct from the
hidden link to <code>Function.prototype</code>. [](#ToDo: this needs to be fleshed-out in
more detail)</p>
<p>When invoked, functions receive two additional parameters: <code>this</code> and
<code>arguments</code>. The value of <code>this</code> depends on how the function was invoked
(invoked as method, invoked as function, invoked as constructor, and invoked as
apply). The value of <code>arguments</code> is an array-like object (in that the object has
a <code>length</code> property) of all parameters passed to the function when invoked.</p>
<h4>Method Invocation Pattern</h4>
<p>When a function is created as a property of an object, it is called a method.
When a method is invoked, it is bound to the object it is a property of. You can
tell a function is invoked as a method when it uses a refinement; a <code>.</code> notation
to call the function.</p>
<p>Functions invoked as a method can access the bound object using the <code>this</code>
reference to access other properties and values on that object. The methods
<code>this</code> object is late-bound at function invocation time. This makes methods that
make references to <code>this</code> more portable. These type of objects are called public
methods.</p>
<pre><code class="language-javascript">var myObj = {
  value: 2,
  increment: function(inc) {
    this.value += typeof inc === "number" ? inc : 1;
  }
};
</code></pre>
<p>The binding of <code>this</code> happens very late, at invocation time. A method can use
<code>this</code> to retrieve values from the object, or modify the object.</p>
<p>Crockford introduces the <code>method</code> method, it is used throughout the book to
define new methods on existing objects. Crockford attaches it to the <code>Function</code>
prototype, so it is available to all objects.</p>
<pre><code class="language-javascript">Function.prototype.method = function(name, func) {
  this.prototype[name] = func;
  return this;
};
</code></pre>
<p>A use of the <code>method</code> method would be to define a new function <code>predictLength</code>
on the String object. This function will return the predicted length a string
when concatenated with the existing string.</p>
<pre><code class="language-javascript">// use Crockfords' `method` method on the `String` object.
String.method("predictLength", function(arg) {
  var len = this.length,
argLen = arg.len,
nextLen = len + argLen;
  var message = "Predicted length is %0 for string '%1'"
    .replace("%0", nextLen)
    .replace("%1", arg);
  console.log(message);
  return nextLen;
});
</code></pre>
<h4>Function Invocation Pattern</h4>
<p>When a function is not a property of an object, it is invoked directly as a
function:</p>
<pre><code class="language-javascript">var sum = add(3, 4);
</code></pre>
<p>Any function invoked in this pattern, the <code>this</code> value is bound to the global
object. This becomes confusing for many developers when defining objects with
sub-functions that expect the value of the <code>this</code> value to refer to the
containing object. A example of problematic code illustrates:</p>
<pre><code class="language-javascript">var brokenObj = {
  value: 2,
  double: function() {
  var helper = function() {
    // broken, the value of `this` in `this.value` refers to the global
    // Object, not `brokenObj`.
    this.value = this.value * 2; // fails, global Object.value set to NaN
};
helper();
  }
};
</code></pre>
<h4>Constructor Invocation Pattern</h4>
<p>If a function is invoked with the <code>new</code> prefix e.g.
<code>var x = new Status('confused')</code>, then a new object is created and returned with
a link to the value of the function's <code>prototype</code> property. The value of <code>this</code>
is bound to the new object.</p>
<pre><code class="language-javascript">var Status = function(status) {
  this.status = status;
  this.valueOf = function() {
    console.info(`status ${this.status}`);
    return this.status;
  };
};
var happy = new Status("happy");
typeof Status === "function"; // true
typeof happy === "object";    // true
happy.valueOf() === "happy";  // true
("status happy");
true;
</code></pre>
<h4>Apply Invocation Pattern</h4>
<p>The <code>apply</code> method is available on every function. In the constructor invocation
pattern above, the <code>valueOf</code> method was bound to the local object. Instead, the
the <code>apply</code> method allows the developer supply an arbitrary value for <code>this</code>, in
effect allowing the developer to apply the method to any object rather than to
the object it is currently bound too.</p>
<pre><code class="language-javascript">var DoMath = function(x, y) {
  this.x = x;
  this.y = y;
  this.sum = function() {
    return this.x + this.y;
  };
};
var oneTwo = new DoMath(1, 2);
oneTwo.sum() === 3; // true

// now we can force sum() to reference an object that we pass to the apply() method
var threeFour = {
  x: 3,
  y: 4
};
oneTwo.sum.apply(threeFour, null);
7;
</code></pre>
<h3>Prototype</h3>
<p>Every object is linked to a prototype from which it inherits properties. All
objects created with object literal syntax are linked to <code>Object.prototype</code>.
When creating new objects, we can select which object it inherits from. We can
use a method named <code>Object.create</code> to implement this behavior.</p>
<p><code>Object.create</code></p>
<pre><code class="language-javascript">if( typeof Object.create !== 'function') {
    Object.create = function(o) {
        var F = function() {};
        F.prototype = o;
        return new F();
    }
}
</code></pre>
<p>The prototype link is used only in retrieval. If we try to retrieve a property
value from an object, it will either return the value on the object itself, or
look up to <strong>its</strong> prototype, and so on, until the lookup finds the property or
<code>undefined</code> is returned if nowhere along the prototype chain nor
<code>Object.prototype</code> has the property. This is called prototype retrieval
delegation.</p>
<p>If properties are added to a prototype, all children of that prototype will
immediately be available.</p>
<p>To determine if an object has a property directly, without invoking the
prototype chain, use <code>hasOwnProperty</code>.</p>
<pre><code class="language-javascript">var ob = {};
ob.hasOwnProperty('newProperty');
> false
eb.newProperty = "a value";
ob.hasOwnProperty('newProperty');
> true
</code></pre>
<p>Prototypal inheritance</p>
<pre><code class="language-javascript">// differential inheritance
var Mammal = {
    name: 'A Mammal',
    says: 'Noise',
    get_name: function() {
        return this.name;
    },
    speak: function() {
        return this.says || '';
    }
};
var myCat = Object.create(Mammal);
myCat.name = 'Henrietta';
myCat.says = 'meow';
myCat.purr = function(n) {
    var i,
        s = '';
    for(i = 0; i &#x3C; n; i += 1) {
        if(s) {
            s += '-';
        }
        s += 'r';
    }
    return s;
};
myCat.get_name = function() {
    return this.speak() + ' ' + this.name + ' ' + this.speak();
};
</code></pre>
<p>For-in loops</p>
<pre><code class="language-javascript">var stooge_2 = Object.create(stooge);
stooge_2.first_name = 'Harry';
stooge_2.last_name = 'Moses';
stooge_2.nickname = 'John';
for(var name in stooge_2) {
    console.log( stooge_2[name] );
}

delete stooge_2.nickname;
console.log(stooge_2.nickname); // 'curly'

// Method invocation pattern
console.log('===== Method invocation pattern ====');
var myObject = {
    value: 0,
    increment: function(inc) {
        this.value += typeof inc === 'number' ? inc : 1;
    }
};

myObject.increment();
console.log(myObject.value); // 1
myObject.increment(2);
console.log(myObject.value); // 3
</code></pre>
<h3>Function invocation pattern</h3>
<pre><code class="language-javascript">myObject.double = function() {
    var that = this;  // global this mis-assignment fix
    var helper = function() {
        that.value = that.value * 2;
    };
    helper(); // invoke helper as a function
};
// invoke double as a method
myObject.double();
myObject.value
> 6
</code></pre>
<h3>Constructor Invocation pattern</h3>
<pre><code class="language-javascript">var Quo = function(string) {
    this.status = string;
};
Quo.prototype.get_status = function() {
    return this.status;
};
var myQuo = new Quo('confused');
console.log(myQuo.get_status()); // 'confused'

// Apply Invocation pattern
console.log('===== Apply Invocation pattern =====');
var statusObject = {
    status: 'A-OK'
};
// invoke the get_status method from Quo on our statusObject
var status = Quo.prototype.get_status.apply(statusObject);
console.log(status); // 'A-OK'

// Function Parameters
console.log('===== Function Parameters =====');
var sum = function() {
    var i, sum = 0;
    for(i = 0; i &#x3C; arguments.length; i += 1) {
        sum += arguments[i];
    }
    return sum;
};
console.log( sum(4,8,15,16,23,42) ); // 108

// Exceptions
var add = function(a, b) {
    if(typeof a !== 'number' || typeof b !== 'number') {
       throw { // throw an object with a name and message property
           name: 'TypeError',
           message: 'add need numbers'
       };
    }
    debugger;
    return a + b;
};
var try_it = function() {
    try {
        add("seven");
    } catch(e) {
        console.log('name: ' + e.name + ' msg: ' + e.message);
    }
}
try_it();
</code></pre>
<p>Object augmentation</p>
<pre><code class="language-javascript">Function.prototype.method = function(name, func) {
    // add arbitrary functions with name name to our Object.
    this.prototype[name] = func;
    return this;
};
Number.method('integer', function() {
    return Math[this &#x3C; 0 ? 'ceil' : 'floor'](this);
});
console.log( (-10/3).integer() ); // -3
</code></pre>
<h3>Lexical Scope</h3>
<p>Lexical scope is the availability of variables to an executing block of code.
JavaScript lexical scope is determined by resolving objects in the immediate
lexical scope, then moving up the chain until it reaches the variables defined
in the global scope.</p>
<pre><code class="language-javascript">var foo = function() {
    var a = 3,
        b = 5;
    var bar = function() {
        var b = 7,  // define local b
            c = 11; // define local c
        // a = 3, b = 7, c = 11
        console.log('a', a, 'b', b, 'c', c);
        a += b + c; // 3 + 7 + 11
        // a = 21, b = 7, c = 11
        console.log('a', a, 'b', b, 'c', c);
    };
    // now: a = 3, b = 5, c = undefined
    console.log('a', a, 'b', b);
    bar();
    // a = 21, b = 5
    console.log('a', a, 'b', b);
};
foo();
> a 3 b 5
> a 3 b 7 c 11
> a 21 b 7 c 11
> a 21 b 5
</code></pre>
<h3>Closure</h3>
<p>A closure is a reference to a function as well as the runtime environment of the
function. This includes any variables within the lexical scope of the function.</p>
<pre><code class="language-javascript">// addN returns a function that adds its argument.
var addN = function(x) {
    // x and the function below are in the same lexical scope
    return function(y) {
        return x + y;
    }
}

// add3: Return a function that adds 3 to its argument
var add3 = addN(3);
// add5: Return a function that adds 3 to its argument
var add5 = addN(5);
var resultOfAdd3 = add3(4); // 7
var resultOfAdd5 = add5(4); // 8
resultOfAdd3
> 7
resultOfAdd5
> 8
</code></pre>
<p>Additional examples of closures in JavaScript:</p>
<pre><code class="language-javascript">var closureObject = (function() {
    var y = 0; // this variables lifetime is always available to
               // functions in the same lexical scope.
    return {
        increment: function(x) {
            y += typeof incrementBy === 'number' ?
                x :
                1;
        },
        getValue: function() {
            return y;
        }
    }
}());
// Assign the result of returning a self-executing function to
// closureObject.
// The function returns an object with 2 methods, each
// maintains access to the `y` variable.
closureObject.increment(3);
closureObject.getValue();
> 3

// Demonstrates the preservation of the lexical scope of execution.
var quo = function(status) {
    return {
        get_status: function() {
            return status;
        }
    };
};
var newQuo = quo('amazed!');
// newQuo still has access to the status parameter even after
// execution has ended and the lifetime of its lexical scope has ended.
// This is possible because the function has access to the lexical
// scope in which it was created. This is called a closure.
newQuo.get_status();
> 'amazed!'
</code></pre>
<p>Closure can be useful for things such as callbacks used in animation.</p>
<pre><code class="language-javascript">var fade = function(node) {
    var level = 1;
    var step = function() {
        var hex = level.toString(16);
        var colorValue = '#ffff' + hex + hex;
        node.style.backgroundColor = colorValue;
        console.log('level ' + level + ' backgroundColor: ' + colorValue);
        // step() maintains access to 'level' variable outside its execution scope via Closure.
        if(level &#x3C; 15) {
            level += 1;
            setTimeout(step, 100);
        }
    };
    setTimeout(step, 100);
};
fade(document.body);
</code></pre>
<p>Using closure and setTimout to increment a local variable.</p>
<pre><code class="language-javascript">for( var i = 0; i &#x3C;= 10; i++ ) {
  (function(i) {
    setTimeout(
        function() { console.log(i) },
        1000*i);
  }(i));
}
</code></pre>
<h2>Modules</h2>
<blockquote>
<p>A module is a function or object that presents an interface but that hides its
state and implementation.<br> > —<cite>Douglas Crockford</cite></p>
</blockquote>
<p>Modules exist because developers <em>want</em> to write code in discrete JavaScript
files, while [web] deployment <em>wants</em> optimized code in as few HTTP requests as
possible. These interests are add odds with one another.</p>
<p>Modules aim to encapsulate a piece of code into a useful unit, and register its
capability/export a value for the module.</p>
<blockquote>
<p>The general pattern of a module is a function that defines private variables
and functions; creates privileged function which, through closure, will have
access to the private variables an functions; and that returns the privileged
functions or stores them in an accessible place.<br> > —<cite>Douglas
Crockford</cite></p>
</blockquote>
<p>Douglas then defines a simple module using the function-closure pattern, which
returns an anonymous function to a global variable where the module will be
referenced.</p>
<pre><code class="language-javascript">// SayModule: A function that simply console.log's its argument.
var SayModule = ( function() {
    var message = 'You said: {0}';
    return function(arg) {
        console.log( message.replace( '{0}', arg ) );
        return arg;
    }
}() );

var whatSaid = SayModule("hello world!");
> You said: hello world!
> 'hello world!'
whatSaid
> 'hello world!'
</code></pre>
<p>With many of these, module scripts are strung together in the DOM with
namespaces being described by a single global object where it's still possible
to incur naming collisions in the architecture.</p>
<p>CommonJS is a set of conventions used to define how JavaScript modules are used
and packaged. It defines the Module specification. This describes how code can
fetch and include external modules as a dependency using the <code>require("&#x3C;name>")</code>
function. It also defines how authors export their code either by reassigning a
<code>module.exports</code> object, or adding properties to an <code>exports</code> variable. CommonJS
is most often used for synchronous loading of dependencies on server-side
systems such as Node.js.</p>
<p>AMD (Asynchronous Module Definition) is another specification for modules.
RequireJS is probably the most popular implementation of AMD. RequireJS was
designed to asynchronously load modules in a browser context. RequireJS
implements AMD, which is designed to suit the async nature of a browser.
RequireJS implements a <code>define()</code> function that allows the module to declare its
dependencies before being loaded. RequireJS can easily be wrapped by CommonJS
such that CommonJS modules can easily be included using RequireJS.</p>
<p><a href="http://browserify.org/">Browserify</a> is a CommonJS Module implementation that
can run in the browser. Browserify introspects JavaScript use of the CommonJS
<code>require()</code> function and builds a "bundle" that can be served in a single HTML
<code>&#x3C;script></code> tag.</p>
<p><a href="http://webpack.github.io/docs/what-is-webpack.html">webpack</a> is a module
bundler that aims to understand the needs of the developer as well as solve the
problems of delivering code modules efficiently in the browser. webpack uses an
opinionated configuration-over-code approach (similar to Grunt, but with more
opinions) vs Gulp, which requires much more manual wiring.</p>
<h2>WTF</h2>
<pre><code class="language-javascript">0.1 + 0.2 // 0.3? NOPE!
> 0.30000000000000004

x = 1.0000000000000001
x === 1
true // Huh?

y = {}
> y[[]] = 1
> Object.keys(y)
[ '' ] // HuH?
</code></pre>
</div><footer class="license_copyright__KOT7N">This is licensed under a Creative Commons <!-- -->cc-by-nc-sa<!-- --> International License</footer></article></main><div class="layout_layout__Xf50c"><footer class="footer_footer__OT4Wn layout_layout__Xf50c"><p>© 2003-<!-- -->2022<!-- --> 0xADADA (unless otherwise noted.)<br/><a title="0xADADA" href="/">Home</a> <span class="h-card"><a class="c-Meta u-email" rel="me" title="0xADADA" href="mailto:0xadada.pub@protonmail.com">Email</a> </span><a rel="me nofollow external noopener" title="0xADADA on Mastodon" href="https://freeradical.zone/@0xadada">Mastodon</a> <a rel="me nofollow external noopener" title="0xADADA on Twitter" href="https://twitter.com/0xadada">Twitter</a> <a rel="me nofollow external noopener" title="0xADADA on GitHub" href="https://github.com/0xadada">GitHub</a> <a rel="me nofollow external noopener" title="0xADADA on Goodreads" href="https://www.goodreads.com/review/list/60524683-0xadada?shelf=wanted">Goodreads</a> </p></footer></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"slugs":{"year":"2015","month":"11","day":"15","slug":"javascript-the-good-parts"},"title":"JavaScript The Good Parts","displayTitle":"JavaScript The Good Parts","metaDescription":"Javascript The Good Parts notes","metaKeywords":"marketing, advertising","date":1447607460000,"author":"0xADADA","content":"\u003cp\u003e\u003cem\u003eNotes from the book: JavaScript: The Good Parts by Douglas Crockford\u003c/em\u003e\u003c/p\u003e\n\u003ch2\u003eIndex\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"#javascript-the-good-parts\"\u003eJavaScript: The Good Parts\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"#primitives\"\u003ePrimitives\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#execution-flow\"\u003eExecution Flow\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#equality\"\u003eEquality\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#loops--enumeration\"\u003eLoops / Enumeration\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#object-literals\"\u003eObject Literals\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#arrays\"\u003eArrays\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#delete\"\u003eDelete\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#global-abatement\"\u003eGlobal Abatement\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#reference\"\u003eReference\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#reflection\"\u003eReflection\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#functions\"\u003eFunctions\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#prototype\"\u003ePrototype\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#function-invocation-pattern\"\u003eFunction Invocation Pattern\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#constructor-invocation-pattern\"\u003eConstructor Invocation pattern\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#closure\"\u003eClosure\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#modules\"\u003eModules\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#wtf\"\u003eWTF\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003eJavaScript: The Good Parts\u003c/h2\u003e\n\u003cp\u003eA walkthrough many of the useful code examples from Douglas Crockfords' seminal\nbook,\n\u003ca href=\"http://shop.oreilly.com/product/9780596517748.do\"\u003eJavaScript: The Good Parts\u003c/a\u003e.\u003c/p\u003e\n\u003ch3\u003ePrimitives\u003c/h3\u003e\n\u003cp\u003eJavaScript Reserved words:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-javascript\"\u003eabstract\nboolean break byte\ncase catch char class const continue\ndebugger default delete do double\nelse enum export extends\nfalse final finally float for function\ngoto\nif implements import in instanceof int interface\nlong\nnative new null\npackage private protected public\nreturn\nshort static super switch synchronized\nthis throw throws transient true try typeof\nvar volatile void\nwhile with\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eSimple types\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-javascript\"\u003e// Numbers: 1, 1.1, 1e10, 1e+10,\n// Strings: \"Hello\", 'hello'\n// Booleans: true, false\n// null\n// undefined\n// Object\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eBuilt in values\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-javascript\"\u003etrue\nfalse\nnull\nundefined\nNaN\nInfinity\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eJavaScript represents all numbers internally as a 64-bit floating point value\n(like Java's \u003ccode\u003edouble\u003c/code\u003e).\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-javascript\"\u003e// integer\n1 === 1.0  // true\n\n// fraction\n.1 === 0.1 // true\n\n// exponent: value is calculated by multiplying the part before the\n// e by 10 raised to the power of the part after the e.\n(1*10) * (1*10) === 1e2 // true\n1e2 === 100 // true\n\n// Infinity represents all values greater than:\n1.79769313486231570e+103\ntypeof Infinity === 'number'; // true\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eNumbers, strings and booleans are object like in that they have methods, but\nthey are immutable.\u003c/p\u003e\n\u003cp\u003eArrays, functions, regular expressions and objects are Objects. A simple object:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-javascript\"\u003e// simple object literal\nvar an_object = {};\n// simple object literal with 2 values (comma-separated)\nvar another_object = {\n  'my_value': 3.1,\n  'your_value': 3.2\n};\nanother_object.my_value == 3.1; // true\n\n// attempts to access undefined properties will throw TypeError\nanother_object.fake.my_value // Throws TypeError\n// Prevent TypeError by testing that all attributes exist before accessing\nanother_object.test \u0026#x26;\u0026#x26; another_object.test.test || \"none\" // \"none\"\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eObjects are class-free, which is to say that there is no constraint on the names\nof its properties or their values. The object doesn't need to be defined before\nit is instantiated.\u003c/p\u003e\n\u003cp\u003eJavaScript has prototype linkage, meaning an object can inherit the properties\nof another object. This can be used to reduce object initialization time, memory\nconsumption and increase code reuse.\u003c/p\u003e\n\u003ch3\u003eExecution Flow\u003c/h3\u003e\n\u003cp\u003eExecution and flow statements.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-javascript\"\u003e// Conditional statements: if and switch\n// Looping statements: do, for, while\n// Disruptive statements: break, continue, return, throw\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eFalsy values. When conditional expressions evaluate to these values, the\nexpression will result in \u003ccode\u003efalse\u003c/code\u003e.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-javascript\"\u003efalse\nnull\nundefined\n''         // empty  string\n0\nNaN\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eOperators and statements of equality.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-javascript\"\u003e// Operator precedence\n. [] ()                   // Refinement and invocation\ndelete new typeof + - !   // Unary operators\n* / %                     // Multiplication, division, remainder\n+ -                       // Addition/concatenation, subtraction\n\u003e= \u0026#x3C;= \u003e \u0026#x3C;                 // Inequality\n=== !==                   // Equality\n\u0026#x26;\u0026#x26;                        // Logical and\n||                        // Logical or\n? :                       // Ternary\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eNaN\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-javascript\"\u003e// NaN is a number value that is the result of an operation that\n// cannot produce a normal result. It is not equal to anything else,\n// including itself.\nNaN == NaN;  // false\nNaN === NaN; // false\n\n// Use isNaN to detect if a value is NaN\nisNaN(NaN);  // true\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3\u003eEquality\u003c/h3\u003e\n\u003cp\u003eRule of thumb, the following expressions are all false using \u003ccode\u003e===\u003c/code\u003e or \u003ccode\u003e!==\u003c/code\u003e so\nuse these operators instead.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-javascript\"\u003e'c' + 'a' + 't' === 'cat'; // true\n'' == '0';                 // false\n0 == '';                   // true, both are falsy\n0 == '0';                  // true\nfalse == 'false';          // false\nfalse == '0';              // true\nfalse == undefined;        // false\nfalse == null;             // false\nnull == undefined;         // true\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3\u003eLoops / Enumeration\u003c/h3\u003e\n\u003cp\u003eThe \u003ccode\u003efor in\u003c/code\u003e statement can loop over all properties of an object, but will\ninclude all object types (including functions) as well as all objects along the\nprototype chain. The \u003ccode\u003efor in\u003c/code\u003e operator enumerates the property names on an\nobject.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-javascript\"\u003evar animal_names = {\n    'dog': 'Piper',\n    'cat': 'Snookins',\n    'goat': 'Mr J'\n};\nfor( var animal in animal_names ) {\n    console.log( animal, animal_names[animal] );\n}\n\u003e dog Piper\n\u003e cat Snookins\n\u003e goat Mr J\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eIt is important to know the names can be in any order and can be any type\nincluding functions.\u003c/p\u003e\n\u003ch3\u003eObject literals\u003c/h3\u003e\n\u003cp\u003eObject literal - pair of curly braces surrounding zero or more name: value\npairs.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-javascript\"\u003evar empty_object = {};\nvar stooge = {\n    \"first_name\" : \"Jerome\",\n    \"last_name\" : \"Howard\",\n    'nickname' : 'Jer'\n};\nvar jer1 = stooge['first_name'];\nconsole.log(jer1);  // \"Jerome\"\nvar jer2 = stooge.first_name;\nconsole.log(jer2); // \"Jerome\"\nvar jer3 = stooge.favorite \u0026#x26;\u0026#x26; stooge.favorite.color; // return undefined\nconsole.log(jer3); // undefined\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3\u003eArrays\u003c/h3\u003e\n\u003cp\u003eArrays have a length property.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-javascript\"\u003evar empty = [];\nvar numbers = [\n    'zero', 'one', 'two', 'three', 'four', 'five', 'six', 'seven',\n    'eight', 'nine'\n];\nempty.length\n\u003e 0\nnumbers.length\n\u003e 10\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eObjects have no length property\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-javascript\"\u003evar numbers_object = {\n    '0': 'zero',\n    '1': 'one',\n    '2': 'two',\n    '3': 'three',\n    '4': 'four',\n    '5': 'five',\n    '6': 'six',\n    '7': 'seven',\n    '8': 'eight',\n    '9': 'nine'\n};\nnumbers_object.length\n\u003e undefined\n\nvar myArray = [];\nmyArray.length\n\u003e 0\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eArbitrary array indexes can be set, although there may not be items populating\nthe array before it.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-javascript\"\u003e// myArray = [];\nmyArray[1001] = true; // create and set value of index 1001 to true\nconsole.log(myArray.length); // 1002 OMG!!\n\nvar arrayItemCount = 0;\nfor(var item in myArray) {\n    arrayItemCount += 1;\n}\nconsole.log('myArray counted items: ' + arrayItemCount);\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eTo delete from an array, use \u003ccode\u003eArray.splice()\u003c/code\u003e. This function takes 3 arguments,\n\u003ccode\u003estart\u003c/code\u003e the index to start adding/removing items, \u003ccode\u003edeleteCount\u003c/code\u003e the number of\nitems to remove/replace, and finally n-arguments for the addition n-items to add\nto the array.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-javascript\"\u003evar animals = ['cat', 'dog', 'pork', 'pig', 'fish'];\n\n// remove 'pork'\na.splice(2,1)\n// removed 'pork'\na\n\u003e ['cat', 'dog', 'pig', 'fish']\n\n// add 'snake' before item 2.\na.splice(2,0,'snake')\n\u003e ['cat', 'dog', 'snake', 'pig', 'fish']\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eviola!\u003c/p\u003e\n\u003ch3\u003eDelete\u003c/h3\u003e\n\u003cp\u003eThe \u003ccode\u003edelete\u003c/code\u003e operator removes a property from an object. If will not remove the\nproperty if it only exists on parent objects along the prototype chain. It is\nuseful for removing the property from a leaf object so that the property along\nthe prototype chain is used.\u003c/p\u003e\n\u003ch3\u003eGlobal Abatement\u003c/h3\u003e\n\u003cp\u003eGlobal variables in general weaken the portability and resiliency of programs,\nbut in the case they're necessary, aim to limit them to a single global\nvariable. This is done by attaching all properties to a single global variable.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-javascript\"\u003evar MYAPP = {};\nMYAPP.views = {};\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThis will reduce namespace or scope collisions with other applications or\nlibraries.\u003c/p\u003e\n\u003ch3\u003eReference\u003c/h3\u003e\n\u003cp\u003eJavaScript passes objects around by reference, never by value.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-javascript\"\u003evar x = {\n    fn: 'Jerome',\n    ln: 'Howard',\n    nn: 'Jer'\n};\nvar y = x.nn; // new variable value: 'Jer'\nx.nn = 'curly';\nconsole.log(y); // 'curly'\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3\u003eReflection\u003c/h3\u003e\n\u003cp\u003eReflection is the ability of a program to introspect is own code at runtime.\u003c/p\u003e\n\u003cp\u003eJavascript offers the \u003ccode\u003etypeof\u003c/code\u003e operator to check the type of a property, and\n\u003ccode\u003ehasOwnProperty()\u003c/code\u003e which return true if the property exists directly on an\nobject, false if it does not (and possibly exists up the prototype chain.)\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-javascript\"\u003evar a_var = \"a message\";\ntypeof a_var;\n\u003e 'string'\n\nvar an_object = {\n    a_prop: true;\n};\nan_object.hasOwnProperty('a_prop');\n\u003e true\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3\u003eFunctions\u003c/h3\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\"The craft of programming is the factoring of a set of requirements into a set\nof functions and data structures.\" \u003ccite\u003eDouglas Crockford\u003c/cite\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eFunctions encapsulate a set of statements. They enable code reuse, information\nhiding and behavior composition.\u003c/p\u003e\n\u003cp\u003eFunctions in JavaScript are objects. Objects are collections of name-value pairs\nthat have a hidden prototype link to \u003ccode\u003eObject.prototype\u003c/code\u003e. The Objects produced\nfrom object literals are linked to \u003ccode\u003eObject.prototype\u003c/code\u003e. Function objects are\nlinked to \u003ccode\u003eFunction.prototype\u003c/code\u003e– which is linked to \u003ccode\u003eObject.prototype\u003c/code\u003e.\nFunctions are also created with two additional hidden properties: the function's\nexecution context (lexical scope) and the source code that implements the\nfunction.\u003c/p\u003e\n\u003cp\u003eFunctions have a \u003ccode\u003eprototype\u003c/code\u003e property whos value is an object with a\n\u003ccode\u003econstructor\u003c/code\u003e property whos value is the function. This is distinct from the\nhidden link to \u003ccode\u003eFunction.prototype\u003c/code\u003e. [](#ToDo: this needs to be fleshed-out in\nmore detail)\u003c/p\u003e\n\u003cp\u003eWhen invoked, functions receive two additional parameters: \u003ccode\u003ethis\u003c/code\u003e and\n\u003ccode\u003earguments\u003c/code\u003e. The value of \u003ccode\u003ethis\u003c/code\u003e depends on how the function was invoked\n(invoked as method, invoked as function, invoked as constructor, and invoked as\napply). The value of \u003ccode\u003earguments\u003c/code\u003e is an array-like object (in that the object has\na \u003ccode\u003elength\u003c/code\u003e property) of all parameters passed to the function when invoked.\u003c/p\u003e\n\u003ch4\u003eMethod Invocation Pattern\u003c/h4\u003e\n\u003cp\u003eWhen a function is created as a property of an object, it is called a method.\nWhen a method is invoked, it is bound to the object it is a property of. You can\ntell a function is invoked as a method when it uses a refinement; a \u003ccode\u003e.\u003c/code\u003e notation\nto call the function.\u003c/p\u003e\n\u003cp\u003eFunctions invoked as a method can access the bound object using the \u003ccode\u003ethis\u003c/code\u003e\nreference to access other properties and values on that object. The methods\n\u003ccode\u003ethis\u003c/code\u003e object is late-bound at function invocation time. This makes methods that\nmake references to \u003ccode\u003ethis\u003c/code\u003e more portable. These type of objects are called public\nmethods.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-javascript\"\u003evar myObj = {\n  value: 2,\n  increment: function(inc) {\n    this.value += typeof inc === \"number\" ? inc : 1;\n  }\n};\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThe binding of \u003ccode\u003ethis\u003c/code\u003e happens very late, at invocation time. A method can use\n\u003ccode\u003ethis\u003c/code\u003e to retrieve values from the object, or modify the object.\u003c/p\u003e\n\u003cp\u003eCrockford introduces the \u003ccode\u003emethod\u003c/code\u003e method, it is used throughout the book to\ndefine new methods on existing objects. Crockford attaches it to the \u003ccode\u003eFunction\u003c/code\u003e\nprototype, so it is available to all objects.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-javascript\"\u003eFunction.prototype.method = function(name, func) {\n  this.prototype[name] = func;\n  return this;\n};\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eA use of the \u003ccode\u003emethod\u003c/code\u003e method would be to define a new function \u003ccode\u003epredictLength\u003c/code\u003e\non the String object. This function will return the predicted length a string\nwhen concatenated with the existing string.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-javascript\"\u003e// use Crockfords' `method` method on the `String` object.\nString.method(\"predictLength\", function(arg) {\n  var len = this.length,\nargLen = arg.len,\nnextLen = len + argLen;\n  var message = \"Predicted length is %0 for string '%1'\"\n    .replace(\"%0\", nextLen)\n    .replace(\"%1\", arg);\n  console.log(message);\n  return nextLen;\n});\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch4\u003eFunction Invocation Pattern\u003c/h4\u003e\n\u003cp\u003eWhen a function is not a property of an object, it is invoked directly as a\nfunction:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-javascript\"\u003evar sum = add(3, 4);\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eAny function invoked in this pattern, the \u003ccode\u003ethis\u003c/code\u003e value is bound to the global\nobject. This becomes confusing for many developers when defining objects with\nsub-functions that expect the value of the \u003ccode\u003ethis\u003c/code\u003e value to refer to the\ncontaining object. A example of problematic code illustrates:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-javascript\"\u003evar brokenObj = {\n  value: 2,\n  double: function() {\n  var helper = function() {\n    // broken, the value of `this` in `this.value` refers to the global\n    // Object, not `brokenObj`.\n    this.value = this.value * 2; // fails, global Object.value set to NaN\n};\nhelper();\n  }\n};\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch4\u003eConstructor Invocation Pattern\u003c/h4\u003e\n\u003cp\u003eIf a function is invoked with the \u003ccode\u003enew\u003c/code\u003e prefix e.g.\n\u003ccode\u003evar x = new Status('confused')\u003c/code\u003e, then a new object is created and returned with\na link to the value of the function's \u003ccode\u003eprototype\u003c/code\u003e property. The value of \u003ccode\u003ethis\u003c/code\u003e\nis bound to the new object.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-javascript\"\u003evar Status = function(status) {\n  this.status = status;\n  this.valueOf = function() {\n    console.info(`status ${this.status}`);\n    return this.status;\n  };\n};\nvar happy = new Status(\"happy\");\ntypeof Status === \"function\"; // true\ntypeof happy === \"object\";    // true\nhappy.valueOf() === \"happy\";  // true\n(\"status happy\");\ntrue;\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch4\u003eApply Invocation Pattern\u003c/h4\u003e\n\u003cp\u003eThe \u003ccode\u003eapply\u003c/code\u003e method is available on every function. In the constructor invocation\npattern above, the \u003ccode\u003evalueOf\u003c/code\u003e method was bound to the local object. Instead, the\nthe \u003ccode\u003eapply\u003c/code\u003e method allows the developer supply an arbitrary value for \u003ccode\u003ethis\u003c/code\u003e, in\neffect allowing the developer to apply the method to any object rather than to\nthe object it is currently bound too.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-javascript\"\u003evar DoMath = function(x, y) {\n  this.x = x;\n  this.y = y;\n  this.sum = function() {\n    return this.x + this.y;\n  };\n};\nvar oneTwo = new DoMath(1, 2);\noneTwo.sum() === 3; // true\n\n// now we can force sum() to reference an object that we pass to the apply() method\nvar threeFour = {\n  x: 3,\n  y: 4\n};\noneTwo.sum.apply(threeFour, null);\n7;\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3\u003ePrototype\u003c/h3\u003e\n\u003cp\u003eEvery object is linked to a prototype from which it inherits properties. All\nobjects created with object literal syntax are linked to \u003ccode\u003eObject.prototype\u003c/code\u003e.\nWhen creating new objects, we can select which object it inherits from. We can\nuse a method named \u003ccode\u003eObject.create\u003c/code\u003e to implement this behavior.\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003eObject.create\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-javascript\"\u003eif( typeof Object.create !== 'function') {\n    Object.create = function(o) {\n        var F = function() {};\n        F.prototype = o;\n        return new F();\n    }\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThe prototype link is used only in retrieval. If we try to retrieve a property\nvalue from an object, it will either return the value on the object itself, or\nlook up to \u003cstrong\u003eits\u003c/strong\u003e prototype, and so on, until the lookup finds the property or\n\u003ccode\u003eundefined\u003c/code\u003e is returned if nowhere along the prototype chain nor\n\u003ccode\u003eObject.prototype\u003c/code\u003e has the property. This is called prototype retrieval\ndelegation.\u003c/p\u003e\n\u003cp\u003eIf properties are added to a prototype, all children of that prototype will\nimmediately be available.\u003c/p\u003e\n\u003cp\u003eTo determine if an object has a property directly, without invoking the\nprototype chain, use \u003ccode\u003ehasOwnProperty\u003c/code\u003e.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-javascript\"\u003evar ob = {};\nob.hasOwnProperty('newProperty');\n\u003e false\neb.newProperty = \"a value\";\nob.hasOwnProperty('newProperty');\n\u003e true\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003ePrototypal inheritance\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-javascript\"\u003e// differential inheritance\nvar Mammal = {\n    name: 'A Mammal',\n    says: 'Noise',\n    get_name: function() {\n        return this.name;\n    },\n    speak: function() {\n        return this.says || '';\n    }\n};\nvar myCat = Object.create(Mammal);\nmyCat.name = 'Henrietta';\nmyCat.says = 'meow';\nmyCat.purr = function(n) {\n    var i,\n        s = '';\n    for(i = 0; i \u0026#x3C; n; i += 1) {\n        if(s) {\n            s += '-';\n        }\n        s += 'r';\n    }\n    return s;\n};\nmyCat.get_name = function() {\n    return this.speak() + ' ' + this.name + ' ' + this.speak();\n};\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eFor-in loops\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-javascript\"\u003evar stooge_2 = Object.create(stooge);\nstooge_2.first_name = 'Harry';\nstooge_2.last_name = 'Moses';\nstooge_2.nickname = 'John';\nfor(var name in stooge_2) {\n    console.log( stooge_2[name] );\n}\n\ndelete stooge_2.nickname;\nconsole.log(stooge_2.nickname); // 'curly'\n\n// Method invocation pattern\nconsole.log('===== Method invocation pattern ====');\nvar myObject = {\n    value: 0,\n    increment: function(inc) {\n        this.value += typeof inc === 'number' ? inc : 1;\n    }\n};\n\nmyObject.increment();\nconsole.log(myObject.value); // 1\nmyObject.increment(2);\nconsole.log(myObject.value); // 3\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3\u003eFunction invocation pattern\u003c/h3\u003e\n\u003cpre\u003e\u003ccode class=\"language-javascript\"\u003emyObject.double = function() {\n    var that = this;  // global this mis-assignment fix\n    var helper = function() {\n        that.value = that.value * 2;\n    };\n    helper(); // invoke helper as a function\n};\n// invoke double as a method\nmyObject.double();\nmyObject.value\n\u003e 6\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3\u003eConstructor Invocation pattern\u003c/h3\u003e\n\u003cpre\u003e\u003ccode class=\"language-javascript\"\u003evar Quo = function(string) {\n    this.status = string;\n};\nQuo.prototype.get_status = function() {\n    return this.status;\n};\nvar myQuo = new Quo('confused');\nconsole.log(myQuo.get_status()); // 'confused'\n\n// Apply Invocation pattern\nconsole.log('===== Apply Invocation pattern =====');\nvar statusObject = {\n    status: 'A-OK'\n};\n// invoke the get_status method from Quo on our statusObject\nvar status = Quo.prototype.get_status.apply(statusObject);\nconsole.log(status); // 'A-OK'\n\n// Function Parameters\nconsole.log('===== Function Parameters =====');\nvar sum = function() {\n    var i, sum = 0;\n    for(i = 0; i \u0026#x3C; arguments.length; i += 1) {\n        sum += arguments[i];\n    }\n    return sum;\n};\nconsole.log( sum(4,8,15,16,23,42) ); // 108\n\n// Exceptions\nvar add = function(a, b) {\n    if(typeof a !== 'number' || typeof b !== 'number') {\n       throw { // throw an object with a name and message property\n           name: 'TypeError',\n           message: 'add need numbers'\n       };\n    }\n    debugger;\n    return a + b;\n};\nvar try_it = function() {\n    try {\n        add(\"seven\");\n    } catch(e) {\n        console.log('name: ' + e.name + ' msg: ' + e.message);\n    }\n}\ntry_it();\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eObject augmentation\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-javascript\"\u003eFunction.prototype.method = function(name, func) {\n    // add arbitrary functions with name name to our Object.\n    this.prototype[name] = func;\n    return this;\n};\nNumber.method('integer', function() {\n    return Math[this \u0026#x3C; 0 ? 'ceil' : 'floor'](this);\n});\nconsole.log( (-10/3).integer() ); // -3\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3\u003eLexical Scope\u003c/h3\u003e\n\u003cp\u003eLexical scope is the availability of variables to an executing block of code.\nJavaScript lexical scope is determined by resolving objects in the immediate\nlexical scope, then moving up the chain until it reaches the variables defined\nin the global scope.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-javascript\"\u003evar foo = function() {\n    var a = 3,\n        b = 5;\n    var bar = function() {\n        var b = 7,  // define local b\n            c = 11; // define local c\n        // a = 3, b = 7, c = 11\n        console.log('a', a, 'b', b, 'c', c);\n        a += b + c; // 3 + 7 + 11\n        // a = 21, b = 7, c = 11\n        console.log('a', a, 'b', b, 'c', c);\n    };\n    // now: a = 3, b = 5, c = undefined\n    console.log('a', a, 'b', b);\n    bar();\n    // a = 21, b = 5\n    console.log('a', a, 'b', b);\n};\nfoo();\n\u003e a 3 b 5\n\u003e a 3 b 7 c 11\n\u003e a 21 b 7 c 11\n\u003e a 21 b 5\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3\u003eClosure\u003c/h3\u003e\n\u003cp\u003eA closure is a reference to a function as well as the runtime environment of the\nfunction. This includes any variables within the lexical scope of the function.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-javascript\"\u003e// addN returns a function that adds its argument.\nvar addN = function(x) {\n    // x and the function below are in the same lexical scope\n    return function(y) {\n        return x + y;\n    }\n}\n\n// add3: Return a function that adds 3 to its argument\nvar add3 = addN(3);\n// add5: Return a function that adds 3 to its argument\nvar add5 = addN(5);\nvar resultOfAdd3 = add3(4); // 7\nvar resultOfAdd5 = add5(4); // 8\nresultOfAdd3\n\u003e 7\nresultOfAdd5\n\u003e 8\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eAdditional examples of closures in JavaScript:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-javascript\"\u003evar closureObject = (function() {\n    var y = 0; // this variables lifetime is always available to\n               // functions in the same lexical scope.\n    return {\n        increment: function(x) {\n            y += typeof incrementBy === 'number' ?\n                x :\n                1;\n        },\n        getValue: function() {\n            return y;\n        }\n    }\n}());\n// Assign the result of returning a self-executing function to\n// closureObject.\n// The function returns an object with 2 methods, each\n// maintains access to the `y` variable.\nclosureObject.increment(3);\nclosureObject.getValue();\n\u003e 3\n\n// Demonstrates the preservation of the lexical scope of execution.\nvar quo = function(status) {\n    return {\n        get_status: function() {\n            return status;\n        }\n    };\n};\nvar newQuo = quo('amazed!');\n// newQuo still has access to the status parameter even after\n// execution has ended and the lifetime of its lexical scope has ended.\n// This is possible because the function has access to the lexical\n// scope in which it was created. This is called a closure.\nnewQuo.get_status();\n\u003e 'amazed!'\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eClosure can be useful for things such as callbacks used in animation.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-javascript\"\u003evar fade = function(node) {\n    var level = 1;\n    var step = function() {\n        var hex = level.toString(16);\n        var colorValue = '#ffff' + hex + hex;\n        node.style.backgroundColor = colorValue;\n        console.log('level ' + level + ' backgroundColor: ' + colorValue);\n        // step() maintains access to 'level' variable outside its execution scope via Closure.\n        if(level \u0026#x3C; 15) {\n            level += 1;\n            setTimeout(step, 100);\n        }\n    };\n    setTimeout(step, 100);\n};\nfade(document.body);\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eUsing closure and setTimout to increment a local variable.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-javascript\"\u003efor( var i = 0; i \u0026#x3C;= 10; i++ ) {\n  (function(i) {\n    setTimeout(\n        function() { console.log(i) },\n        1000*i);\n  }(i));\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eModules\u003c/h2\u003e\n\u003cblockquote\u003e\n\u003cp\u003eA module is a function or object that presents an interface but that hides its\nstate and implementation.\u003cbr\u003e \u003e —\u003ccite\u003eDouglas Crockford\u003c/cite\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eModules exist because developers \u003cem\u003ewant\u003c/em\u003e to write code in discrete JavaScript\nfiles, while [web] deployment \u003cem\u003ewants\u003c/em\u003e optimized code in as few HTTP requests as\npossible. These interests are add odds with one another.\u003c/p\u003e\n\u003cp\u003eModules aim to encapsulate a piece of code into a useful unit, and register its\ncapability/export a value for the module.\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eThe general pattern of a module is a function that defines private variables\nand functions; creates privileged function which, through closure, will have\naccess to the private variables an functions; and that returns the privileged\nfunctions or stores them in an accessible place.\u003cbr\u003e \u003e —\u003ccite\u003eDouglas\nCrockford\u003c/cite\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eDouglas then defines a simple module using the function-closure pattern, which\nreturns an anonymous function to a global variable where the module will be\nreferenced.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-javascript\"\u003e// SayModule: A function that simply console.log's its argument.\nvar SayModule = ( function() {\n    var message = 'You said: {0}';\n    return function(arg) {\n        console.log( message.replace( '{0}', arg ) );\n        return arg;\n    }\n}() );\n\nvar whatSaid = SayModule(\"hello world!\");\n\u003e You said: hello world!\n\u003e 'hello world!'\nwhatSaid\n\u003e 'hello world!'\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eWith many of these, module scripts are strung together in the DOM with\nnamespaces being described by a single global object where it's still possible\nto incur naming collisions in the architecture.\u003c/p\u003e\n\u003cp\u003eCommonJS is a set of conventions used to define how JavaScript modules are used\nand packaged. It defines the Module specification. This describes how code can\nfetch and include external modules as a dependency using the \u003ccode\u003erequire(\"\u0026#x3C;name\u003e\")\u003c/code\u003e\nfunction. It also defines how authors export their code either by reassigning a\n\u003ccode\u003emodule.exports\u003c/code\u003e object, or adding properties to an \u003ccode\u003eexports\u003c/code\u003e variable. CommonJS\nis most often used for synchronous loading of dependencies on server-side\nsystems such as Node.js.\u003c/p\u003e\n\u003cp\u003eAMD (Asynchronous Module Definition) is another specification for modules.\nRequireJS is probably the most popular implementation of AMD. RequireJS was\ndesigned to asynchronously load modules in a browser context. RequireJS\nimplements AMD, which is designed to suit the async nature of a browser.\nRequireJS implements a \u003ccode\u003edefine()\u003c/code\u003e function that allows the module to declare its\ndependencies before being loaded. RequireJS can easily be wrapped by CommonJS\nsuch that CommonJS modules can easily be included using RequireJS.\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"http://browserify.org/\"\u003eBrowserify\u003c/a\u003e is a CommonJS Module implementation that\ncan run in the browser. Browserify introspects JavaScript use of the CommonJS\n\u003ccode\u003erequire()\u003c/code\u003e function and builds a \"bundle\" that can be served in a single HTML\n\u003ccode\u003e\u0026#x3C;script\u003e\u003c/code\u003e tag.\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"http://webpack.github.io/docs/what-is-webpack.html\"\u003ewebpack\u003c/a\u003e is a module\nbundler that aims to understand the needs of the developer as well as solve the\nproblems of delivering code modules efficiently in the browser. webpack uses an\nopinionated configuration-over-code approach (similar to Grunt, but with more\nopinions) vs Gulp, which requires much more manual wiring.\u003c/p\u003e\n\u003ch2\u003eWTF\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"language-javascript\"\u003e0.1 + 0.2 // 0.3? NOPE!\n\u003e 0.30000000000000004\n\nx = 1.0000000000000001\nx === 1\ntrue // Huh?\n\ny = {}\n\u003e y[[]] = 1\n\u003e Object.keys(y)\n[ '' ] // HuH?\n\u003c/code\u003e\u003c/pre\u003e\n","slug":"2015-11-15-javascript-the-good-parts","license":"cc-by-nc-sa"}},"__N_SSG":true},"page":"/[year]/[month]/[day]/[slug]","query":{"year":"2015","month":"11","day":"15","slug":"javascript-the-good-parts"},"buildId":"MUtJuWnFmWCac3DQ1Ahc9","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>