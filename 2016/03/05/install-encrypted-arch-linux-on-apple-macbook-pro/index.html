<!DOCTYPE html><html lang="en-US"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="/_next/static/css/362901d03019bc4c.css" crossorigin="" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/01f63581d77a7b07.css" crossorigin="" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-54e78cfe8e9f8a99.js" crossorigin=""/><script src="/_next/static/chunks/fd9d1056-cc48c28d170fddc2.js" async="" crossorigin=""></script><script src="/_next/static/chunks/69-0a6331c18b0d37aa.js" async="" crossorigin=""></script><script src="/_next/static/chunks/main-app-715e3a652bc6b546.js" async="" crossorigin=""></script><script src="/_next/static/chunks/250-d7e0a94ebe194dac.js" async=""></script><script src="/_next/static/chunks/app/page-6a83ba6360da41fb.js" async=""></script><script src="/_next/static/chunks/749-1aefd436964833c3.js" async=""></script><script src="/_next/static/chunks/app/layout-18f161c3adf8f2fa.js" async=""></script><title>Installing (encrypted) Arch Linux on an Apple MacBook Pro</title><meta name="description" content="A howto guide for installing encrypted Arch Linux on an Apple MacBook Pro with battery optimization and the Awesome window manager."/><link rel="author" href="https://0xadada.pub"/><meta name="author" content="0xADADA"/><meta name="keywords" content="projects,open-source,linux"/><link rel="alternate" type="application/rss+xml" href="https://0xadada.pub/rss.xml"/><meta property="og:title" content="Installing (encrypted) Arch Linux on an Apple MacBook Pro"/><meta property="og:description" content="A howto guide for installing encrypted Arch Linux on an Apple MacBook Pro with battery optimization and the Awesome window manager."/><meta property="og:url" content="https://0xadada.pub/2016/03/05/install-encrypted-arch-linux-on-apple-macbook-pro/"/><meta property="og:site_name" content="0xADADA"/><meta property="og:locale" content="en_US"/><meta property="og:image" content="https://0xadada.pub/static/images/meta/avatar.svg"/><meta property="og:image:width" content="660"/><meta property="og:image:height" content="660"/><meta property="og:type" content="article"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:title" content="Installing (encrypted) Arch Linux on an Apple MacBook Pro"/><meta name="twitter:description" content="A howto guide for installing encrypted Arch Linux on an Apple MacBook Pro with battery optimization and the Awesome window manager."/><meta name="twitter:image" content="https://0xadada.pub/static/images/meta/avatar.svg"/><meta name="twitter:image:width" content="660"/><meta name="twitter:image:height" content="660"/><link rel="icon" href="/favicon.ico" type="image/x-icon" sizes="48x48"/><link rel="apple-touch-icon" href="/apple-icon.png?b764b3a1dbf00a82" type="image/png" sizes="180x180"/><script src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js" crossorigin="" noModule=""></script></head><body><main class="layout_layout__dCqca"><article class="hentry h-entry"><header><h1 class="entry-title p-name">Installing (encrypted) Arch Linux on an Apple MacBook Pro</h1><time class="display-date_published__A_L_d dt-published" dateTime="2016-03-05T00:00:00.000Z">Saturday March 5, 2016</time><span class="h-card page_byline__wbXsN"> by <span class="fn p-author p-name">0xADADA</span></span></header><div class="entry-content e-content"><p>In the style of <a href="https://mchladek.me/post/arch-mbp/">Michael Chladek</a>, I thought
it would be useful to my future-self and others, if I wrote up a summary of
installing Arch Linux on Apple MacBook hardware. Of course there are other
guides out there, but this one is specific to the needs of someone looking for a
minimalist, reproducible, secure, performance oriented installation of Arch
Linux.</p>
<p>In following this guide, I’ve made some decisions that are entirely based on my
own (subjective) opinions. These opinions are based on my experiences with other
operating systems and distros, and a number of window managers I’ve tried.</p>
<p>My decisions (take them or leave them):</p>
<ul>
<li>Distribution: Arch Linux</li>
<li>Full disk encryption: On</li>
<li>Window Manager: Awesome</li>
<li>Typography: infinality-bundle with the “Free” preset</li>
</ul>
<p>This article assumes you’re currently running on a MacBook Pro between
generation 7,1 (Mid-2010), 8,2 (Early-2011) or 11,3 (Late-2013). It assumes
you’re running OS X and already have some experience with Linux commands, disk
partitions and GNU/Linux. I’ve tested this guide on both of the above
generations, but I’m assuming it’ll work on anything in between. However, I make
no guarantees.</p>
<p>If you just want to get on to the installation, skip to this link:
<a href="#installing-arch">Installing Arch</a>.</p>
<p><strong>Contents</strong>:</p>
<ul>
<li><a href="#background">Background</a>
<ul>
<li><a href="#why-apple">Why Apple?</a></li>
<li><a href="#why-arch">Why Arch?</a></li>
<li><a href="#why-awesome">Why Awesome?</a></li>
</ul>
</li>
<li><a href="#preparing-to-install-arch">Preparing to Install Arch</a>
<ul>
<li><a href="#getting-the-installation-media">Getting the Installation Media</a></li>
<li><a href="#preparing-the-installation-usb-drive">Preparing the Installation USB Drive</a></li>
</ul>
</li>
<li><a href="#installing-arch">Installing Arch</a>
<ul>
<li><a href="#test-internet">Test Internet</a> and
<a href="#set-the-system-clock">Set the System Clock</a></li>
<li><a href="#partition-the-hard-drive">Partition the Hard Drive</a></li>
<li><a href="#configuring-drive-encryption-and-lvm">Configuring Drive Encryption and LVM</a></li>
<li><a href="#select-a-mirror">Select a Mirror</a></li>
<li><a href="#install-the-base-system">Install the Base System</a></li>
<li><a href="#generate-the-fstab">Generate the fstab</a></li>
<li><a href="#configure-the-system">Configure The System</a></li>
<li><a href="#boot-loader">Boot Loader</a></li>
<li><a href="#reboot-into-new-installation">Reboot into New Installation</a></li>
</ul>
</li>
<li><a href="#configuring-arch">Configuring Arch</a>
<ul>
<li><a href="#install-an-arch-user-repository-package-manager">Install an Arch User Repository Package Manager</a></li>
<li><a href="#configure-sound">Configure Sound</a></li>
<li><a href="#install-x-and-video-drivers">Install X and Video Drivers</a></li>
<li><a href="#some-gui-applications">Some GUI Applications</a></li>
<li><a href="#improved-typography">Improved Typography</a></li>
<li><a href="#window-manager-awesome">Window Manager Awesome</a></li>
<li><a href="#touchpad-support">Touchpad Support</a></li>
<li><a href="#configuring-wireless">Configuring Wireless</a></li>
<li><a href="#done">Done!</a></li>
</ul>
</li>
<li><a href="#fine-tuning">Fine Tuning</a>
<ul>
<li><a href="#display-color-profile">Display Color Profile</a></li>
<li><a href="#display-color-correction">Display Color Correction</a></li>
<li><a href="#power-management">Power Management</a></li>
<li><a href="#laptop-mode-tools">Laptop Mode Tools</a></li>
<li><a href="#acpid">acpid</a></li>
<li><a href="#cpu-frequency-scaling">CPU Frequency Scaling</a></li>
<li><a href="#temperature-management">Temperature Management</a></li>
<li><a href="#fan-control">Fan Control</a></li>
<li><a href="#apple-keyboard">Apple Keyboard</a></li>
<li><a href="#apple-trackpad">Apple Trackpad</a></li>
</ul>
</li>
<li><a href="#conclusion">Conclusion</a></li>
<li><a href="#references">References</a></li>
<li><a href="#footnotes">Footnotes</a></li>
</ul>
<p>This article will be installing Arch Linux alongside OS X, dual-booting such
that you can easily boot into either. I recommend this, even if you’re not going
to be using OS X at all, because right now (and likely for the foreseeable
future) the only way to get firmware updates installed on your machine will be
via OS X. There have been Linux kernel–MacBook Pro firmware compatibility issues
in the past that have been fixed by OS X updates that installed firmware fixes.</p>
<p>I assume you have already repartitioned your drive giving you plenty of free
space for Arch. On my 500GB drive, I left 80GB for OS X (probably much more than
really necessary) and the rest I left free for Arch.</p>
<p><strong>Conventions</strong></p>
<p>For commands typed as the normal user, I will not prefix them:</p>
<pre><code class="language-bash">uname -a
</code></pre>
<p>For commands that need to be executed as a root account, i will prefix them with
a hash-mark: <code>#</code></p>
<pre><code class="language-bash"># uname -a
</code></pre>
<h2 id="background">Background</h2>
<h3 id="why-apple">Why Apple</h3>
<p>I’ve been using OS X as my primary OS since 2011 when I bought my first Apple
product, the 15” MacBook Pro 8,2− which I still use today (March 2016, on which
I’m writing this article). This alone is a testament to its’ longevity as a
computing platform. The industrial design of the hardware is a pleasure to the
eyes and is much imitated. The hardware feels wonderful to the touch. I’ve
disassembled a few of them, and despite the security screws, they’re fairly easy
to repair or upgrade. Only recently had I felt that its’ age was starting to
show, so last week I doubled the ram from 8GB to 16GB and upgraded the hard
drive to a 512GB SSD. This should provide at least another two years of life for
this hardware.</p>
<p>Recently however, Apple has changed their hardware design philosophy from a
fairly open platform to a more proprietary and disposable one. They’ve
eliminated the ability to change or upgrade components. The
<a href="https://en.wikipedia.org/wiki/MacBook_Pro#3rd_generation_.28Retina.29">3rd generation MacBooks</a>
have a battery that is glued in place, the memory is soldered directly to the
logic board. Later models would come with the hard drive soldered down as well.</p>
<p><a href="http://ifixit.org/blog/2763/the-new-macbook-pro-unfixable-unhackable-untenable/">Lyle Wiens of iFixIt, said it best in 2012</a></p>
<blockquote>
<p>When Apple dropped the MacBook Air to $999 in 2010 to match the price point
of the MacBook, they gave users a clear choice: the thin, light, and
un-upgradeable MacBook Air or the heavier, longer lasting, [upgradable], more
rugged, and more powerful MacBook. Same price, two very different products. At
the time, I wasn’t very happy with the non-upgradeable RAM on the MacBook Air,
but I respected that Apple had given their users a choice. It was up to us:
Did we want a machine that would be stuck with 2GB of RAM forever? Would we
support laptops that required replacement every year or two as applications
required more memory and batteries atrophied?</p>
<p>Consumers overwhelmingly voted yes, and the Air grew to take 40 percent of
Apple’s notebook sales by the end of 2010.</p>
</blockquote>
<p>This sort of vendor-lock down and
<a href="https://en.wikipedia.org/wiki/Planned_obsolescence">planned-obsolecence</a> has
bothered me to such an extent that the next laptop I buy won’t be Apple
hardware.</p>
<p>Meanwhile, Apple has secured an
<a href="https://en.wikipedia.org/wiki/Oligopoly">oligopoly</a> in the market, they have
such a dominant position with hardware manufacturers that they seem to be
squeezing competitors out of getting access to top-quality components (or their
competitors don’t care about quality). These manufacturers seem to be building
computers with “Apples’ scraps and leftovers”.</p>
<p>Put simply; I don’t see any manufacturers building laptops at the same level of
quality that Apple does, and yet, I can’t buy a
product<sup><a href="#user-content-fn-1" id="user-content-fnref-1" data-footnote-ref="true" aria-describedby="footnote-label">1</a></sup> that is so tightly
controlled. Finally, I refuse to buy a product that is designed to be obsolete
in two years.</p>
<h3 id="why-arch">Why Arch?</h3>
<p>I first started using Linux in 1997 when I bought a
<a href="https://upload.wikimedia.org/wikipedia/en/thumb/4/49/Redhat_5.2_box.jpg/220px-Redhat_5.2_box.jpg">shrink-wrapped box of RedHat Linux 5.2</a>.
At the time, my internet connection was fast but not reliable enough to download
the ISO image over a 1-day dial-up session. Since then I’ve tried Slackware,
SuSE, Mandrake, Debian, Fedora, Ubuntu, CentOS, and Mint. I customized the hell
out of my distros, I performance tweaked, secured and customized the GUI. Back
then, information was hard to come by, the community was still small and poorly
documented, and that hardly mattered when I couldn’t access the internet because
my ethernet card drivers wouldn’t compile.</p>
<p><a href="https://medium.com/@fun_cuddles/linux-of-the-90s-or-why-i-have-linux-desktop-ptsd-1f276a7887fb#.jwg8up61m">Jen Andre sums it up best</a></p>
<blockquote>
<p>You kids these days. You have it easy.</p>
</blockquote>
<p>It was enjoyable for a while, but I got very busy and eventually came to the
conclusion that “Linux is free if your time is worth nothing” and stuck with OS
X. I would occasionally install and try a different distro just to see if the
OSS operating system world had changed, but that was about it.</p>
<p>Arch is different however. Arch gets it, Arch gets it right. Arch is what I was
searching for all those years.</p>
<ol>
<li>A rolling release cycle keeps everything fresh</li>
<li>I’m a huge advocate for their KISS Principal: Keep it Simple…</li>
<li>The documentation is widely regarded as the best source of info on GNU/linux</li>
<li>The Core package repository is very well maintained and trusted</li>
<li>The User package repository is great at providing pretty much everything you
could need or want</li>
<li>Its designed for people who want to understand and build a system from the
ground up. Install only what you know, only what you understand. It doesn’t
hide anything behind assumptions, scripts or fancy installers.</li>
</ol>
<blockquote>
<p>Arch is like a sandbox, they provide the box and a source of sand (the Core
and User package repos), but it’s up to you to fill it and build your castle.</p>
</blockquote>
<h3 id="why-awesome">Why Awesome?</h3>
<p>Like the topic of GNU/Linux distros, I could spend an entire post talking about
why I settled on Awesome. I’ve tried GNOME, KDE, even Enlightenment. They all
are trying to do more than I need, are too influenced by the design of the Big
Desktop players and pander to novices at the expense of the power users.</p>
<p>All I really need is a quick way to switch between windows and resize them as
needed and for it to be fast. The focus of the window manager is the application
contents, not the chrome eye-candy around the edges of the window.</p>
<p>Awesome was designed for this.</p>
<p>So, this guide is going to install Awesome as it’s window manager. Feel free to
switch it out for whatever you prefer. i3, xmonad and DWM are all similar in
design.</p>
<h2 id="preparing-to-install-arch">Preparing to Install Arch</h2>
<p>When doing this article, I found many other articles very useful. They are
listed in <a href="#references">References</a>. Please refer to them if needed. I will
attempt to both update and condense these articles to a single “Be-all End-all
Guide” to MacBook installation.</p>
<h3 id="getting-the-installation-media">Getting the Installation Media</h3>
<p>First, we need to get Arch Linux ISO from Arch Linux,
<a href="https://www.archlinux.org/download/">Go here to download it</a></p>
<p>I usually go with the torrent option. It’s the fastest.</p>
<p>Next, we’re just going to make sure the download wasn’t corrupted or tampered
with in transit. To make this possible, the Arch Linux ISO publisher has posted
a cryptographic hash of the ISO. We can compare the hash of the ISO they
published against the hash of the ISO we downloaded. If the hash is identical,
we know the contents are exactly the same. Start the terminal and run the
following:</p>
<pre><code class="language-bash">sha1sum &lt;FILE&gt;.iso
</code></pre>
<p>Next, we want to make sure the the ISO we’ve downloaded is provably supplied by
the Arch Linux team. We can do this by verifying the cryptographic signature
they provided with the ISO. The Arch team cryptographically signs their ISO
images using public-key cryptography. This ensures that the ISO file we’ve
downloaded is verifiably provided by the Arch Linux team, and not an impostor.</p>
<p>This assumes you have GnuPG installed on your system (<code>brew install gnupg</code>). On
the ISO download page, there is a link under “Checksums” to get the PGP
signature as a <code>.sig</code> file. Download that into the same directory as your Arch
ISO. Then run the following, replacing the filename (here i use
<code>archlinux-2016-02-01-dual.iso</code>) with the name of the files you’ve downloaded:</p>
<pre><code class="language-bash">gpg --verify \
    archlinux-2016.02.01-dual.iso.sig \
    archlinux-2016.02.01-dual.iso 2&gt;&amp;1 | \
    grep &#x27;key ID&#x27; | \
    gpg --recv-keys 2&gt;&amp;1 `awk &#x27;{print $NF}&#x27;` &amp;&amp; \
gpg --verify archlinux-2016.02.01-dual.iso.sig \
    archlinux-2016.02.01-dual.iso 2&gt;&amp;1 | grep &#x27;signature from&#x27;
</code></pre>
<p>This will first attempt to verify the signature, and if you don’t have the
signers key, it’ll retrieve it. It’ll then try to verify it again, and should
print out “Good signature” if it succeeds. If you get “Bad signature” this means
the ISO has either been forged by an impostor pretending to be the Arch linux
team, or someone has tampered with the ISO stored on their servers or in
transit. If thats the case, you need to find an alternate source to download the
ISO.</p>
<h3 id="preparing-the-installation-usb-drive">Preparing the Installation USB Drive</h3>
<p>This installation method will first create a bootable USB stick, which is used
to boot into a “Live” Arch Linux session. From there, we use the Live Arch Linux
to install Arch onto your MacBook hard drive, then make that partition bootable.</p>
<p>If you’re currently running a GNU/Linux system, follow the instructions in
<a href="#part-a---preparing-the-installation-usb-drive-for-linux">Part A</a>. If you’re
running OS X,
<a href="#part-b---preparing-the-installation-usb-drive-for-osx">jump one section ahead to Part B</a>.</p>
<h4 id="part-a---preparing-the-installation-usb-drive-for-linux">Part A - Preparing the Installation USB Drive for Linux</h4>
<p>If you’re already on a GNU/Linux system, use these instructions to create USB
bootable Arch Linux live system.</p>
<p>Now we’re ready to get that ISO onto a USB drive so we can boot the computer
from it. Before inserting the thumb drive, run <code>lsblk</code> and take note of the
drives listed. Insert the drive and run <code>lsblk</code> again. Take note of the new
letter in the <code>sdX</code> list of drives.</p>
<p>Replace the <code>X</code> with the letter on your system. Be sure to unmount the new
drive.</p>
<pre><code class="language-bash">umount /dev/sdX
</code></pre>
<p>Next, run the following command, it reads the ISO file you downloaded earlier
and writes the contents directly to the USB drive, without the operating system
buffering the writes. Replace the <code>X</code> with the letter of the USB stick you took
note of earlier, and <code>ARCHLINUX</code> with the name of the image file you downloaded.</p>
<pre><code class="language-bash">dd if=ARCHLINUX.iso of=/dev/sdX bs=4M
</code></pre>
<p>After that’s run, the USB drive should be ready to boot from.</p>
<h4 id="part-b---preparing-the-installation-usb-drive-for-osx">Part B - Preparing the Installation USB Drive for OSX</h4>
<p>Now we’re ready to get that ISO onto a USB drive so we can boot the computer
from it. Before inserting the thumb drive, run <code>diskutil list</code> and take note of
the drives listed. You should see output similar to this:</p>
<pre><code>    /dev/disk0
       #:                       TYPE NAME          SIZE       IDENTIFIER
       0:      GUID_partition_scheme               500.1 GB   disk0
       1:                        EFI               209.7 MB   disk0s1
       2:          Apple_CoreStorage               399.5 GB   disk0s2
       3:                 Apple_Boot Recovery HD   650.0 MB   disk0s3
       5:                 Apple_Boot Boot OS X     134.2 MB   disk0s5
    /dev/disk1
       #:                       TYPE NAME          SIZE       IDENTIFIER
       0:                  Apple_HFS MacOSX        399.2 GB   disk1
</code></pre>
<p>Insert the drive and run <code>diskutil list</code> again. Take note of the new letter in
the <code>sdX</code> list of drives.</p>
<pre><code>    /dev/disk0
       #:                       TYPE NAME          SIZE       IDENTIFIER
       0:      GUID_partition_scheme               500.1 GB   disk0
       1:                        EFI               209.7 MB   disk0s1
       2:          Apple_CoreStorage               399.5 GB   disk0s2
       3:                 Apple_Boot Recovery HD   650.0 MB   disk0s3
       5:                 Apple_Boot Boot OS X     134.2 MB   disk0s5
    /dev/disk1
       #:                       TYPE NAME          SIZE       IDENTIFIER
       0:                  Apple_HFS MacOSX        399.2 GB   disk1
    /dev/diskX
       #:                       TYPE NAME          SIZE       IDENTIFIER
       0:      GUID_partition_scheme               2.0 GB     disk2
       1:       Microsoft Basic Data UNTITLED 1    2.0 GB     disk2s1
</code></pre>
<p>Note <code>/dev/diskX</code> has appeared (‘X’ will be a number on your system), this new
disk is the USB thumb drive. <strong>Important</strong> <em>take note of the number of this
drive</em>.</p>
<p>We’re going to remove the existing partitions and erase all the data so its
clean for our Arch Linux installer. This will delete all the data on the USB
drive. Make sure to substitute <code>/dev/diskX</code> for the drive number you noted
above.</p>
<pre><code class="language-bash">diskutil partitionDisk /dev/diskX 1 &quot;Free Space&quot; &quot;unused&quot; &quot;100%&quot;
</code></pre>
<p>Now<sup><a href="#user-content-fn-4" id="user-content-fnref-4" data-footnote-ref="true" aria-describedby="footnote-label">2</a></sup> we can write the iso
file to the USB drive. <strong>Note</strong> We use <code>/dev/rdisk*</code> instead of <code>/dev/disk</code>
because it provides Raw disk access without the typical buffering the operating
systemprovides. Substitute <code>DESTINATION</code> with the name of the <code>iso</code> file you
downloaded earlier, and substitute the <code>X</code> with the number of the drive.</p>
<pre><code class="language-bash">dd if=DESTINATION.iso of=/dev/rdiskX bs=1m
</code></pre>
<p>The <code>dd</code> command does not show any output before it has finished the copy
process, so be patient and wait for it to complete, it can take around 1 - 5
minutes. When the command does complete OS X will try to mount the drive and
fail as it won’t recognize the formatting. Click ignore.</p>
<h2 id="installing-arch">Installing Arch</h2>
<p>With the USB drive plugged in, restart the MacBook and press+hold down the left
<code>option/alt</code> key when you hear the startup chime. Hold the <code>option</code> key down
until the drive screen appears.</p>
<p>The USB drive should be one of the options. Pick it along with the first option
the following boot screen lists. Now you should be at the Arch live install
prompt and it’ll look like this:</p>
<pre><code>    Arch Linux 3.17.6-1-ARCH (tty1)

    archiso login: root (automatic login)
    root@archiso ~ #
</code></pre>
<p>You are now running a “Live” session of Arch Linux from the USB stick.</p>
<p>If you’re on a HiDPI / “Retina” display MacBook, the prompt is really small.
Increase the font-size using <code>setfont sun12x22</code>.</p>
<h3 id="test-internet">Test Internet</h3>
<p>You’ll need a working Internet connection to do the post-install. My MacBook Pro
7,1 and 8,2 both have Ethernet ports, but some of you will have later models
without one. You should get a USB-Ethernet adapter. Its much easier than
fiddling with wireless drivers as it works out of the box. We’ll setup the
wireless drivers later in this article.</p>
<p>First, we need to get an IP address from your router:</p>
<pre><code class="language-bash">dhcpcd
</code></pre>
<p>With the adapter plugged in and an IP address, make sure internet is flowing by
pinging Google:</p>
<pre><code class="language-bash">ping -c 3 www.google.com
</code></pre>
<p>You should get a response that all three packets were sent and received.</p>
<h3 id="set-the-system-clock">Set the System Clock</h3>
<p>The system clock should be just fine. The general Arch wiki recommends ensuring
the system clock is accurate, and I’ve found it doesn’t seem to break anything.
So, I run it:</p>
<pre><code class="language-bash">timedatectl set-ntp true
</code></pre>
<h3 id="partition-the-hard-drive">Partition the Hard Drive</h3>
<p>A partition is basically a box on the hard drive to put files into. OS X has a
box for its files, and we’re going to create box(es) for GNU/Linux. Partitioning
the hard drive takes existing data on the drive and moves or erases it to make
space available for other file systems.</p>
<p>This part is the trickiest because it can erase data on the disk, so take care.</p>
<p>Apple uses the GUID Partition Table (GPT), and we’re going to keep that
partition table.</p>
<p>In order to proceed you’ll need to know the drive mapping scheme, we’ll use
<code>fdisk</code> to check the scheme:</p>
<pre><code class="language-bash">fdisk -l
</code></pre>
<p>This lists the existing partitions. If you created two partitions when preparing
the MacBook, you should see a partition with a Type of <code>Apple HFS/HFS+</code> with a
size that matches the size you set aside for Arch. In my case this was
<code>/dev/sda5</code>. All the partitioning commands below will use <code>/dev/sda5</code>, <strong>you
should substitute the designation for your drive</strong>.</p>
<p>Lets use <code>cgdisk</code> to view the partition table on the attached devices: Replace
the <code>Y</code> with the drive you’ll be using to install Arch Linux.</p>
<pre><code class="language-bash">cgdisk /dev/sdY
</code></pre>
<p>At the end of the partition table should be the free space you set aside for
installing Arch. With that space, we’re going to create a new partition. You
just need to make one partition; we’re going to break it into sub-partitions
later; after encryption is setup.</p>
<p>I added 128MB between the last partition and my new partition
<a href="https://developer.apple.com/library/mac/technotes/tn2166/_index.html">because of this explanation by Apple</a>.</p>
<blockquote>
<p>Note: We leave free space after each partition to make it easier for future
system software to manipulate the partition map in ways that we can’t
anticipate currently.</p>
</blockquote>
<p>Begin by deleting the <code>HFS</code> partition created when you set aside space in OS X
for Arch Linux.</p>
<p>In order to leave additional space, just type <code>+128M</code> when you create the new
partition, and it’ll set the starting sector at a point 128M away from the
ending sector of the partition before it.</p>
<p>You’ll want to use Linux LVM (<code>8e00</code>) as the partition type id. The final
partition table will look something like this:</p>
<pre><code>    Part. #     Size        Partition Type            Partition Name
    ----------------------------------------------------------------
    3.0 KiB      free space
    1        200.0 MiB      EFI System                EFI System Partition
    2         74.5 GiB      Apple HFS/HFS+            Macintosh HD
    128.0 MiB      free space
    3        391.1 GiB      Linux LVM                 ArchLinux
</code></pre>
<p>Then use the utility to select Write and then confirm that you want to overwrite
the disk. Once the display returns you can Quit.</p>
<p>Running <code>fdisk -l</code> again should show your new partition scheme. If it doesn’t
look like you want or expected, repeat the <code>cgdisk</code> process to fix things until
you’re satisfied.</p>
<h3 id="configuring-drive-encryption-and-lvm">Configuring Drive Encryption and LVM</h3>
<p>You’ll want to make note of the partition number you just created. For me it’s
partition <code>5</code>, and the drive is <code>sda</code>, so my Arch Linux partition can be found
at <code>/dev/sda5</code>. I’ll be using that as an example going forward, <strong>but you should
substitute your own drive path</strong>.</p>
<p>We’re going to encrypt <code>/dev/sda5</code> using DM-Crypt and then the LVM partitions
are going to be created over that LUKS encryption layer. This system is called
“LVM on LUKS.” Both LUKS encryption and LVM support are provided by the
GNU/Linux kernel.</p>
<p><strong>Note</strong> This will just encrypt the system <code>/</code> and <code>/home</code> directories. The
<code>/boot</code> directory will not be encrypted because we’re going to keep the existing
<code>/boot</code> partition: That’s <code>/dev/sda1</code> in my partition table above.</p>
<p>If you want to use custom ciphers, there are some great notes
<a href="https://github.com/NoviceLive/unish/blob/master/doc/arch-install.sh#L101">available on GitHub</a>.
You can also use the following command for speed benchmarking to help determine
which ciphers and key-sizes are fast enough for your particular use case:</p>
<pre><code class="language-bash">cryptsetup benchmark
</code></pre>
<p>Time to pick the encryption flavors! The default values for the cipher and key
sizes were a bit too light for my tastes (in light of the NSA spying scandal).
I’ve increased these numbers above the defaults, I’ve chosen to balance my
principals for privacy and security with practical usability and speed. Feel
free to
<a href="https://wiki.archlinux.org/index.php/Dm-crypt/Device_encryption#Encryption_options_for_LUKS_mode">read more on these settings</a>.</p>
<pre><code class="language-bash">cryptsetup --cipher aes-xts-plain64 \
  --key-size 512 \
  --hash sha256 \
  --iter-time 3000 \
  --use-random \
  --verify-passphrase \
  luksFormat /dev/sda5
</code></pre>
<p>Enter in a good passphrase (twice), and we should be good to go.</p>
<p>Now with the encryption setup, we’re going to create the necessary volumes and
filesystems within the LVM.</p>
<p>First, let’s open up our encrypted partition:</p>
<pre><code class="language-bash">cryptsetup luksOpen /dev/sda5 lvm
</code></pre>
<p>This is going to map our encrypted device (<code>/dev/sda5</code> in my case) to
<code>/dev/mapper/lvm</code>. Now we’re going to create the physical and logical volumes
for the <code>/</code> and <code>/home</code> directories. I gave the <code>/</code> directory 40GB (hopefully
enough for all my programs. As of writing this, and with a full install, I’m
using 10GB on my <code>/</code> directory. So, I think I’m good.</p>
<p>Create the physical volume:</p>
<pre><code class="language-bash">pvcreate /dev/mapper/lvm
</code></pre>
<p>Now create the volume with the name <code>vgcrypt</code>:</p>
<pre><code class="language-bash">vgcreate vgcrypt /dev/mapper/lvm
</code></pre>
<p>We’re ready to create the logical volumes now, <code>40GB</code> for root and the rest for
users’ home, change <code>40GB</code> accordingly:</p>
<pre><code class="language-bash">lvcreate --size 40G --name root vgcrypt
lvcreate --extents +100%FREE --name home vgcrypt
</code></pre>
<p>We now have our two volumes <code>vgcrypt-root</code> and <code>vgcrypt-home</code>. They need to be
formatted to a particular filesystem. I’ve been happy with the <code>ext4</code>
filesystem.</p>
<pre><code class="language-bash">mkfs.ext4 /dev/mapper/vgcrypt-root
mkfs.ext4 /dev/mapper/vgcrypt-home
</code></pre>
<p>We can now mount these new partitions. Make sure to mount the root partition
first so we can create the <code>/home</code> directory inside of it for the home
partition:</p>
<pre><code class="language-bash">mount /dev/mapper/vgcrypt-root /mnt
mkdir -p /mnt/home
mount /dev/mapper/vgcrypt-home /mnt/home
</code></pre>
<p>Lets also mount our boot partition, while we’re here. This is required so our
bootable initramfs can be written to the boot drive:</p>
<pre><code class="language-bash">mkdir -p /mnt/boot
mount /dev/sda1 /mnt/boot
</code></pre>
<p>If you’re interested in swap partition schemes,
<a href="https://github.com/NoviceLive/unish/blob/master/doc/arch-install.sh#L127">check this script out</a>
− although I’m fine without swap partitions (Its faster with enough RAM).</p>
<p>And with that, Arch is now ready to be installed on the disk.</p>
<h3 id="select-a-mirror">Select a Mirror</h3>
<p>This step can optionally be skipped, but I prefer to choose a US server just in
case it may be faster. Open up the mirrorlist:</p>
<pre><code class="language-bash">vi /etc/pacman.d/mirrorlist
</code></pre>
<p>Delete or comment out all the servers except one or two near you that seem good.</p>
<h3 id="install-the-base-system">Install the Base System</h3>
<p>Actually installing Arch Linux onto the drive is the easiest part:</p>
<pre><code class="language-bash">pacstrap -i /mnt base base-devel terminus-font
</code></pre>
<p>The <code>-i</code> flag asks for confirmation before installing packages. I like using it
just so I can see what’s being installed. (After all that’s part of the reason
for using GNU/Linux, right? To know what’s being installed on your system.)</p>
<p>This installation includes <code>terminus-font</code>, which we’ll configure to be the
default console font later on.</p>
<h3 id="generate-the-fstab">Generate the fstab</h3>
<p>If all went according to plan, Arch has been written to the hard drive and is
now installed. Before rebooting into our installation, though, we need to tell
the system where to find the filesystems we created earlier for root and home
directories.</p>
<p>While it’s normally a good idea to use UUIDs to find disks, we’re going to use
labels. This is because our encryption setup generates random IDs for the disks
when they’re decrypted. Let’s create the <code>fstab</code> file:</p>
<pre><code class="language-bash">genfstab -L -p /mnt &gt;&gt; /mnt/etc/fstab
</code></pre>
<p>The <code>-L</code> flag will generate the fstab file with labels instead of UUIDs. The
<code>-p</code> flag prevents pseudo-filesystems from being added.</p>
<p>Always check the generated fstab:</p>
<pre><code class="language-bash">cat /mnt/etc/fstab
</code></pre>
<p>It should look something like this:</p>
<pre><code>#
# /etc/fstab: static file system information
#
# &lt;file system&gt;    &lt;dir&gt;&lt;type&gt;&lt;options&gt;             &lt;dump&gt;&lt;pass&gt;
# /dev/mapper/vgcrypt-root
/dev/mapper/vgcrypt-root    /           ext4   discard,rw,relatime,data=ordered    0 1

# /dev/mapper/vgcrypt-home
/dev/mapper/vgcrypt-home    /home       ext4   discard,rw,relatime,data=ordered    0 2
</code></pre>
<p><strong>Note</strong> If your hard drive is a solid-state drive (SSD) and the <code>discard</code>
option isn’t there, edit the fstab file and add it. It’s used for optimizing for
the speed of SSDs.</p>
<h3 id="configure-the-system">Configure The System</h3>
<p>We’re now ready to configure our new system. Let’s change root into it:</p>
<pre><code class="language-bash">arch-chroot /mnt /bin/bash
</code></pre>
<p>Set our system locale. I’m in the US, so I’ll only uncomment that locale from
<code>/etc/locale.gen</code>:</p>
<pre><code>...
en_US.UTF-8 UTF-8
en_US ISO-8859-1
...
</code></pre>
<p>Now generate the locales:</p>
<pre><code class="language-bash">locale-gen
</code></pre>
<p>Make English UTF-8 the default:</p>
<pre><code class="language-bash">echo LANG=en_US.UTF-8 &gt; /etc/locale.conf
</code></pre>
<p>The default font in the virtual console is not very readable, so lets use one
that is far more readable. We’re going to use the typeface “Terminus” in size 18
that we installed with the base system earlier. <code>ter-118n</code> basically means
“Terminus latin-1 size 18 Normal”. There are other sizes available: 12, 14, 16,
20, 22, 24, 28, 32 as well as support for multiple non-English code pages.</p>
<pre><code class="language-bash">echo FONT=ter-118n &gt; /etc/vconsole.conf
</code></pre>
<p>Set the timezone accordingly. (I live on the east coast):</p>
<pre><code class="language-bash">ln -sf /usr/share/zoneinfo/America/New_York /etc/localtime
</code></pre>
<p>And set the time to the standard UTC:</p>
<pre><code class="language-bash">hwclock --systohc --utc
</code></pre>
<p>Because we’ve encrypted our root disk, we need to make sure the kernel loads the
proper modules to decrypt it on startup. Otherwise we won’t be able to boot from
the unencrypted drive. We’re also going to tell the boot-sequence to load our
custom font and keyboard module so we can type our passwords during boot. Edit
<code>/etc/mkinitcpio.conf</code> and add the hooks <code>consolefont keyboard encrypt lvm2</code>
<strong>BEFORE</strong> <code>filesystems</code> so the HOOKS line looks like this:</p>
<pre><code>HOOKS=&quot;base udev autodetect modconf block consolefont keyboard usbinput encrypt lvm2 filesystems fsck&quot;
</code></pre>
<p>Now we need to regenerate the initramfs image:</p>
<pre><code class="language-bash">mkinitcpio -p linux
</code></pre>
<p>So that Internet will work on reboot, we need to enable the <code>dhcpcd</code> service.
We’re going to keep using the ethernet-USB adapter for right now. We’ll get
wireless setup later. Get the name of the ethernet interface:</p>
<pre><code class="language-bash">ip link
</code></pre>
<p>It should be <code>enp</code>-something. With that, enable the service, make sure you
replace INTERFACE with your interfaces name.</p>
<pre><code class="language-bash">systemctl enable dhcpcd@INTERFACE.service
</code></pre>
<p>Finally, let’s configure the machine’s hostname. You can change <code>macbook</code> to
whatever you’d like:</p>
<pre><code class="language-bash">echo macbook &gt; /etc/hostname
</code></pre>
<p>Add this hostname to the list of hosts. Edit <code>/etc/hosts</code> and edit so it looks
something like this:</p>
<pre><code>#
# /etc/hosts: static lookup table for host names
#

#&lt;ip-address&gt;   &lt;hostname.domain.org&gt;   &lt;hostname&gt;
127.0.0.1   localhost.localdomain   localhost   macbook
::1     localhost.localdomain   localhost   macbook
</code></pre>
<p>Set a root password:</p>
<pre><code class="language-bash">passwd
</code></pre>
<p>Create a non-root user for yourself and set the user’s password, replace USER
with the username of your choosing:</p>
<pre><code class="language-bash">useradd --create-home --groups wheel --shell /bin/bash USER
passwd USER
</code></pre>
<p>This will create the user, add it to the group wheel (traditional group of users
who can run <code>sudo</code> commands), create a home directory under <code>/home/USER/</code> and
make his default shell <code>bash</code> then set a default password for the user.</p>
<p>Don’t switch to the new user yet, because we’e added USER to the group <code>wheel</code>,
lets grant the wheel group <code>sudo</code> privileges. Run:</p>
<pre><code class="language-bash">visudo
</code></pre>
<p>And uncomment the following line so it looks like so:</p>
<pre><code>%wheel ALL=(ALL) ALL
</code></pre>
<h3 id="boot-loader">Boot Loader</h3>
<p>Now we need to let the boot loader know where to find our new Arch Linux
installation. <code>systemd</code> (was recently renamed, was Gummiboot) is a nice, simple
boot loader.</p>
<pre><code class="language-bash"># pacman -S systemd              # May be systemd-boot, included in core?
mkdir -p /boot/loader/entries
</code></pre>
<p>Setup the loader to default to arch and set the number of seconds to timeout in
the file <code>/boot/loader/loader.conf</code>:</p>
<pre><code class="language-bash">default arch
timeout 3
</code></pre>
<p>Make sure the correct boot partition (<code>/dev/sda1</code> in my case) is mounted on
<code>/boot</code> by running:</p>
<pre><code>findmnt /boot
-------------------------
TARGET SOURCE    FSTYPE OPTIONS
/boot  /dev/sda1 vfat   rw,relatime,fmask=0022,dmask=0022,codepage=437,iocharset=iso8859-1,shortname=mixed,err
</code></pre>
<p>Now we’re going to create an entry called <code>/boot/loader/entries/arch.conf</code> that
looks like this:</p>
<pre><code># /boot/loader/entries/arch.conf
title   Arch Linux
linux   /vmlinuz-linux
initrd  /initramfs-linux.img
options cryptdevice=/dev/sdaX:vgcrypt:allow-discards root=/dev/mapper/vgcrypt-root rw
</code></pre>
<p><strong>Note</strong>:<sup><a href="#user-content-fn-7" id="user-content-fnref-7" data-footnote-ref="true" aria-describedby="footnote-label">3</a></sup> On the options
line, make sure you replace <code>/dev/sdaX</code> with the path to the encrypted linux
partition we previously created on your device (It was <code>/dev/sda5</code> in this
guide). Additionally, if your drive is <em>not</em> a SSD, make sure to remove
<code>:allow-discards</code>.</p>
<p><strong>Note</strong>:<sup><a href="#user-content-fn-9" id="user-content-fnref-9" data-footnote-ref="true" aria-describedby="footnote-label">4</a></sup> Its been reported
by some users that when booting to USB, the USB drive is assigned device id
<code>/dev/sda</code> and the hard drive to <code>/dev/sdb</code>. When rebooting without USB drive
(boot to new encrypted linux drive partition), the hard drive is reassigned to
device id <code>/dev/sda</code> which may invalidate the above <code>arch.conf</code> boot loader
entry. In this case, the encrypted linux partition will not boot because the
boot loader config <code>arch.conf</code> is configured to boot from <code>/dev/sdb</code>. In this
case you can reboot to USB again, and edit the options line in <code>arch.conf</code> to
read <code>/dev/sdaX</code>. Replace X with your partition id.</p>
<p>Check the boot tree with <code>tree /boot/</code> (If <code>tree</code> isn’t installed, install it
with <code>pacman -S tree</code>). It should look something like this:</p>
<pre><code>/boot/
├── EFI
│   ├── APPLE
│   │   └── EXTENSIONS
│   │       └── Firmware.scap
│   ├── Boot
│   │   └── BOOTX64.EFI
│   └── gummiboot
│       └── gummibootx64.efi
├── initramfs-linux-fallback.img
├── initramfs-linux.img
├── loader
│   ├── entries
│   │   └── arch.conf
│   └── loader.conf
└── vmlinuz-linux
</code></pre>
<p><strong>Note</strong>: At this point, you may want to enable suspend-to-disk (No power
consumption aka “Hibernate” mode). I’ve chosen not to enable this functionality,
but if you’re interested, you can
<a href="http://loicpefferkorn.net/2015/01/arch-linux-on-macbook-pro-retina-2014-with-dm-crypt-lvm-and-suspend-to-disk/#suspend-to-disk-uswsusp:385892e3ac2613dca78d22bd09dbae7d">read about it here</a>.</p>
<p>Now we can have the bootloader write the initramfs onto the boot partition using
<code>bootctl</code>, part of the systemd-boot package.</p>
<pre><code class="language-bash">bootctl install
</code></pre>
<h3 id="reboot-into-new-installation">Reboot into New Installation</h3>
<p>Let’s leave the chroot environment we used for the install:</p>
<pre><code class="language-bash">exit
</code></pre>
<p>You can umount and close the encrypted volume:</p>
<pre><code class="language-bash">umount -R /mnt
cryptsetup close vgcrypt
</code></pre>
<p>It’s not a bad idea to just double check the encryption to make sure it opens
and mounts properly:</p>
<pre><code class="language-bash">cryptsetup open /dev/sda5 vgcrypt
mount /dev/mapper/vgcrypt /mnt
</code></pre>
<p>If all goes accordingly, you can unmount and close the encryption again. And
finally…</p>
<pre><code class="language-bash">reboot
</code></pre>
<p>On reboot you should be greeted with the boot menu. After selecting Arch (or
waiting for it to timeout), you should be prompted for your password to decrypt
the drive, and then it should boot into the console.</p>
<h2 id="configuring-arch">Configuring Arch</h2>
<p>You should now be running Arch Linux! Lets customize it and make it more useful.</p>
<h3 id="install-an-arch-user-repository-package-manager">Install an Arch User Repository Package Manager</h3>
<p>Now we’re about to dive deep into customizing Arch Linux installation with the
utilities and application we’ll be using on a day-to-day basis. To facilitate
installing packages from the wider Arch User Repository (AUR), we’ll install a
utility named <code>yaourt</code>. You can (of course) maintain AUR package installations
manually, but I like a helper to help me manage them. yaourt is like the
Homebrew of Arch Linux. I use
<a href="https://wiki.archlinux.org/index.php/Yaourt">yaourt</a> because it’s easy to
install, takes the same optional flags as <code>pacman</code>, and works well.</p>
<p>You need to use the “official” and manual way of installing AUR packages to get
yaourt installed. It also requires <code>package-query</code> from the AUR, so we’re going
to install that first.</p>
<p>Now we’re going to download the <code>package-query</code> AUR package, unarchive it, and
use pacman to build and install the package. This allows us to manage the
package as if it was installed with pacman, although we’re manually installing
it.</p>
<pre><code class="language-bash">$ cd ~
$ curl -L -O https://aur.archlinux.org/cgit/aur.git/snapshot/package-query.tar.gz
$ tar -xvzf package-query.tar.gz
$ cd package-query
</code></pre>
<p>Within the packages’ folder, we’re going to run the following to build it:</p>
<pre><code class="language-bash">$ makepkg -s
</code></pre>
<p>This will run as your regular user only asking you for your root password if
necessary. With the package made, we can install it via pacman:</p>
<pre><code class="language-bash"># pacman -U package-query-1.6.2-1-x86_64.pkg.tar.xz
</code></pre>
<p>Now we’ll do the same for yaourt:</p>
<pre><code class="language-bash">$ cd ~
$ curl -L -O https://aur.archlinux.org/cgit/aur.git/snapshot/yaourt.tar.gz
$ tar -xvzf yaourt.tar.gz
$ cd yaourt
$ makepkg -s
# pacman -U yaourt-1.6-1-any.pkg.tar.xz
</code></pre>
<p>From now on you can use <code>pacman</code> and <code>yaourt</code> interchangeably… for the most
part. <code>yaourt</code> will install Arch repository packages and AUR packages. <code>pacman</code>,
though, will continue to only install Arch repository packages.</p>
<h3 id="configure-sound">Configure Sound</h3>
<p>ALSA works out of the box with Macs so install it via:</p>
<pre><code class="language-bash"># pacman -S alsa-utils
</code></pre>
<p>Then use:</p>
<pre><code class="language-bash">alsamixer
</code></pre>
<p>to control the speakers. Make sure to disable channels for speakers you don’t
have. Test your speakers with:</p>
<pre><code class="language-bash">speaker-test -c 2
</code></pre>
<p>where 2 is the number of speakers.</p>
<h3 id="install-x-and-video-drivers">Install X and Video Drivers</h3>
<p>As this is going to be a graphical interface, we need are graphics card up and
running with the proper drivers. Luckily this machine uses Intel graphics, and
Intel is pretty good about providing Linux (and sometimes open-source) drivers.</p>
<p>For Macbookpro 7,1 (Mid-2010 or 8,2 (Early-2011):</p>
<pre><code class="language-bash"># pacman -S xf86-video-intel mesa-libgl libva-intel-driver libva
</code></pre>
<p>For Macbookpro 11,3
(Late-2013)<sup><a href="#user-content-fn-8" id="user-content-fnref-8" data-footnote-ref="true" aria-describedby="footnote-label">5</a></sup></p>
<pre><code class="language-bash"># pacman -S nvidia mesa-libgl libva-intel-driver libva
</code></pre>
<p>The <code>-S</code> flag tells pacman to install the subsequent packages listed. (Again,
you can use yaourt if you’d like.) This will install the Intel video driver, the
Mesa OpenGL graphics library, and video acceleration API for Intel graphics
chipsets. It’ll likely ask you to install additional dependencies. Get all the
dependencies!</p>
<p>With the necessary drivers installed, we can get Xorg (or the X Window System)
installed.</p>
<pre><code class="language-bash"># pacman -S xorg-server xorg-server-utils xorg-xinit xterm
</code></pre>
<p>I like to install the Xorg utilities, too, because there are at least a couple
I’ll use later (either in this guide or another) that are helpful in improving
HiDPI support for the MacBook’s HiDPI Retina display.</p>
<h3 id="some-gui-applications">Some GUI Applications</h3>
<p>Next we’ll install a browser. This will install some typeface dependencies and
font- rendering libraries that we’ll be tweaking later.</p>
<pre><code class="language-bash"># pacman -S firefox
</code></pre>
<h3 id="improved-typography">Improved Typography</h3>
<p><strong>Update<sup><a href="#user-content-fn-10" id="user-content-fnref-10" data-footnote-ref="true" aria-describedby="footnote-label">6</a></sup></strong></p>
<p><strong>It appears
<a href="https://github.com/bohoomil/fontconfig-ultimate/issues/191">the package maintainer for Infinality has gone dark</a></strong>.
Skip this section and <a href="#window-manager-awesome">continue to the next</a> until
there is a solution for better typography on the linux desktop.</p>
<p>If you use the web and appreciate typography, you’ll want to install a set of
decent fonts.</p>
<p>Infinality is a package group that has been meticulously crafted from the
ground-up to provide beautifully rendered typography to the Linux platform. The
package maintainer spent a ton of time tearing down the existing font stack, and
carefully rebuilding it to provide fast-rendering fonts that more faithfully
present the typography than either Windows, OS X or Ubuntu systems. It also
provides a set of preset-configurations that allow the user to switch to a
Windows-like or OS X-like configuration. I highly recommend
<a href="http://bohoomil.com/doc/">reading the documentation</a> if you’d like to know more
about typography rendering on GNU/Linux.</p>
<p>First add the following package repositories to <code>/etc/pacman.conf</code>.</p>
<pre><code>    [infinality-bundle]
    Server = http://bohoomil.com/repo/$arch
    [infinality-bundle-fonts]
    Server = http://bohoomil.com/repo/fonts
</code></pre>
<p>Next we’ll add the
<a href="https://bbs.archlinux.org/viewtopic.php?id=162098">package maintainers PGP key</a>
to the package database, update the package database and install the packages.</p>
<pre><code class="language-bash"># pacman-key -r 962DDE58
# pacman-key --lsign-key 962DDE58
# pacman -Syyu
# pacman -S infinality-bundle
# pacman -S infinality-bundle-fonts
</code></pre>
<p>Make sure to select the option <code>fontconfig-infinality-ultimate</code> as that
configuration
<a href="http://bohoomil.com/doc/01-overview/">is the most clean, efficient and looks the best out of the box</a>.
The installation may ask to use the Infinality packages in place of the
dependencies installed by Firefox. Choose the Infinality packages.</p>
<p>To enable selection of predefined font substitution styles and antialiasing
settings, apart from the rendering settings of the engine itself. After doing
so, you can select the font style (win7, winxp, osx, linux, …) with:</p>
<pre><code class="language-bash"># fc-presets set
</code></pre>
<h3 id="window-manager-awesome">Window Manager Awesome</h3>
<p>Awesome is a tiling window manager for the user that prefers keyboard commands
to mouse or touchpad, and treats window chrome as needless ornamentation. Your
application content is king, and efficiency is the goal. Its quick and light.
Lets install the window manager (WM), awesome.</p>
<p>To install:</p>
<pre><code class="language-bash"># pacman -S awesome
</code></pre>
<p>Added this<sup><a href="#user-content-fn-5" id="user-content-fnref-5" data-footnote-ref="true" aria-describedby="footnote-label">7</a></sup> to run <code>awesome</code>
when x starts:</p>
<pre><code>echo exec awesome &gt; .xinitrc
</code></pre>
<h3 id="touchpad-support">Touchpad Support</h3>
<p>You’ll probably want to use your MacBook’s touchpad when you have a GUI. The
simplest driver is the synaptics driver:</p>
<pre><code class="language-bash"># pacman -S xf86-input-synaptics
</code></pre>
<p>The following config at /usr/share/X11/xorg.conf.d/70-synaptics.conf works well
for me, it uses the same “Natural Motion” that OS X does. Copy that file to the
following location <code>/etc/X11/xorg.conf.d/70-synaptics.conf</code> and add the options
between the <code>START</code> and <code>END</code> comments.</p>
<pre><code>Section &quot;InputClass&quot;
    MatchIsTouchpad &quot;on&quot;
    Identifier      &quot;touchpad catchall&quot;
    Driver          &quot;synaptics&quot;

    # START: Add these options
    # 1 = left, 2 = right, 3 = middle
    Option          &quot;TapButton1&quot; &quot;1&quot;
    Option          &quot;TapButton2&quot; &quot;3&quot;
    Option          &quot;TapButton3&quot; &quot;2&quot;
    # Palm detection
    Option          &quot;PalmDetect&quot; &quot;1&quot;
    # Horizontal scrolling
    Option &quot;HorizTwoFingerScroll&quot; &quot;1&quot;
    Option &quot;VertTwoFingerScroll&quot; &quot;on&quot;
    # Natural Scrolling (and speed)
    Option &quot;VertScrollDelta&quot; &quot;-450&quot;
    Option &quot;HorizScrollDelta&quot; &quot;-450&quot;
    # END
EndSection
</code></pre>
<h3 id="configuring-wireless">Configuring Wireless</h3>
<p>Before rebooting into our lovely new GUI, let’s get wireless setup to work when
we reboot.</p>
<p>This particular machine has the Broadcom BCM4360 wireless chipset. Broadcom has
been pretty mixed in the FLOSS support it seems. The BCM4360 is not supported by
the kernel itself, so we’ll need to use Broadcom’s non-free, non-open driver:
<code>broadcom-wl</code>. I actually don’t think this even officially supports the BCM4360
chipset, but it works well enough. We’ll need to install the AUR package:</p>
<pre><code class="language-bash">$ yaourt -S broadcom-wl dialog wpa_supplicant
</code></pre>
<p>And activate the kernel module:</p>
<pre><code class="language-bash"># modprobe wl
</code></pre>
<p><strong>Note</strong>: If you update to a newer kernel in the future, you may need to
uninstall and reinstall the <code>broadcom-wl</code> package so it updates with the new
linux-header.</p>
<p>We need to stop the dhcpcd service we were using for the ethernet and start the
<code>wifi-menu</code><sup><a href="#user-content-fn-1" id="user-content-fnref-1-2" data-footnote-ref="true" aria-describedby="footnote-label">1</a></sup> utility.
Keeping both running can cause conflicts.</p>
<pre><code class="language-bash"># systemctl disable dhcpcd.service
# wifi-menu
</code></pre>
<p>This will create and enable a systemd service that will start when the computer
boots. Changes to the profile file will not propagate to the service file
automatically. After such changes, it is necessary to reenable the profile:</p>
<pre><code class="language-bash"># netctl reenable PROFILE
</code></pre>
<p>After enabling a profile, it will be started at next boot.</p>
<p>Finally, if you find your wireless is dropping connections, you may find turning
off Wi-Fi power management. Simply create this as an executable ( chmod +x
<code>/etc/pm/wireless</code> and add the following contents:</p>
<pre><code>#!/bin/sh
iwconfig wlp2s0 power off
</code></pre>
<h3 id="done">Done!</h3>
<p>Now when you reboot, you should be all set to go start customizing to your
heart’s content, adding applications as you’d like, and playing around with your
new Arch Linux box with Awesome.s</p>
<h2 id="fine-tuning">Fine Tuning</h2>
<p>Power settings took quite a bit of tweaking. Without these setting, the laptop
ran very hot, and drained battery life very fast. I would recommend following
these steps to improve battery life. There still may be room for improvement,
though.</p>
<p>One more thing: If you search “MacBook Pro and Arch Linux” you’ll probably read
some things about disabling ACPI interrupts that were causing overheating and
high CPU usage. If you have updated to the latest version of OS X 10.10
“Yosemite” then you should be OK to skip.</p>
<h3 id="display-color-profile">Display Color Profile</h3>
<p>I noticed that colors seemed washed-out in Arch Linux, so this task will attempt
to color-correct the display. Luckily a utility <code>xcalib</code> exists that can load
color profiles from OS X as X options. This should give you true color-parity
between operating systems.</p>
<p>First, boot into OS X and copy the color profiles located in
<code>/Library/ColorSync/Profiles/Displays</code> to somewhere so you can boot into
GNU/Linux and copy them into your home directory. I created a directory named
<code>~/.colorprofiles</code> for these files.</p>
<p>Second, install the <code>xcalib</code> package from the Arch AUR.</p>
<pre><code class="language-bash">yaourt -S xcalib
</code></pre>
<p>Finally you can activate it by running:</p>
<pre><code class="language-bash">xcalib ~/.colorprofiles/FILENAME.icc
</code></pre>
<p>Where <code>FILENAME</code> is the path to your color profile file.</p>
<p>To load this color profile when X starts, I also added this command to the
<code>.xinitrc</code> file in my home directory. Just make sure you replace <code>FILENAME</code> with
the name of your color-profile <code>.icc</code> file exported from OS X.</p>
<pre><code class="language-bash">if [ `type -P xcalib` ]; then
  # Use the color profile
  xcalib ~/.colorprofiles/FILENAME.icc
fi;
</code></pre>
<h3 id="display-color-correction">Display Color Correction</h3>
<p>If you spend as many hours looking at the display as I do, you’ll quickly
appreciate a display that adapts its colors to the time of day.
<a href="https://justgetflux.com">F.lux</a> adjusts monitor color temperature adaptively to
ease eye strain.</p>
<pre><code class="language-bash">yaourt -S xfluxd
</code></pre>
<p>Then edit <code>/etc/xfluxd.conf</code> to set your rough lat/long coordinates (in decimal
format) in order to correctly shift the color correction with the sunrise and
sunset.</p>
<p>Finally, enable and start the <code>xfluxd</code> service. <strong>Note</strong> you should run this as
your normal user, not as root.</p>
<pre><code class="language-bash">systemctl enable --user xfluxd
systemctl start --user xfluxd
</code></pre>
<h3 id="power-management">Power Management</h3>
<p>The power management from Arch out of the box is not very good. There are a few
good tools out there, but <code>PowerTOP</code> is nice because of its benchmarking
utilities<sup><a href="#user-content-fn-2" id="user-content-fnref-2" data-footnote-ref="true" aria-describedby="footnote-label">8</a></sup>.</p>
<blockquote>
<p>PowerTOP is a tool provided by Intel to enable various powersaving modes in
userspace, kernel and hardware. It is possible to monitor processes and show
which of them are utilizing the CPU and wake it from its Idle-States, allowing
you to identify applications with particular high power demands.</p>
</blockquote>
<pre><code class="language-bash">yaourt -S powertop
</code></pre>
<p>You may want to put your laptop on battery power and calibrate powertop:</p>
<pre><code class="language-bash"># powertop --calibrate
</code></pre>
<p>That’ll cause the screen to blackout from time to time. Just let it run. It
takes a few minutes then your screen will come back on.</p>
<p>You can create a systemd service that will launch powertop’s autotune settings
on startup.</p>
<pre><code># /etc/systemd/system/powertop.service

[Unit]
Description=Powertop tunings

[Service]
Type=oneshot
ExecStart=/usr/bin/powertop --auto-tune

[Install]
WantedBy=multi-user.target

And enable it to automatically start at boot time, then start it for your
current boot session.
</code></pre>
<pre><code class="language-bash"># systemctl enable powertop.service
# systemctl start powertop.service
</code></pre>
<h3 id="laptop-mode-tools">Laptop Mode Tools</h3>
<p>Laptop Mode Tools<sup><a href="#user-content-fn-6" id="user-content-fnref-6" data-footnote-ref="true" aria-describedby="footnote-label">9</a></sup> is a
laptop power saving package for Linux systems. It is the primary way to enable
the Laptop Mode feature of the Linux kernel, which allows you to tweak a number
of other power-related settings using a simple configuration file. Combined with
<code>acpid</code> and CPU frequency scaling, LMT provides a complete notebook power
management suite.</p>
<pre><code class="language-bash">$ yaourt -S laptop-mode-tools
</code></pre>
<p>If you want to enable laptop mode even on AC power, because you run the laptop
attached to an external keyboard and monitor, edit:</p>
<pre><code># /etc/laptop-mode/laptop-mode.conf`:
...
ENABLE_LAPTOP_MODE_ON_AC=1
...
ENABLE_LAPTOP_MODE_WHEN_LID_CLOSED=1
</code></pre>
<p>We’re going to disable LMT from handling CPU frequency scaling since we’ve setup
<code>cpupower</code> to handle that:</p>
<pre><code># /etc/laptop-mode/conf.d/cpufreq.conf
...
# CONTROL_CPU_FREQUENCY=&quot;AUTO&quot;
CONTROL_CPU_FREQUENCY=0
</code></pre>
<p>and disable Intel pstate handling as well:</p>
<pre><code># /etc/laptop-mode/conf.d/intel_pstate.conf
# CONTROL_INTEL_PSTATE=&quot;auto&quot;
CONTROL_INTEL_PSTATE=0
</code></pre>
<p>Finally, enable and start the systemd service:</p>
<pre><code class="language-bash"># systemctl enable laptop-mode.service
# systemctl start  laptop-mode.service
</code></pre>
<h3 id="acpid">acpid</h3>
<p>A very useful tool is from the <code>acpi</code> package, which provides battery
information using the command <code>acpi -v</code>. To install:</p>
<pre><code class="language-bash"># pacman -S acpi
</code></pre>
<p><code>acpid</code> is an extensible daemon for handling ACPI events. It can run commands
when the laptop lid is closed, etc.</p>
<pre><code class="language-bash"># pacman -S acpid
# systemctl enable acpid.service
# systemctl start  acpid.service
</code></pre>
<h3 id="cpu-frequency-scaling">CPU Frequency Scaling</h3>
<p>Another utility that will help with CPU frequency scaling is <code>cpupower</code>, it
provides useful CLI utilities and a systemd service to change the CPU governor
at boot.</p>
<pre><code class="language-bash">$ yaourt -S cpupower
# systemctl enable cpupower
# systemctl start cpupower
</code></pre>
<p>I use cpupower to modulate the CPU’s speeds. This keeps CPU in check from maxing
out at all times. My cpupower config file at <code>/etc/default/cpupower</code> has the
following line changed:</p>
<pre><code>governor=&#x27;powersave&#x27;
</code></pre>
<p>You should adjust this setting to your own needs.</p>
<h3 id="temperature-management">Temperature Management</h3>
<p>Intel provides a daemon that will keep tabs on the CPUs’ temperature and adjust
settings to keep it from getting too hot, its called <code>thermald</code>.</p>
<pre><code class="language-bash">$ yaourt -S thermald
# systemctl enable thermald.service
# systemctl start thermald.service
</code></pre>
<h3 id="fan-control">Fan Control</h3>
<p>Finally, the kernel doesn’t seem to have very fine control over the MacBook’s
fan. The following script helps add fine-tuning for the fan that will increase
its baseline speed and ramp it up gently, so it’s not an all-or-nothing kind of
setup.</p>
<pre><code class="language-bash">$ yaourt -S mbpfan-git
# systemctl enable mbpfan.service
# systemctl start mbpfan.service
</code></pre>
<p>By default the service runs in verbose mode which adds tons of output to the
system journal. It basically works by measuring the CPU temp, adjusting the fan
speed accordingly, and then sleeping for a given number of seconds. With verbose
mode on, it logs its wakeup every few seconds. That means a lot of writing to
the journal. So I changed the service under
<code>/usr/lib/systemd/system/mbpfan.service</code> so the following line reads like so:</p>
<pre><code>ExecStart=/usr/sbin/mbpfan -f
</code></pre>
<h3 id="apple-keyboard">Apple Keyboard</h3>
<p>To get the <code>fn</code> keys working in X, we will install <code>xbindkeys</code> which helps bind
keyboard keys to commands. We will bind keys for volume, keyboard and display
brightness.</p>
<pre><code class="language-bash"># pacman -S xbindkeys
yaourt -S xorg-xbacklight kbdlight
</code></pre>
<p>Create your configuration file for xbindkeys: <code>.xbindkeysrc</code></p>
<pre><code># Increase volume 5% with Apple volume up
&quot;amixer set Master playback 5%+&quot;
    m:0x0 + c:123
    XF86AudioRaiseVolume
# Increase volume 5% with F12
&quot;amixer set Master playback 5%+&quot;
    m:0x0 + c:96


# Decrease volume 5% with Apple volume down
&quot;amixer set Master playback 5%-&quot;
    m:0x0 + c:122
    XF86AudioLowerVolume
# Decrease volume 5% with F11
&quot;amixer set Master playback 5%-&quot;
    m:0x0 + c:95


# Mute with Apple mute
&quot;amixer set Master toggle&quot;
    m:0x0 + c:121
    XF86AudioMute
# Mute with F10
&quot;amixer set Master toggle&quot;
    m:0x0 + c:76


# Suspend system
&quot;systemctl suspend&quot;
    m:0x0 + Mod4 + c:107
    Mod4 + XF86Eject


# Dim keyboard
&quot;kbdlight down&quot;
    m:0x0 + c:237
    XF86KbdBrightnessUp


# Brighten keyboard
&quot;kbdlight up&quot;
    m:0x0 + c:238
    XF86KbdBrightnessDown
</code></pre>
<p>Next we’ll auto-start xbindkeys when X starts, add this to your <code>.xinitrc</code> file:</p>
<pre><code class="language-bash">if [ `type -P xbindkeys` ]; then
  # Load custom keyboard key bindings
  xbindkeys
fi;
</code></pre>
<h3 id="apple-trackpad">Apple Trackpad</h3>
<p>Finally<sup><a href="#user-content-fn-3" id="user-content-fnref-3" data-footnote-ref="true" aria-describedby="footnote-label">10</a></sup>, we’ll setup a
Bluetooth Apple Trackpad. To do this, we’ll install some bluetooth core
utilities</p>
<pre><code class="language-bash"># pacman -S bluez bluez-utils
# modprobe btusb  # Make sure bluetooth kernel module is loaded
# systemctl enable bluetooth.service  # Start bluetooth on reboot
# systemctl start bluetooth.service
</code></pre>
<p>To actually connect to the Trackpad, we’ll use the <code>bluetoothctl</code> interactive
utility to scan-for, discover, pair and connect to the Trackpad. (If your
Trackpad is already paired with another device, make sure to turn it off, then
long-hold the power button until the LED flashes.)</p>
<pre><code>$ bluetoothctl
&gt; power on
&gt; scan on
&gt; agent on
&gt; devices    # You should see the MAC address of your Trackpad appear if its in discoverable mode
&gt; pair mac 28:37:37:2B:42:7A
&gt; connect 28:37:37:2B:42:7A
</code></pre>
<p>Then we’ll setup some <code>udev</code> rules so USB Bluetooth is activated and loade when
the system boots up.</p>
<pre><code># /etc/udev/rules.d/10-local.rules
# Set bluetooth power up
ACTION==&quot;add&quot;, KERNEL==&quot;hci0&quot;, RUN+=&quot;/usr/bin/hciconfig hci0 up&quot;
</code></pre>
<h2 id="conclusion">Conclusion</h2>
<p>Wrapping up, I have nothing to add other than what you do with your system is up
to you.</p>
<h2 id="references">References</h2>
<p>The following articles were very useful in providing some help and inspiration.</p>
<ul>
<li><a href="https://mchladek.me/post/arch-mbp/">Installing Arch Linux on a MacBook Pro - Michael Chladek</a></li>
<li><a href="http://zanshin.net/2015/02/05/arch-linux-on-a-macbook-pro-part-1-creating-a-usb-installer/">Introductory MacBook Arch Guide - Zanshin</a></li>
<li><a href="http://loicpefferkorn.net/2015/01/arch-linux-on-macbook-pro-retina-2014-with-dm-crypt-lvm-and-suspend-to-disk/">Arch Linux on MacBook Pro Retina 2014 with DM-Crypt, LVM and suspend to disk - Loïc Pefferkorn</a></li>
<li><a href="https://wiki.archlinux.org/index.php/MacBook">ArchWiki MacBook</a></li>
<li><a href="https://wiki.archlinux.org/index.php/MacBookPro11,x">ArchWiki MacBookPro11,x</a></li>
<li><a href="https://medium.com/@philpl/arch-linux-running-on-my-macbook-2ea525ebefe3#.ai90cnihe">Arch Linux Running on my MacBook - Phil Plückthun</a></li>
<li><a href="https://www.youtube.com/watch?v=Fzmm87oVQ6c">My personal fight against the modern laptop</a></li>
</ul>
<p>Any changes to this article will be annotated with a footnote and explained
here.</p>
<section data-footnotes="true" class="footnotes"><h2 class="sr-only" id="footnote-label">Footnotes</h2>
<ol>
<li id="user-content-fn-1">
<p>March 6, 2016: Previously used <code>NetworkManager</code> to detect
and connect to WiFi networks, but have changed to use
<code>netctl</code> and <code>wifi-menu</code> as these commands are
more low-level and have fewer dependencies. <a href="#user-content-fnref-1" data-footnote-backref="true" class="data-footnote-backref" aria-label="Back to content">↩</a> <a href="#user-content-fnref-1-2" data-footnote-backref="true" class="data-footnote-backref" aria-label="Back to content">↩<sup>2</sup></a></p>
</li>
<li id="user-content-fn-4">
<p>March 14, 2016: Thanks
<a href="https://www.reddit.com/r/archlinux/comments/493k4n/installing_encrypted_arch_linux_on_an_apple/d0y36h4?context=3">Fr0gm4n</a>
for suggestions simplifying the writing of <code>iso</code>
images to USB. <a href="#user-content-fnref-4" data-footnote-backref="true" class="data-footnote-backref" aria-label="Back to content">↩</a></p>
</li>
<li id="user-content-fn-7">
<p>April 2, 2016: Thanks
<a href="https://www.reddit.com/r/archlinux/comments/493k4n/installing_encrypted_arch_linux_on_an_apple/d1mleow?context=3">Perceptes</a>
for helping to clarify the text explaining how to configure the bootloader. <a href="#user-content-fnref-7" data-footnote-backref="true" class="data-footnote-backref" aria-label="Back to content">↩</a></p>
</li>
<li id="user-content-fn-9">
<p>December 2, 2016: Thanks to Joshua Brown for clarifications to writing the bootloader line. <a href="#user-content-fnref-9" data-footnote-backref="true" class="data-footnote-backref" aria-label="Back to content">↩</a></p>
</li>
<li id="user-content-fn-8">
<p>July 28, 2016: Updated to support Macbookpro 11,3 devices with NVidia cards. This device uses NVIDIA GeForce GT 750M (Codename NVE7/GK107). <a href="#user-content-fnref-8" data-footnote-backref="true" class="data-footnote-backref" aria-label="Back to content">↩</a></p>
</li>
<li id="user-content-fn-10">
<p>February 6, 2017: If anyone has a solution to the loss of Infinality bundle
typography, please drop me a line. <a href="#user-content-fnref-10" data-footnote-backref="true" class="data-footnote-backref" aria-label="Back to content">↩</a></p>
</li>
<li id="user-content-fn-5">
<p>March 18, 2016: Changed references to <code>.Xinitrc</code> to the
correct filename, <code>.xinitrc</code>. <a href="#user-content-fnref-5" data-footnote-backref="true" class="data-footnote-backref" aria-label="Back to content">↩</a></p>
</li>
<li id="user-content-fn-2">
<p>March 8, 2016: Previously omitted the <code>-S</code> option in
yaourt, fixed. <a href="#user-content-fnref-2" data-footnote-backref="true" class="data-footnote-backref" aria-label="Back to content">↩</a></p>
</li>
<li id="user-content-fn-6">
<p>March 24, 2016: Added two new sections documenting Laptop Mode Tools
and <code>acpid</code>. <a href="#user-content-fnref-6" data-footnote-backref="true" class="data-footnote-backref" aria-label="Back to content">↩</a></p>
</li>
<li id="user-content-fn-3">
<p>March 8, 2016: Added a section covering the Apple Trackpad. <a href="#user-content-fnref-3" data-footnote-backref="true" class="data-footnote-backref" aria-label="Back to content">↩</a></p>
</li>
</ol>
</section></div><footer class="license_copyright__EpMnZ">This is licensed under a Creative Commons <!-- -->cc-by-nc-sa<!-- --> International License</footer></article></main><footer class="footer_footer__woFMY layout_layout__dCqca"><nav><p>© 2003-<!-- -->2024<!-- --> 0xADADA (unless otherwise noted.)<br/><span class="h-card"><span class="p-note" hidden="">0xADADA is a Software Engineer / Writer / Motorsports Driver exploring the impact of the attention economy on idleness, time, and lived experience. 🧑‍💻🔧🚗✍️🔒</span><a class="u-url u-uid" title="0xADADA" href="https://0xadada.pub/">0xADADA</a> <a class="c-Meta u-email" rel="me" title="0xADADA" href="mailto:0xadada.pub@protonmail.com">Email</a> <a class="u-url" rel="me nofollow external noopener" title="0xADADA on Warpcast" href="https://warpcast.com/0xadada">Farcaster</a> <a class="u-url" rel="me nofollow external noopener" title="0xADADA on Mastodon" href="https://mastodon.cloud/@0xADADA">Mastodon</a> <a class="u-url" rel="me nofollow external noopener" title="0xADADA on Bluesky" href="https://bsky.app/profile/0xadada.bsky.social">Bluesky</a> <a class="u-url" rel="me nofollow external noopener" title="0xADADA on Twitter" href="https://twitter.com/0xadada"><del>Twitter</del></a> <a class="u-url" rel="me nofollow external noopener" title="0xADADA on GitHub" href="https://github.com/0xadada">GitHub</a> <a class="u-url" rel="me nofollow external noopener" title="0xADADA on Goodreads" href="https://www.goodreads.com/review/list/60524683-0xadada?shelf=wanted">Goodreads</a> <a href="/colophon/">Colophon</a> <a href="/rss.xml">RSS</a> <img alt="0xADADA icon" loading="lazy" width="20" height="20" decoding="async" data-nimg="1" class="u-photo" style="color:transparent;margin-bottom:-0.125rem" src="/static/images/meta/avatar.svg"/></span></p></nav><form action="https://buttondown.email/api/emails/embed-subscribe/0xadada" method="post" target="popupwindow"><label for="email">Sign up to get emailed when I write new things:<!-- --> </label><input type="email" id="email" name="email"/><input type="submit" value="Subscribe"/></form></footer><script src="/_next/static/chunks/webpack-54e78cfe8e9f8a99.js" crossorigin="" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0]);self.__next_f.push([2,null])</script><script>self.__next_f.push([1,"1:HL[\"/_next/static/css/362901d03019bc4c.css\",\"style\",{\"crossOrigin\":\"\"}]\n0:\"$L2\"\n"])</script><script>self.__next_f.push([1,"3:HL[\"/_next/static/css/01f63581d77a7b07.css\",\"style\",{\"crossOrigin\":\"\"}]\n"])</script><script>self.__next_f.push([1,"4:I[7690,[],\"\"]\n7:I[5613,[],\"\"]\n9:I[1778,[],\"\"]\na:I[5250,[\"250\",\"static/chunks/250-d7e0a94ebe194dac.js\",\"931\",\"static/chunks/app/page-6a83ba6360da41fb.js\"],\"\"]\nb:I[1749,[\"250\",\"static/chunks/250-d7e0a94ebe194dac.js\",\"749\",\"static/chunks/749-1aefd436964833c3.js\",\"185\",\"static/chunks/app/layout-18f161c3adf8f2fa.js\"],\"Image\"]\nd:I[8955,[],\"\"]\n8:[\"slug\",\"2016/03/05/install-encrypted-arch-linux-on-apple-macbook-pro\",\"c\"]\ne:[]\n"])</script><script>self.__next_f.push([1,"2:[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/362901d03019bc4c.css\",\"precedence\":\"next\",\"crossOrigin\":\"\"}]],[\"$\",\"$L4\",null,{\"buildId\":\"_Lg8iC0t5bOJbzMECtSDt\",\"assetPrefix\":\"\",\"initialCanonicalUrl\":\"/2016/03/05/install-encrypted-arch-linux-on-apple-macbook-pro/\",\"initialTree\":[\"\",{\"children\":[[\"slug\",\"2016/03/05/install-encrypted-arch-linux-on-apple-macbook-pro\",\"c\"],{\"children\":[\"__PAGE__?{\\\"slug\\\":[\\\"2016\\\",\\\"03\\\",\\\"05\\\",\\\"install-encrypted-arch-linux-on-apple-macbook-pro\\\"]}\",{}]}]},\"$undefined\",\"$undefined\",true],\"initialSeedData\":[\"\",{\"children\":[[\"slug\",\"2016/03/05/install-encrypted-arch-linux-on-apple-macbook-pro\",\"c\"],{\"children\":[\"__PAGE__\",{},[\"$L5\",\"$L6\",null]]},[\"$\",\"$L7\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"$8\",\"children\"],\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"loadingScripts\":\"$undefined\",\"hasLoading\":false,\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L9\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"styles\":[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/01f63581d77a7b07.css\",\"precedence\":\"next\",\"crossOrigin\":\"\"}]]}]]},[null,[\"$\",\"html\",null,{\"lang\":\"en-US\",\"children\":[\"$\",\"body\",null,{\"children\":[[\"$\",\"main\",null,{\"className\":\"layout_layout__dCqca\",\"children\":[\"$\",\"$L7\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"loadingScripts\":\"$undefined\",\"hasLoading\":false,\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L9\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":\"404\"}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],\"notFoundStyles\":[],\"styles\":null}]}],[\"$\",\"footer\",null,{\"className\":\"footer_footer__woFMY layout_layout__dCqca\",\"children\":[[\"$\",\"nav\",null,{\"children\":[\"$\",\"p\",null,{\"children\":[\"© 2003-\",\"2024\",\" 0xADADA (unless otherwise noted.)\",[\"$\",\"br\",null,{}],[\"$\",\"span\",null,{\"className\":\"h-card\",\"children\":[[\"$\",\"span\",null,{\"className\":\"p-note\",\"hidden\":true,\"children\":\"0xADADA is a Software Engineer / Writer / Motorsports Driver exploring the impact of the attention economy on idleness, time, and lived experience. 🧑‍💻🔧🚗✍️🔒\"}],[\"$\",\"$La\",null,{\"className\":\"u-url u-uid\",\"href\":\"https://0xadada.pub/\",\"title\":\"0xADADA\",\"children\":\"0xADADA\"}],\" \",[\"$\",\"$La\",null,{\"href\":\"mailto:0xadada.pub@protonmail.com\",\"className\":\"c-Meta u-email\",\"rel\":\"me\",\"title\":\"0xADADA\",\"children\":\"Email\"}],\" \",[\"$\",\"$La\",null,{\"href\":\"https://warpcast.com/0xadada\",\"className\":\"u-url\",\"rel\":\"me nofollow external noopener\",\"title\":\"0xADADA on Warpcast\",\"children\":\"Farcaster\"}],\" \",[\"$\",\"$La\",null,{\"href\":\"https://mastodon.cloud/@0xADADA\",\"className\":\"u-url\",\"rel\":\"me nofollow external noopener\",\"title\":\"0xADADA on Mastodon\",\"children\":\"Mastodon\"}],\" \",[\"$\",\"$La\",null,{\"href\":\"https://bsky.app/profile/0xadada.bsky.social\",\"className\":\"u-url\",\"rel\":\"me nofollow external noopener\",\"title\":\"0xADADA on Bluesky\",\"children\":\"Bluesky\"}],\" \",[\"$\",\"$La\",null,{\"href\":\"https://twitter.com/0xadada\",\"className\":\"u-url\",\"rel\":\"me nofollow external noopener\",\"title\":\"0xADADA on Twitter\",\"children\":[\"$\",\"del\",null,{\"children\":\"Twitter\"}]}],\" \",[\"$\",\"$La\",null,{\"href\":\"https://github.com/0xadada\",\"className\":\"u-url\",\"rel\":\"me nofollow external noopener\",\"title\":\"0xADADA on GitHub\",\"children\":\"GitHub\"}],\" \",[\"$\",\"$La\",null,{\"href\":\"https://www.goodreads.com/review/list/60524683-0xadada?shelf=wanted\",\"className\":\"u-url\",\"rel\":\"me nofollow external noopener\",\"title\":\"0xADADA on Goodreads\",\"children\":\"Goodreads\"}],\" \",[\"$\",\"$La\",null,{\"href\":\"/colophon/\",\"children\":\"Colophon\"}],\" \",[\"$\",\"$La\",null,{\"href\":\"/rss.xml\",\"children\":\"RSS\"}],\" \",[\"$\",\"$Lb\",null,{\"className\":\"u-photo\",\"src\":\"/static/images/meta/avatar.svg\",\"alt\":\"0xADADA icon\",\"width\":\"20\",\"height\":\"20\",\"style\":{\"marginBottom\":\"-0.125rem\"}}]]}]]}]}],[\"$\",\"form\",null,{\"action\":\"https://buttondown.email/api/emails/embed-subscribe/0xadada\",\"method\":\"post\",\"target\":\"popupwindow\",\"children\":[[\"$\",\"label\",null,{\"htmlFor\":\"email\",\"children\":[\"Sign up to get emailed when I write new things:\",\" \"]}],[\"$\",\"input\",null,{\"type\":\"email\",\"name\":\"email\",\"id\":\"email\"}],[\"$\",\"input\",null,{\"type\":\"submit\",\"value\":\"Subscribe\"}]]}]]}]]}]}],null]],\"initialHead\":[false,\"$Lc\"],\"globalErrorComponent\":\"$d\",\"missingSlots\":\"$We\"}]]\n"])</script><script>self.__next_f.push([1,"6:[\"$\",\"article\",null,{\"className\":\"hentry h-entry\",\"children\":[[\"$\",\"header\",null,{\"children\":[[\"$\",\"h1\",null,{\"className\":\"entry-title p-name\",\"children\":\"Installing (encrypted) Arch Linux on an Apple MacBook Pro\"}],\"$undefined\",[\"$\",\"time\",null,{\"className\":\"display-date_published__A_L_d dt-published\",\"dateTime\":\"2016-03-05T00:00:00.000Z\",\"children\":\"Saturday March 5, 2016\"}],[\"$\",\"span\",null,{\"className\":\"h-card page_byline__wbXsN\",\"children\":[\" by \",[\"$\",\"span\",null,{\"className\":\"fn p-author p-name\",\"children\":\"0xADADA\"}]]}]]}],[\"$\",\"div\",null,{\"className\":\"entry-content e-content\",\"children\":[[\"$\",\"p\",null,{\"children\":[\"In the style of \",[\"$\",\"a\",null,{\"href\":\"https://mchladek.me/post/arch-mbp/\",\"children\":\"Michael Chladek\"}],\", I thought\\nit would be useful to my future-self and others, if I wrote up a summary of\\ninstalling Arch Linux on Apple MacBook hardware. Of course there are other\\nguides out there, but this one is specific to the needs of someone looking for a\\nminimalist, reproducible, secure, performance oriented installation of Arch\\nLinux.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"In following this guide, I’ve made some decisions that are entirely based on my\\nown (subjective) opinions. These opinions are based on my experiences with other\\noperating systems and distros, and a number of window managers I’ve tried.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"My decisions (take them or leave them):\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"Distribution: Arch Linux\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"Full disk encryption: On\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"Window Manager: Awesome\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"Typography: infinality-bundle with the “Free” preset\"}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"This article assumes you’re currently running on a MacBook Pro between\\ngeneration 7,1 (Mid-2010), 8,2 (Early-2011) or 11,3 (Late-2013). It assumes\\nyou’re running OS X and already have some experience with Linux commands, disk\\npartitions and GNU/Linux. I’ve tested this guide on both of the above\\ngenerations, but I’m assuming it’ll work on anything in between. However, I make\\nno guarantees.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"If you just want to get on to the installation, skip to this link:\\n\",[\"$\",\"a\",null,{\"href\":\"#installing-arch\",\"children\":\"Installing Arch\"}],\".\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"Contents\"}],\":\"]}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"a\",null,{\"href\":\"#background\",\"children\":\"Background\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#why-apple\",\"children\":\"Why Apple?\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#why-arch\",\"children\":\"Why Arch?\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#why-awesome\",\"children\":\"Why Awesome?\"}]}],\"\\n\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"a\",null,{\"href\":\"#preparing-to-install-arch\",\"children\":\"Preparing to Install Arch\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#getting-the-installation-media\",\"children\":\"Getting the Installation Media\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#preparing-the-installation-usb-drive\",\"children\":\"Preparing the Installation USB Drive\"}]}],\"\\n\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"a\",null,{\"href\":\"#installing-arch\",\"children\":\"Installing Arch\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"a\",null,{\"href\":\"#test-internet\",\"children\":\"Test Internet\"}],\" and\\n\",[\"$\",\"a\",null,{\"href\":\"#set-the-system-clock\",\"children\":\"Set the System Clock\"}]]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#partition-the-hard-drive\",\"children\":\"Partition the Hard Drive\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#configuring-drive-encryption-and-lvm\",\"children\":\"Configuring Drive Encryption and LVM\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#select-a-mirror\",\"children\":\"Select a Mirror\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#install-the-base-system\",\"children\":\"Install the Base System\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#generate-the-fstab\",\"children\":\"Generate the fstab\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#configure-the-system\",\"children\":\"Configure The System\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#boot-loader\",\"children\":\"Boot Loader\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#reboot-into-new-installation\",\"children\":\"Reboot into New Installation\"}]}],\"\\n\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"a\",null,{\"href\":\"#configuring-arch\",\"children\":\"Configuring Arch\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#install-an-arch-user-repository-package-manager\",\"children\":\"Install an Arch User Repository Package Manager\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#configure-sound\",\"children\":\"Configure Sound\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#install-x-and-video-drivers\",\"children\":\"Install X and Video Drivers\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#some-gui-applications\",\"children\":\"Some GUI Applications\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#improved-typography\",\"children\":\"Improved Typography\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#window-manager-awesome\",\"children\":\"Window Manager Awesome\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#touchpad-support\",\"children\":\"Touchpad Support\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#configuring-wireless\",\"children\":\"Configuring Wireless\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#done\",\"children\":\"Done!\"}]}],\"\\n\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"a\",null,{\"href\":\"#fine-tuning\",\"children\":\"Fine Tuning\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#display-color-profile\",\"children\":\"Display Color Profile\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#display-color-correction\",\"children\":\"Display Color Correction\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#power-management\",\"children\":\"Power Management\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#laptop-mode-tools\",\"children\":\"Laptop Mode Tools\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#acpid\",\"children\":\"acpid\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#cpu-frequency-scaling\",\"children\":\"CPU Frequency Scaling\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#temperature-management\",\"children\":\"Temperature Management\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#fan-control\",\"children\":\"Fan Control\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#apple-keyboard\",\"children\":\"Apple Keyboard\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#apple-trackpad\",\"children\":\"Apple Trackpad\"}]}],\"\\n\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#conclusion\",\"children\":\"Conclusion\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#references\",\"children\":\"References\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#footnotes\",\"children\":\"Footnotes\"}]}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"This article will be installing Arch Linux alongside OS X, dual-booting such\\nthat you can easily boot into either. I recommend this, even if you’re not going\\nto be using OS X at all, because right now (and likely for the foreseeable\\nfuture) the only way to get firmware updates installed on your machine will be\\nvia OS X. There have been Linux kernel–MacBook Pro firmware compatibility issues\\nin the past that have been fixed by OS X updates that installed firmware fixes.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"I assume you have already repartitioned your drive giving you plenty of free\\nspace for Arch. On my 500GB drive, I left 80GB for OS X (probably much more than\\nreally necessary) and the rest I left free for Arch.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"strong\",null,{\"children\":\"Conventions\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"For commands typed as the normal user, I will not prefix them:\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"uname -a\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"For commands that need to be executed as a root account, i will prefix them with\\na hash-mark: \",[\"$\",\"code\",null,{\"children\":\"#\"}]]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"# uname -a\\n\"}]}],\"\\n\",[\"$\",\"h2\",null,{\"id\":\"background\",\"children\":\"Background\"}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"why-apple\",\"children\":\"Why Apple\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"I’ve been using OS X as my primary OS since 2011 when I bought my first Apple\\nproduct, the 15” MacBook Pro 8,2− which I still use today (March 2016, on which\\nI’m writing this article). This alone is a testament to its’ longevity as a\\ncomputing platform. The industrial design of the hardware is a pleasure to the\\neyes and is much imitated. The hardware feels wonderful to the touch. I’ve\\ndisassembled a few of them, and despite the security screws, they’re fairly easy\\nto repair or upgrade. Only recently had I felt that its’ age was starting to\\nshow, so last week I doubled the ram from 8GB to 16GB and upgraded the hard\\ndrive to a 512GB SSD. This should provide at least another two years of life for\\nthis hardware.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Recently however, Apple has changed their hardware design philosophy from a\\nfairly open platform to a more proprietary and disposable one. They’ve\\neliminated the ability to change or upgrade components. The\\n\",[\"$\",\"a\",null,{\"href\":\"https://en.wikipedia.org/wiki/MacBook_Pro#3rd_generation_.28Retina.29\",\"children\":\"3rd generation MacBooks\"}],\"\\nhave a battery that is glued in place, the memory is soldered directly to the\\nlogic board. Later models would come with the hard drive soldered down as well.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"http://ifixit.org/blog/2763/the-new-macbook-pro-unfixable-unhackable-untenable/\",\"children\":\"Lyle Wiens of iFixIt, said it best in 2012\"}]}],\"\\n\",[\"$\",\"blockquote\",null,{\"children\":[\"\\n\",[\"$\",\"p\",null,{\"children\":\"When Apple dropped the MacBook Air to $999 in 2010 to match the price point\\nof the MacBook, they gave users a clear choice: the thin, light, and\\nun-upgradeable MacBook Air or the heavier, longer lasting, [upgradable], more\\nrugged, and more powerful MacBook. Same price, two very different products. At\\nthe time, I wasn’t very happy with the non-upgradeable RAM on the MacBook Air,\\nbut I respected that Apple had given their users a choice. It was up to us:\\nDid we want a machine that would be stuck with 2GB of RAM forever? Would we\\nsupport laptops that required replacement every year or two as applications\\nrequired more memory and batteries atrophied?\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Consumers overwhelmingly voted yes, and the Air grew to take 40 percent of\\nApple’s notebook sales by the end of 2010.\"}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"This sort of vendor-lock down and\\n\",[\"$\",\"a\",null,{\"href\":\"https://en.wikipedia.org/wiki/Planned_obsolescence\",\"children\":\"planned-obsolecence\"}],\" has\\nbothered me to such an extent that the next laptop I buy won’t be Apple\\nhardware.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Meanwhile, Apple has secured an\\n\",[\"$\",\"a\",null,{\"href\":\"https://en.wikipedia.org/wiki/Oligopoly\",\"children\":\"oligopoly\"}],\" in the market, they have\\nsuch a dominant position with hardware manufacturers that they seem to be\\nsqueezing competitors out of getting access to top-quality components (or their\\ncompetitors don’t care about quality). These manufacturers seem to be building\\ncomputers with “Apples’ scraps and leftovers”.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Put simply; I don’t see any manufacturers building laptops at the same level of\\nquality that Apple does, and yet, I can’t buy a\\nproduct\",[\"$\",\"sup\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#user-content-fn-1\",\"id\":\"user-content-fnref-1\",\"data-footnote-ref\":true,\"aria-describedby\":\"footnote-label\",\"children\":\"1\"}]}],\" that is so tightly\\ncontrolled. Finally, I refuse to buy a product that is designed to be obsolete\\nin two years.\"]}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"why-arch\",\"children\":\"Why Arch?\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"I first started using Linux in 1997 when I bought a\\n\",[\"$\",\"a\",null,{\"href\":\"https://upload.wikimedia.org/wikipedia/en/thumb/4/49/Redhat_5.2_box.jpg/220px-Redhat_5.2_box.jpg\",\"children\":\"shrink-wrapped box of RedHat Linux 5.2\"}],\".\\nAt the time, my internet connection was fast but not reliable enough to download\\nthe ISO image over a 1-day dial-up session. Since then I’ve tried Slackware,\\nSuSE, Mandrake, Debian, Fedora, Ubuntu, CentOS, and Mint. I customized the hell\\nout of my distros, I performance tweaked, secured and customized the GUI. Back\\nthen, information was hard to come by, the community was still small and poorly\\ndocumented, and that hardly mattered when I couldn’t access the internet because\\nmy ethernet card drivers wouldn’t compile.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"https://medium.com/@fun_cuddles/linux-of-the-90s-or-why-i-have-linux-desktop-ptsd-1f276a7887fb#.jwg8up61m\",\"children\":\"Jen Andre sums it up best\"}]}],\"\\n\",[\"$\",\"blockquote\",null,{\"children\":[\"\\n\",[\"$\",\"p\",null,{\"children\":\"You kids these days. You have it easy.\"}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"It was enjoyable for a while, but I got very busy and eventually came to the\\nconclusion that “Linux is free if your time is worth nothing” and stuck with OS\\nX. I would occasionally install and try a different distro just to see if the\\nOSS operating system world had changed, but that was about it.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Arch is different however. Arch gets it, Arch gets it right. Arch is what I was\\nsearching for all those years.\"}],\"\\n\",[\"$\",\"ol\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"A rolling release cycle keeps everything fresh\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"I’m a huge advocate for their KISS Principal: Keep it Simple…\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"The documentation is widely regarded as the best source of info on GNU/linux\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"The Core package repository is very well maintained and trusted\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"The User package repository is great at providing pretty much everything you\\ncould need or want\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"Its designed for people who want to understand and build a system from the\\nground up. Install only what you know, only what you understand. It doesn’t\\nhide anything behind assumptions, scripts or fancy installers.\"}],\"\\n\"]}],\"\\n\",[\"$\",\"blockquote\",null,{\"children\":[\"\\n\",[\"$\",\"p\",null,{\"children\":\"Arch is like a sandbox, they provide the box and a source of sand (the Core\\nand User package repos), but it’s up to you to fill it and build your castle.\"}],\"\\n\"]}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"why-awesome\",\"children\":\"Why Awesome?\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Like the topic of GNU/Linux distros, I could spend an entire post talking about\\nwhy I settled on Awesome. I’ve tried GNOME, KDE, even Enlightenment. They all\\nare trying to do more than I need, are too influenced by the design of the Big\\nDesktop players and pander to novices at the expense of the power users.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"All I really need is a quick way to switch between windows and resize them as\\nneeded and for it to be fast. The focus of the window manager is the application\\ncontents, not the chrome eye-candy around the edges of the window.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Awesome was designed for this.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"So, this guide is going to install Awesome as it’s window manager. Feel free to\\nswitch it out for whatever you prefer. i3, xmonad and DWM are all similar in\\ndesign.\"}],\"\\n\",[\"$\",\"h2\",null,{\"id\":\"preparing-to-install-arch\",\"children\":\"Preparing to Install Arch\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"When doing this article, I found many other articles very useful. They are\\nlisted in \",[\"$\",\"a\",null,{\"href\":\"#references\",\"children\":\"References\"}],\". Please refer to them if needed. I will\\nattempt to both update and condense these articles to a single “Be-all End-all\\nGuide” to MacBook installation.\"]}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"getting-the-installation-media\",\"children\":\"Getting the Installation Media\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"First, we need to get Arch Linux ISO from Arch Linux,\\n\",[\"$\",\"a\",null,{\"href\":\"https://www.archlinux.org/download/\",\"children\":\"Go here to download it\"}]]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"I usually go with the torrent option. It’s the fastest.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Next, we’re just going to make sure the download wasn’t corrupted or tampered\\nwith in transit. To make this possible, the Arch Linux ISO publisher has posted\\na cryptographic hash of the ISO. We can compare the hash of the ISO they\\npublished against the hash of the ISO we downloaded. If the hash is identical,\\nwe know the contents are exactly the same. Start the terminal and run the\\nfollowing:\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"sha1sum \u003cFILE\u003e.iso\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Next, we want to make sure the the ISO we’ve downloaded is provably supplied by\\nthe Arch Linux team. We can do this by verifying the cryptographic signature\\nthey provided with the ISO. The Arch team cryptographically signs their ISO\\nimages using public-key cryptography. This ensures that the ISO file we’ve\\ndownloaded is verifiably provided by the Arch Linux team, and not an impostor.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"This assumes you have GnuPG installed on your system (\",[\"$\",\"code\",null,{\"children\":\"brew install gnupg\"}],\"). On\\nthe ISO download page, there is a link under “Checksums” to get the PGP\\nsignature as a \",[\"$\",\"code\",null,{\"children\":\".sig\"}],\" file. Download that into the same directory as your Arch\\nISO. Then run the following, replacing the filename (here i use\\n\",[\"$\",\"code\",null,{\"children\":\"archlinux-2016-02-01-dual.iso\"}],\") with the name of the files you’ve downloaded:\"]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"gpg --verify \\\\\\n    archlinux-2016.02.01-dual.iso.sig \\\\\\n    archlinux-2016.02.01-dual.iso 2\u003e\u00261 | \\\\\\n    grep 'key ID' | \\\\\\n    gpg --recv-keys 2\u003e\u00261 `awk '{print $NF}'` \u0026\u0026 \\\\\\ngpg --verify archlinux-2016.02.01-dual.iso.sig \\\\\\n    archlinux-2016.02.01-dual.iso 2\u003e\u00261 | grep 'signature from'\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"This will first attempt to verify the signature, and if you don’t have the\\nsigners key, it’ll retrieve it. It’ll then try to verify it again, and should\\nprint out “Good signature” if it succeeds. If you get “Bad signature” this means\\nthe ISO has either been forged by an impostor pretending to be the Arch linux\\nteam, or someone has tampered with the ISO stored on their servers or in\\ntransit. If thats the case, you need to find an alternate source to download the\\nISO.\"}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"preparing-the-installation-usb-drive\",\"children\":\"Preparing the Installation USB Drive\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"This installation method will first create a bootable USB stick, which is used\\nto boot into a “Live” Arch Linux session. From there, we use the Live Arch Linux\\nto install Arch onto your MacBook hard drive, then make that partition bootable.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"If you’re currently running a GNU/Linux system, follow the instructions in\\n\",[\"$\",\"a\",null,{\"href\":\"#part-a---preparing-the-installation-usb-drive-for-linux\",\"children\":\"Part A\"}],\". If you’re\\nrunning OS X,\\n\",[\"$\",\"a\",null,{\"href\":\"#part-b---preparing-the-installation-usb-drive-for-osx\",\"children\":\"jump one section ahead to Part B\"}],\".\"]}],\"\\n\",[\"$\",\"h4\",null,{\"id\":\"part-a---preparing-the-installation-usb-drive-for-linux\",\"children\":\"Part A - Preparing the Installation USB Drive for Linux\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"If you’re already on a GNU/Linux system, use these instructions to create USB\\nbootable Arch Linux live system.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Now we’re ready to get that ISO onto a USB drive so we can boot the computer\\nfrom it. Before inserting the thumb drive, run \",[\"$\",\"code\",null,{\"children\":\"lsblk\"}],\" and take note of the\\ndrives listed. Insert the drive and run \",[\"$\",\"code\",null,{\"children\":\"lsblk\"}],\" again. Take note of the new\\nletter in the \",[\"$\",\"code\",null,{\"children\":\"sdX\"}],\" list of drives.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Replace the \",[\"$\",\"code\",null,{\"children\":\"X\"}],\" with the letter on your system. Be sure to unmount the new\\ndrive.\"]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"umount /dev/sdX\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Next, run the following command, it reads the ISO file you downloaded earlier\\nand writes the contents directly to the USB drive, without the operating system\\nbuffering the writes. Replace the \",[\"$\",\"code\",null,{\"children\":\"X\"}],\" with the letter of the USB stick you took\\nnote of earlier, and \",[\"$\",\"code\",null,{\"children\":\"ARCHLINUX\"}],\" with the name of the image file you downloaded.\"]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"dd if=ARCHLINUX.iso of=/dev/sdX bs=4M\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"After that’s run, the USB drive should be ready to boot from.\"}],\"\\n\",[\"$\",\"h4\",null,{\"id\":\"part-b---preparing-the-installation-usb-drive-for-osx\",\"children\":\"Part B - Preparing the Installation USB Drive for OSX\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Now we’re ready to get that ISO onto a USB drive so we can boot the computer\\nfrom it. Before inserting the thumb drive, run \",[\"$\",\"code\",null,{\"children\":\"diskutil list\"}],\" and take note of\\nthe drives listed. You should see output similar to this:\"]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"    /dev/disk0\\n       #:                       TYPE NAME          SIZE       IDENTIFIER\\n       0:      GUID_partition_scheme               500.1 GB   disk0\\n       1:                        EFI               209.7 MB   disk0s1\\n       2:          Apple_CoreStorage               399.5 GB   disk0s2\\n       3:                 Apple_Boot Recovery HD   650.0 MB   disk0s3\\n       5:                 Apple_Boot Boot OS X     134.2 MB   disk0s5\\n    /dev/disk1\\n       #:                       TYPE NAME          SIZE       IDENTIFIER\\n       0:                  Apple_HFS MacOSX        399.2 GB   disk1\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Insert the drive and run \",[\"$\",\"code\",null,{\"children\":\"diskutil list\"}],\" again. Take note of the new letter in\\nthe \",[\"$\",\"code\",null,{\"children\":\"sdX\"}],\" list of drives.\"]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"    /dev/disk0\\n       #:                       TYPE NAME          SIZE       IDENTIFIER\\n       0:      GUID_partition_scheme               500.1 GB   disk0\\n       1:                        EFI               209.7 MB   disk0s1\\n       2:          Apple_CoreStorage               399.5 GB   disk0s2\\n       3:                 Apple_Boot Recovery HD   650.0 MB   disk0s3\\n       5:                 Apple_Boot Boot OS X     134.2 MB   disk0s5\\n    /dev/disk1\\n       #:                       TYPE NAME          SIZE       IDENTIFIER\\n       0:                  Apple_HFS MacOSX        399.2 GB   disk1\\n    /dev/diskX\\n       #:                       TYPE NAME          SIZE       IDENTIFIER\\n       0:      GUID_partition_scheme               2.0 GB     disk2\\n       1:       Microsoft Basic Data UNTITLED 1    2.0 GB     disk2s1\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Note \",[\"$\",\"code\",null,{\"children\":\"/dev/diskX\"}],\" has appeared (‘X’ will be a number on your system), this new\\ndisk is the USB thumb drive. \",[\"$\",\"strong\",null,{\"children\":\"Important\"}],\" \",[\"$\",\"em\",null,{\"children\":\"take note of the number of this\\ndrive\"}],\".\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"We’re going to remove the existing partitions and erase all the data so its\\nclean for our Arch Linux installer. This will delete all the data on the USB\\ndrive. Make sure to substitute \",[\"$\",\"code\",null,{\"children\":\"/dev/diskX\"}],\" for the drive number you noted\\nabove.\"]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"diskutil partitionDisk /dev/diskX 1 \\\"Free Space\\\" \\\"unused\\\" \\\"100%\\\"\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Now\",[\"$\",\"sup\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#user-content-fn-4\",\"id\":\"user-content-fnref-4\",\"data-footnote-ref\":true,\"aria-describedby\":\"footnote-label\",\"children\":\"2\"}]}],\" we can write the iso\\nfile to the USB drive. \",[\"$\",\"strong\",null,{\"children\":\"Note\"}],\" We use \",[\"$\",\"code\",null,{\"children\":\"/dev/rdisk*\"}],\" instead of \",[\"$\",\"code\",null,{\"children\":\"/dev/disk\"}],\"\\nbecause it provides Raw disk access without the typical buffering the operating\\nsystemprovides. Substitute \",[\"$\",\"code\",null,{\"children\":\"DESTINATION\"}],\" with the name of the \",[\"$\",\"code\",null,{\"children\":\"iso\"}],\" file you\\ndownloaded earlier, and substitute the \",[\"$\",\"code\",null,{\"children\":\"X\"}],\" with the number of the drive.\"]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"dd if=DESTINATION.iso of=/dev/rdiskX bs=1m\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"The \",[\"$\",\"code\",null,{\"children\":\"dd\"}],\" command does not show any output before it has finished the copy\\nprocess, so be patient and wait for it to complete, it can take around 1 - 5\\nminutes. When the command does complete OS X will try to mount the drive and\\nfail as it won’t recognize the formatting. Click ignore.\"]}],\"\\n\",[\"$\",\"h2\",null,{\"id\":\"installing-arch\",\"children\":\"Installing Arch\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"With the USB drive plugged in, restart the MacBook and press+hold down the left\\n\",[\"$\",\"code\",null,{\"children\":\"option/alt\"}],\" key when you hear the startup chime. Hold the \",[\"$\",\"code\",null,{\"children\":\"option\"}],\" key down\\nuntil the drive screen appears.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"The USB drive should be one of the options. Pick it along with the first option\\nthe following boot screen lists. Now you should be at the Arch live install\\nprompt and it’ll look like this:\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"    Arch Linux 3.17.6-1-ARCH (tty1)\\n\\n    archiso login: root (automatic login)\\n    root@archiso ~ #\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"You are now running a “Live” session of Arch Linux from the USB stick.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"If you’re on a HiDPI / “Retina” display MacBook, the prompt is really small.\\nIncrease the font-size using \",[\"$\",\"code\",null,{\"children\":\"setfont sun12x22\"}],\".\"]}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"test-internet\",\"children\":\"Test Internet\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"You’ll need a working Internet connection to do the post-install. My MacBook Pro\\n7,1 and 8,2 both have Ethernet ports, but some of you will have later models\\nwithout one. You should get a USB-Ethernet adapter. Its much easier than\\nfiddling with wireless drivers as it works out of the box. We’ll setup the\\nwireless drivers later in this article.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"First, we need to get an IP address from your router:\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"dhcpcd\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"With the adapter plugged in and an IP address, make sure internet is flowing by\\npinging Google:\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"ping -c 3 www.google.com\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"You should get a response that all three packets were sent and received.\"}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"set-the-system-clock\",\"children\":\"Set the System Clock\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"The system clock should be just fine. The general Arch wiki recommends ensuring\\nthe system clock is accurate, and I’ve found it doesn’t seem to break anything.\\nSo, I run it:\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"timedatectl set-ntp true\\n\"}]}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"partition-the-hard-drive\",\"children\":\"Partition the Hard Drive\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"A partition is basically a box on the hard drive to put files into. OS X has a\\nbox for its files, and we’re going to create box(es) for GNU/Linux. Partitioning\\nthe hard drive takes existing data on the drive and moves or erases it to make\\nspace available for other file systems.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"This part is the trickiest because it can erase data on the disk, so take care.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Apple uses the GUID Partition Table (GPT), and we’re going to keep that\\npartition table.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"In order to proceed you’ll need to know the drive mapping scheme, we’ll use\\n\",[\"$\",\"code\",null,{\"children\":\"fdisk\"}],\" to check the scheme:\"]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"fdisk -l\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"This lists the existing partitions. If you created two partitions when preparing\\nthe MacBook, you should see a partition with a Type of \",[\"$\",\"code\",null,{\"children\":\"Apple HFS/HFS+\"}],\" with a\\nsize that matches the size you set aside for Arch. In my case this was\\n\",[\"$\",\"code\",null,{\"children\":\"/dev/sda5\"}],\". All the partitioning commands below will use \",[\"$\",\"code\",null,{\"children\":\"/dev/sda5\"}],\", \",[\"$\",\"strong\",null,{\"children\":\"you\\nshould substitute the designation for your drive\"}],\".\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Lets use \",[\"$\",\"code\",null,{\"children\":\"cgdisk\"}],\" to view the partition table on the attached devices: Replace\\nthe \",[\"$\",\"code\",null,{\"children\":\"Y\"}],\" with the drive you’ll be using to install Arch Linux.\"]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"cgdisk /dev/sdY\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"At the end of the partition table should be the free space you set aside for\\ninstalling Arch. With that space, we’re going to create a new partition. You\\njust need to make one partition; we’re going to break it into sub-partitions\\nlater; after encryption is setup.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"I added 128MB between the last partition and my new partition\\n\",[\"$\",\"a\",null,{\"href\":\"https://developer.apple.com/library/mac/technotes/tn2166/_index.html\",\"children\":\"because of this explanation by Apple\"}],\".\"]}],\"\\n\",[\"$\",\"blockquote\",null,{\"children\":[\"\\n\",[\"$\",\"p\",null,{\"children\":\"Note: We leave free space after each partition to make it easier for future\\nsystem software to manipulate the partition map in ways that we can’t\\nanticipate currently.\"}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Begin by deleting the \",[\"$\",\"code\",null,{\"children\":\"HFS\"}],\" partition created when you set aside space in OS X\\nfor Arch Linux.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"In order to leave additional space, just type \",[\"$\",\"code\",null,{\"children\":\"+128M\"}],\" when you create the new\\npartition, and it’ll set the starting sector at a point 128M away from the\\nending sector of the partition before it.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"You’ll want to use Linux LVM (\",[\"$\",\"code\",null,{\"children\":\"8e00\"}],\") as the partition type id. The final\\npartition table will look something like this:\"]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"    Part. #     Size        Partition Type            Partition Name\\n    ----------------------------------------------------------------\\n    3.0 KiB      free space\\n    1        200.0 MiB      EFI System                EFI System Partition\\n    2         74.5 GiB      Apple HFS/HFS+            Macintosh HD\\n    128.0 MiB      free space\\n    3        391.1 GiB      Linux LVM                 ArchLinux\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Then use the utility to select Write and then confirm that you want to overwrite\\nthe disk. Once the display returns you can Quit.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Running \",[\"$\",\"code\",null,{\"children\":\"fdisk -l\"}],\" again should show your new partition scheme. If it doesn’t\\nlook like you want or expected, repeat the \",[\"$\",\"code\",null,{\"children\":\"cgdisk\"}],\" process to fix things until\\nyou’re satisfied.\"]}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"configuring-drive-encryption-and-lvm\",\"children\":\"Configuring Drive Encryption and LVM\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"You’ll want to make note of the partition number you just created. For me it’s\\npartition \",[\"$\",\"code\",null,{\"children\":\"5\"}],\", and the drive is \",[\"$\",\"code\",null,{\"children\":\"sda\"}],\", so my Arch Linux partition can be found\\nat \",[\"$\",\"code\",null,{\"children\":\"/dev/sda5\"}],\". I’ll be using that as an example going forward, \",[\"$\",\"strong\",null,{\"children\":\"but you should\\nsubstitute your own drive path\"}],\".\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"We’re going to encrypt \",[\"$\",\"code\",null,{\"children\":\"/dev/sda5\"}],\" using DM-Crypt and then the LVM partitions\\nare going to be created over that LUKS encryption layer. This system is called\\n“LVM on LUKS.” Both LUKS encryption and LVM support are provided by the\\nGNU/Linux kernel.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"Note\"}],\" This will just encrypt the system \",[\"$\",\"code\",null,{\"children\":\"/\"}],\" and \",[\"$\",\"code\",null,{\"children\":\"/home\"}],\" directories. The\\n\",[\"$\",\"code\",null,{\"children\":\"/boot\"}],\" directory will not be encrypted because we’re going to keep the existing\\n\",[\"$\",\"code\",null,{\"children\":\"/boot\"}],\" partition: That’s \",[\"$\",\"code\",null,{\"children\":\"/dev/sda1\"}],\" in my partition table above.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"If you want to use custom ciphers, there are some great notes\\n\",[\"$\",\"a\",null,{\"href\":\"https://github.com/NoviceLive/unish/blob/master/doc/arch-install.sh#L101\",\"children\":\"available on GitHub\"}],\".\\nYou can also use the following command for speed benchmarking to help determine\\nwhich ciphers and key-sizes are fast enough for your particular use case:\"]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"cryptsetup benchmark\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Time to pick the encryption flavors! The default values for the cipher and key\\nsizes were a bit too light for my tastes (in light of the NSA spying scandal).\\nI’ve increased these numbers above the defaults, I’ve chosen to balance my\\nprincipals for privacy and security with practical usability and speed. Feel\\nfree to\\n\",[\"$\",\"a\",null,{\"href\":\"https://wiki.archlinux.org/index.php/Dm-crypt/Device_encryption#Encryption_options_for_LUKS_mode\",\"children\":\"read more on these settings\"}],\".\"]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"cryptsetup --cipher aes-xts-plain64 \\\\\\n  --key-size 512 \\\\\\n  --hash sha256 \\\\\\n  --iter-time 3000 \\\\\\n  --use-random \\\\\\n  --verify-passphrase \\\\\\n  luksFormat /dev/sda5\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Enter in a good passphrase (twice), and we should be good to go.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Now with the encryption setup, we’re going to create the necessary volumes and\\nfilesystems within the LVM.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"First, let’s open up our encrypted partition:\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"cryptsetup luksOpen /dev/sda5 lvm\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"This is going to map our encrypted device (\",[\"$\",\"code\",null,{\"children\":\"/dev/sda5\"}],\" in my case) to\\n\",[\"$\",\"code\",null,{\"children\":\"/dev/mapper/lvm\"}],\". Now we’re going to create the physical and logical volumes\\nfor the \",[\"$\",\"code\",null,{\"children\":\"/\"}],\" and \",[\"$\",\"code\",null,{\"children\":\"/home\"}],\" directories. I gave the \",[\"$\",\"code\",null,{\"children\":\"/\"}],\" directory 40GB (hopefully\\nenough for all my programs. As of writing this, and with a full install, I’m\\nusing 10GB on my \",[\"$\",\"code\",null,{\"children\":\"/\"}],\" directory. So, I think I’m good.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Create the physical volume:\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"pvcreate /dev/mapper/lvm\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Now create the volume with the name \",[\"$\",\"code\",null,{\"children\":\"vgcrypt\"}],\":\"]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"vgcreate vgcrypt /dev/mapper/lvm\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"We’re ready to create the logical volumes now, \",[\"$\",\"code\",null,{\"children\":\"40GB\"}],\" for root and the rest for\\nusers’ home, change \",[\"$\",\"code\",null,{\"children\":\"40GB\"}],\" accordingly:\"]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"lvcreate --size 40G --name root vgcrypt\\nlvcreate --extents +100%FREE --name home vgcrypt\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"We now have our two volumes \",[\"$\",\"code\",null,{\"children\":\"vgcrypt-root\"}],\" and \",[\"$\",\"code\",null,{\"children\":\"vgcrypt-home\"}],\". They need to be\\nformatted to a particular filesystem. I’ve been happy with the \",[\"$\",\"code\",null,{\"children\":\"ext4\"}],\"\\nfilesystem.\"]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"mkfs.ext4 /dev/mapper/vgcrypt-root\\nmkfs.ext4 /dev/mapper/vgcrypt-home\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"We can now mount these new partitions. Make sure to mount the root partition\\nfirst so we can create the \",[\"$\",\"code\",null,{\"children\":\"/home\"}],\" directory inside of it for the home\\npartition:\"]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"mount /dev/mapper/vgcrypt-root /mnt\\nmkdir -p /mnt/home\\nmount /dev/mapper/vgcrypt-home /mnt/home\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Lets also mount our boot partition, while we’re here. This is required so our\\nbootable initramfs can be written to the boot drive:\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"mkdir -p /mnt/boot\\nmount /dev/sda1 /mnt/boot\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"If you’re interested in swap partition schemes,\\n\",[\"$\",\"a\",null,{\"href\":\"https://github.com/NoviceLive/unish/blob/master/doc/arch-install.sh#L127\",\"children\":\"check this script out\"}],\"\\n− although I’m fine without swap partitions (Its faster with enough RAM).\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"And with that, Arch is now ready to be installed on the disk.\"}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"select-a-mirror\",\"children\":\"Select a Mirror\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"This step can optionally be skipped, but I prefer to choose a US server just in\\ncase it may be faster. Open up the mirrorlist:\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"vi /etc/pacman.d/mirrorlist\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Delete or comment out all the servers except one or two near you that seem good.\"}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"install-the-base-system\",\"children\":\"Install the Base System\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Actually installing Arch Linux onto the drive is the easiest part:\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"pacstrap -i /mnt base base-devel terminus-font\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"The \",[\"$\",\"code\",null,{\"children\":\"-i\"}],\" flag asks for confirmation before installing packages. I like using it\\njust so I can see what’s being installed. (After all that’s part of the reason\\nfor using GNU/Linux, right? To know what’s being installed on your system.)\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"This installation includes \",[\"$\",\"code\",null,{\"children\":\"terminus-font\"}],\", which we’ll configure to be the\\ndefault console font later on.\"]}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"generate-the-fstab\",\"children\":\"Generate the fstab\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"If all went according to plan, Arch has been written to the hard drive and is\\nnow installed. Before rebooting into our installation, though, we need to tell\\nthe system where to find the filesystems we created earlier for root and home\\ndirectories.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"While it’s normally a good idea to use UUIDs to find disks, we’re going to use\\nlabels. This is because our encryption setup generates random IDs for the disks\\nwhen they’re decrypted. Let’s create the \",[\"$\",\"code\",null,{\"children\":\"fstab\"}],\" file:\"]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"genfstab -L -p /mnt \u003e\u003e /mnt/etc/fstab\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"The \",[\"$\",\"code\",null,{\"children\":\"-L\"}],\" flag will generate the fstab file with labels instead of UUIDs. The\\n\",[\"$\",\"code\",null,{\"children\":\"-p\"}],\" flag prevents pseudo-filesystems from being added.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Always check the generated fstab:\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"cat /mnt/etc/fstab\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"It should look something like this:\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"#\\n# /etc/fstab: static file system information\\n#\\n# \u003cfile system\u003e    \u003cdir\u003e\u003ctype\u003e\u003coptions\u003e             \u003cdump\u003e\u003cpass\u003e\\n# /dev/mapper/vgcrypt-root\\n/dev/mapper/vgcrypt-root    /           ext4   discard,rw,relatime,data=ordered    0 1\\n\\n# /dev/mapper/vgcrypt-home\\n/dev/mapper/vgcrypt-home    /home       ext4   discard,rw,relatime,data=ordered    0 2\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"Note\"}],\" If your hard drive is a solid-state drive (SSD) and the \",[\"$\",\"code\",null,{\"children\":\"discard\"}],\"\\noption isn’t there, edit the fstab file and add it. It’s used for optimizing for\\nthe speed of SSDs.\"]}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"configure-the-system\",\"children\":\"Configure The System\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"We’re now ready to configure our new system. Let’s change root into it:\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"arch-chroot /mnt /bin/bash\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Set our system locale. I’m in the US, so I’ll only uncomment that locale from\\n\",[\"$\",\"code\",null,{\"children\":\"/etc/locale.gen\"}],\":\"]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"...\\nen_US.UTF-8 UTF-8\\nen_US ISO-8859-1\\n...\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Now generate the locales:\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"locale-gen\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Make English UTF-8 the default:\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"echo LANG=en_US.UTF-8 \u003e /etc/locale.conf\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"The default font in the virtual console is not very readable, so lets use one\\nthat is far more readable. We’re going to use the typeface “Terminus” in size 18\\nthat we installed with the base system earlier. \",[\"$\",\"code\",null,{\"children\":\"ter-118n\"}],\" basically means\\n“Terminus latin-1 size 18 Normal”. There are other sizes available: 12, 14, 16,\\n20, 22, 24, 28, 32 as well as support for multiple non-English code pages.\"]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"echo FONT=ter-118n \u003e /etc/vconsole.conf\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Set the timezone accordingly. (I live on the east coast):\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"ln -sf /usr/share/zoneinfo/America/New_York /etc/localtime\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"And set the time to the standard UTC:\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"hwclock --systohc --utc\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Because we’ve encrypted our root disk, we need to make sure the kernel loads the\\nproper modules to decrypt it on startup. Otherwise we won’t be able to boot from\\nthe unencrypted drive. We’re also going to tell the boot-sequence to load our\\ncustom font and keyboard module so we can type our passwords during boot. Edit\\n\",[\"$\",\"code\",null,{\"children\":\"/etc/mkinitcpio.conf\"}],\" and add the hooks \",[\"$\",\"code\",null,{\"children\":\"consolefont keyboard encrypt lvm2\"}],\"\\n\",[\"$\",\"strong\",null,{\"children\":\"BEFORE\"}],\" \",[\"$\",\"code\",null,{\"children\":\"filesystems\"}],\" so the HOOKS line looks like this:\"]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"HOOKS=\\\"base udev autodetect modconf block consolefont keyboard usbinput encrypt lvm2 filesystems fsck\\\"\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Now we need to regenerate the initramfs image:\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"mkinitcpio -p linux\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"So that Internet will work on reboot, we need to enable the \",[\"$\",\"code\",null,{\"children\":\"dhcpcd\"}],\" service.\\nWe’re going to keep using the ethernet-USB adapter for right now. We’ll get\\nwireless setup later. Get the name of the ethernet interface:\"]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"ip link\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"It should be \",[\"$\",\"code\",null,{\"children\":\"enp\"}],\"-something. With that, enable the service, make sure you\\nreplace INTERFACE with your interfaces name.\"]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"systemctl enable dhcpcd@INTERFACE.service\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Finally, let’s configure the machine’s hostname. You can change \",[\"$\",\"code\",null,{\"children\":\"macbook\"}],\" to\\nwhatever you’d like:\"]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"echo macbook \u003e /etc/hostname\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Add this hostname to the list of hosts. Edit \",[\"$\",\"code\",null,{\"children\":\"/etc/hosts\"}],\" and edit so it looks\\nsomething like this:\"]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"#\\n# /etc/hosts: static lookup table for host names\\n#\\n\\n#\u003cip-address\u003e   \u003chostname.domain.org\u003e   \u003chostname\u003e\\n127.0.0.1   localhost.localdomain   localhost   macbook\\n::1     localhost.localdomain   localhost   macbook\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Set a root password:\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"passwd\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Create a non-root user for yourself and set the user’s password, replace USER\\nwith the username of your choosing:\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"useradd --create-home --groups wheel --shell /bin/bash USER\\npasswd USER\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"This will create the user, add it to the group wheel (traditional group of users\\nwho can run \",[\"$\",\"code\",null,{\"children\":\"sudo\"}],\" commands), create a home directory under \",[\"$\",\"code\",null,{\"children\":\"/home/USER/\"}],\" and\\nmake his default shell \",[\"$\",\"code\",null,{\"children\":\"bash\"}],\" then set a default password for the user.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Don’t switch to the new user yet, because we’e added USER to the group \",[\"$\",\"code\",null,{\"children\":\"wheel\"}],\",\\nlets grant the wheel group \",[\"$\",\"code\",null,{\"children\":\"sudo\"}],\" privileges. Run:\"]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"visudo\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"And uncomment the following line so it looks like so:\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"%wheel ALL=(ALL) ALL\\n\"}]}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"boot-loader\",\"children\":\"Boot Loader\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Now we need to let the boot loader know where to find our new Arch Linux\\ninstallation. \",[\"$\",\"code\",null,{\"children\":\"systemd\"}],\" (was recently renamed, was Gummiboot) is a nice, simple\\nboot loader.\"]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"# pacman -S systemd              # May be systemd-boot, included in core?\\nmkdir -p /boot/loader/entries\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Setup the loader to default to arch and set the number of seconds to timeout in\\nthe file \",[\"$\",\"code\",null,{\"children\":\"/boot/loader/loader.conf\"}],\":\"]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"default arch\\ntimeout 3\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Make sure the correct boot partition (\",[\"$\",\"code\",null,{\"children\":\"/dev/sda1\"}],\" in my case) is mounted on\\n\",[\"$\",\"code\",null,{\"children\":\"/boot\"}],\" by running:\"]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"findmnt /boot\\n-------------------------\\nTARGET SOURCE    FSTYPE OPTIONS\\n/boot  /dev/sda1 vfat   rw,relatime,fmask=0022,dmask=0022,codepage=437,iocharset=iso8859-1,shortname=mixed,err\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Now we’re going to create an entry called \",[\"$\",\"code\",null,{\"children\":\"/boot/loader/entries/arch.conf\"}],\" that\\nlooks like this:\"]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"# /boot/loader/entries/arch.conf\\ntitle   Arch Linux\\nlinux   /vmlinuz-linux\\ninitrd  /initramfs-linux.img\\noptions cryptdevice=/dev/sdaX:vgcrypt:allow-discards root=/dev/mapper/vgcrypt-root rw\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"Note\"}],\":\",[\"$\",\"sup\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#user-content-fn-7\",\"id\":\"user-content-fnref-7\",\"data-footnote-ref\":true,\"aria-describedby\":\"footnote-label\",\"children\":\"3\"}]}],\" On the options\\nline, make sure you replace \",[\"$\",\"code\",null,{\"children\":\"/dev/sdaX\"}],\" with the path to the encrypted linux\\npartition we previously created on your device (It was \",[\"$\",\"code\",null,{\"children\":\"/dev/sda5\"}],\" in this\\nguide). Additionally, if your drive is \",[\"$\",\"em\",null,{\"children\":\"not\"}],\" a SSD, make sure to remove\\n\",[\"$\",\"code\",null,{\"children\":\":allow-discards\"}],\".\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"Note\"}],\":\",[\"$\",\"sup\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#user-content-fn-9\",\"id\":\"user-content-fnref-9\",\"data-footnote-ref\":true,\"aria-describedby\":\"footnote-label\",\"children\":\"4\"}]}],\" Its been reported\\nby some users that when booting to USB, the USB drive is assigned device id\\n\",[\"$\",\"code\",null,{\"children\":\"/dev/sda\"}],\" and the hard drive to \",[\"$\",\"code\",null,{\"children\":\"/dev/sdb\"}],\". When rebooting without USB drive\\n(boot to new encrypted linux drive partition), the hard drive is reassigned to\\ndevice id \",[\"$\",\"code\",null,{\"children\":\"/dev/sda\"}],\" which may invalidate the above \",[\"$\",\"code\",null,{\"children\":\"arch.conf\"}],\" boot loader\\nentry. In this case, the encrypted linux partition will not boot because the\\nboot loader config \",[\"$\",\"code\",null,{\"children\":\"arch.conf\"}],\" is configured to boot from \",[\"$\",\"code\",null,{\"children\":\"/dev/sdb\"}],\". In this\\ncase you can reboot to USB again, and edit the options line in \",[\"$\",\"code\",null,{\"children\":\"arch.conf\"}],\" to\\nread \",[\"$\",\"code\",null,{\"children\":\"/dev/sdaX\"}],\". Replace X with your partition id.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Check the boot tree with \",[\"$\",\"code\",null,{\"children\":\"tree /boot/\"}],\" (If \",[\"$\",\"code\",null,{\"children\":\"tree\"}],\" isn’t installed, install it\\nwith \",[\"$\",\"code\",null,{\"children\":\"pacman -S tree\"}],\"). It should look something like this:\"]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"/boot/\\n├── EFI\\n│   ├── APPLE\\n│   │   └── EXTENSIONS\\n│   │       └── Firmware.scap\\n│   ├── Boot\\n│   │   └── BOOTX64.EFI\\n│   └── gummiboot\\n│       └── gummibootx64.efi\\n├── initramfs-linux-fallback.img\\n├── initramfs-linux.img\\n├── loader\\n│   ├── entries\\n│   │   └── arch.conf\\n│   └── loader.conf\\n└── vmlinuz-linux\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"Note\"}],\": At this point, you may want to enable suspend-to-disk (No power\\nconsumption aka “Hibernate” mode). I’ve chosen not to enable this functionality,\\nbut if you’re interested, you can\\n\",[\"$\",\"a\",null,{\"href\":\"http://loicpefferkorn.net/2015/01/arch-linux-on-macbook-pro-retina-2014-with-dm-crypt-lvm-and-suspend-to-disk/#suspend-to-disk-uswsusp:385892e3ac2613dca78d22bd09dbae7d\",\"children\":\"read about it here\"}],\".\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Now we can have the bootloader write the initramfs onto the boot partition using\\n\",[\"$\",\"code\",null,{\"children\":\"bootctl\"}],\", part of the systemd-boot package.\"]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"bootctl install\\n\"}]}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"reboot-into-new-installation\",\"children\":\"Reboot into New Installation\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Let’s leave the chroot environment we used for the install:\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"exit\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"You can umount and close the encrypted volume:\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"umount -R /mnt\\ncryptsetup close vgcrypt\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"It’s not a bad idea to just double check the encryption to make sure it opens\\nand mounts properly:\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"cryptsetup open /dev/sda5 vgcrypt\\nmount /dev/mapper/vgcrypt /mnt\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"If all goes accordingly, you can unmount and close the encryption again. And\\nfinally…\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"reboot\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"On reboot you should be greeted with the boot menu. After selecting Arch (or\\nwaiting for it to timeout), you should be prompted for your password to decrypt\\nthe drive, and then it should boot into the console.\"}],\"\\n\",[\"$\",\"h2\",null,{\"id\":\"configuring-arch\",\"children\":\"Configuring Arch\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"You should now be running Arch Linux! Lets customize it and make it more useful.\"}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"install-an-arch-user-repository-package-manager\",\"children\":\"Install an Arch User Repository Package Manager\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Now we’re about to dive deep into customizing Arch Linux installation with the\\nutilities and application we’ll be using on a day-to-day basis. To facilitate\\ninstalling packages from the wider Arch User Repository (AUR), we’ll install a\\nutility named \",[\"$\",\"code\",null,{\"children\":\"yaourt\"}],\". You can (of course) maintain AUR package installations\\nmanually, but I like a helper to help me manage them. yaourt is like the\\nHomebrew of Arch Linux. I use\\n\",[\"$\",\"a\",null,{\"href\":\"https://wiki.archlinux.org/index.php/Yaourt\",\"children\":\"yaourt\"}],\" because it’s easy to\\ninstall, takes the same optional flags as \",[\"$\",\"code\",null,{\"children\":\"pacman\"}],\", and works well.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"You need to use the “official” and manual way of installing AUR packages to get\\nyaourt installed. It also requires \",[\"$\",\"code\",null,{\"children\":\"package-query\"}],\" from the AUR, so we’re going\\nto install that first.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Now we’re going to download the \",[\"$\",\"code\",null,{\"children\":\"package-query\"}],\" AUR package, unarchive it, and\\nuse pacman to build and install the package. This allows us to manage the\\npackage as if it was installed with pacman, although we’re manually installing\\nit.\"]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"$$ cd ~\\n$ curl -L -O https://aur.archlinux.org/cgit/aur.git/snapshot/package-query.tar.gz\\n$ tar -xvzf package-query.tar.gz\\n$ cd package-query\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Within the packages’ folder, we’re going to run the following to build it:\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"$$ makepkg -s\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"This will run as your regular user only asking you for your root password if\\nnecessary. With the package made, we can install it via pacman:\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"# pacman -U package-query-1.6.2-1-x86_64.pkg.tar.xz\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Now we’ll do the same for yaourt:\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"$$ cd ~\\n$ curl -L -O https://aur.archlinux.org/cgit/aur.git/snapshot/yaourt.tar.gz\\n$ tar -xvzf yaourt.tar.gz\\n$ cd yaourt\\n$ makepkg -s\\n# pacman -U yaourt-1.6-1-any.pkg.tar.xz\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"From now on you can use \",[\"$\",\"code\",null,{\"children\":\"pacman\"}],\" and \",[\"$\",\"code\",null,{\"children\":\"yaourt\"}],\" interchangeably… for the most\\npart. \",[\"$\",\"code\",null,{\"children\":\"yaourt\"}],\" will install Arch repository packages and AUR packages. \",[\"$\",\"code\",null,{\"children\":\"pacman\"}],\",\\nthough, will continue to only install Arch repository packages.\"]}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"configure-sound\",\"children\":\"Configure Sound\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"ALSA works out of the box with Macs so install it via:\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"# pacman -S alsa-utils\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Then use:\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"alsamixer\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"to control the speakers. Make sure to disable channels for speakers you don’t\\nhave. Test your speakers with:\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"speaker-test -c 2\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"where 2 is the number of speakers.\"}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"install-x-and-video-drivers\",\"children\":\"Install X and Video Drivers\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"As this is going to be a graphical interface, we need are graphics card up and\\nrunning with the proper drivers. Luckily this machine uses Intel graphics, and\\nIntel is pretty good about providing Linux (and sometimes open-source) drivers.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"For Macbookpro 7,1 (Mid-2010 or 8,2 (Early-2011):\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"# pacman -S xf86-video-intel mesa-libgl libva-intel-driver libva\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"For Macbookpro 11,3\\n(Late-2013)\",[\"$\",\"sup\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#user-content-fn-8\",\"id\":\"user-content-fnref-8\",\"data-footnote-ref\":true,\"aria-describedby\":\"footnote-label\",\"children\":\"5\"}]}]]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"# pacman -S nvidia mesa-libgl libva-intel-driver libva\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"The \",[\"$\",\"code\",null,{\"children\":\"-S\"}],\" flag tells pacman to install the subsequent packages listed. (Again,\\nyou can use yaourt if you’d like.) This will install the Intel video driver, the\\nMesa OpenGL graphics library, and video acceleration API for Intel graphics\\nchipsets. It’ll likely ask you to install additional dependencies. Get all the\\ndependencies!\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"With the necessary drivers installed, we can get Xorg (or the X Window System)\\ninstalled.\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"# pacman -S xorg-server xorg-server-utils xorg-xinit xterm\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"I like to install the Xorg utilities, too, because there are at least a couple\\nI’ll use later (either in this guide or another) that are helpful in improving\\nHiDPI support for the MacBook’s HiDPI Retina display.\"}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"some-gui-applications\",\"children\":\"Some GUI Applications\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Next we’ll install a browser. This will install some typeface dependencies and\\nfont- rendering libraries that we’ll be tweaking later.\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"# pacman -S firefox\\n\"}]}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"improved-typography\",\"children\":\"Improved Typography\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"$\",\"strong\",null,{\"children\":[\"Update\",[\"$\",\"sup\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#user-content-fn-10\",\"id\":\"user-content-fnref-10\",\"data-footnote-ref\":true,\"aria-describedby\":\"footnote-label\",\"children\":\"6\"}]}]]}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":[\"It appears\\n\",[\"$\",\"a\",null,{\"href\":\"https://github.com/bohoomil/fontconfig-ultimate/issues/191\",\"children\":\"the package maintainer for Infinality has gone dark\"}]]}],\".\\nSkip this section and \",[\"$\",\"a\",null,{\"href\":\"#window-manager-awesome\",\"children\":\"continue to the next\"}],\" until\\nthere is a solution for better typography on the linux desktop.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"If you use the web and appreciate typography, you’ll want to install a set of\\ndecent fonts.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Infinality is a package group that has been meticulously crafted from the\\nground-up to provide beautifully rendered typography to the Linux platform. The\\npackage maintainer spent a ton of time tearing down the existing font stack, and\\ncarefully rebuilding it to provide fast-rendering fonts that more faithfully\\npresent the typography than either Windows, OS X or Ubuntu systems. It also\\nprovides a set of preset-configurations that allow the user to switch to a\\nWindows-like or OS X-like configuration. I highly recommend\\n\",[\"$\",\"a\",null,{\"href\":\"http://bohoomil.com/doc/\",\"children\":\"reading the documentation\"}],\" if you’d like to know more\\nabout typography rendering on GNU/Linux.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"First add the following package repositories to \",[\"$\",\"code\",null,{\"children\":\"/etc/pacman.conf\"}],\".\"]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"    [infinality-bundle]\\n    Server = http://bohoomil.com/repo/$arch\\n    [infinality-bundle-fonts]\\n    Server = http://bohoomil.com/repo/fonts\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Next we’ll add the\\n\",[\"$\",\"a\",null,{\"href\":\"https://bbs.archlinux.org/viewtopic.php?id=162098\",\"children\":\"package maintainers PGP key\"}],\"\\nto the package database, update the package database and install the packages.\"]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"# pacman-key -r 962DDE58\\n# pacman-key --lsign-key 962DDE58\\n# pacman -Syyu\\n# pacman -S infinality-bundle\\n# pacman -S infinality-bundle-fonts\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Make sure to select the option \",[\"$\",\"code\",null,{\"children\":\"fontconfig-infinality-ultimate\"}],\" as that\\nconfiguration\\n\",[\"$\",\"a\",null,{\"href\":\"http://bohoomil.com/doc/01-overview/\",\"children\":\"is the most clean, efficient and looks the best out of the box\"}],\".\\nThe installation may ask to use the Infinality packages in place of the\\ndependencies installed by Firefox. Choose the Infinality packages.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"To enable selection of predefined font substitution styles and antialiasing\\nsettings, apart from the rendering settings of the engine itself. After doing\\nso, you can select the font style (win7, winxp, osx, linux, …) with:\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"# fc-presets set\\n\"}]}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"window-manager-awesome\",\"children\":\"Window Manager Awesome\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Awesome is a tiling window manager for the user that prefers keyboard commands\\nto mouse or touchpad, and treats window chrome as needless ornamentation. Your\\napplication content is king, and efficiency is the goal. Its quick and light.\\nLets install the window manager (WM), awesome.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"To install:\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"# pacman -S awesome\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Added this\",[\"$\",\"sup\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#user-content-fn-5\",\"id\":\"user-content-fnref-5\",\"data-footnote-ref\":true,\"aria-describedby\":\"footnote-label\",\"children\":\"7\"}]}],\" to run \",[\"$\",\"code\",null,{\"children\":\"awesome\"}],\"\\nwhen x starts:\"]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"echo exec awesome \u003e .xinitrc\\n\"}]}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"touchpad-support\",\"children\":\"Touchpad Support\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"You’ll probably want to use your MacBook’s touchpad when you have a GUI. The\\nsimplest driver is the synaptics driver:\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"# pacman -S xf86-input-synaptics\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"The following config at /usr/share/X11/xorg.conf.d/70-synaptics.conf works well\\nfor me, it uses the same “Natural Motion” that OS X does. Copy that file to the\\nfollowing location \",[\"$\",\"code\",null,{\"children\":\"/etc/X11/xorg.conf.d/70-synaptics.conf\"}],\" and add the options\\nbetween the \",[\"$\",\"code\",null,{\"children\":\"START\"}],\" and \",[\"$\",\"code\",null,{\"children\":\"END\"}],\" comments.\"]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"Section \\\"InputClass\\\"\\n    MatchIsTouchpad \\\"on\\\"\\n    Identifier      \\\"touchpad catchall\\\"\\n    Driver          \\\"synaptics\\\"\\n\\n    # START: Add these options\\n    # 1 = left, 2 = right, 3 = middle\\n    Option          \\\"TapButton1\\\" \\\"1\\\"\\n    Option          \\\"TapButton2\\\" \\\"3\\\"\\n    Option          \\\"TapButton3\\\" \\\"2\\\"\\n    # Palm detection\\n    Option          \\\"PalmDetect\\\" \\\"1\\\"\\n    # Horizontal scrolling\\n    Option \\\"HorizTwoFingerScroll\\\" \\\"1\\\"\\n    Option \\\"VertTwoFingerScroll\\\" \\\"on\\\"\\n    # Natural Scrolling (and speed)\\n    Option \\\"VertScrollDelta\\\" \\\"-450\\\"\\n    Option \\\"HorizScrollDelta\\\" \\\"-450\\\"\\n    # END\\nEndSection\\n\"}]}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"configuring-wireless\",\"children\":\"Configuring Wireless\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Before rebooting into our lovely new GUI, let’s get wireless setup to work when\\nwe reboot.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"This particular machine has the Broadcom BCM4360 wireless chipset. Broadcom has\\nbeen pretty mixed in the FLOSS support it seems. The BCM4360 is not supported by\\nthe kernel itself, so we’ll need to use Broadcom’s non-free, non-open driver:\\n\",[\"$\",\"code\",null,{\"children\":\"broadcom-wl\"}],\". I actually don’t think this even officially supports the BCM4360\\nchipset, but it works well enough. We’ll need to install the AUR package:\"]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"$$ yaourt -S broadcom-wl dialog wpa_supplicant\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"And activate the kernel module:\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"# modprobe wl\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[[\"$\",\"strong\",null,{\"children\":\"Note\"}],\": If you update to a newer kernel in the future, you may need to\\nuninstall and reinstall the \",[\"$\",\"code\",null,{\"children\":\"broadcom-wl\"}],\" package so it updates with the new\\nlinux-header.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"We need to stop the dhcpcd service we were using for the ethernet and start the\\n\",[\"$\",\"code\",null,{\"children\":\"wifi-menu\"}],[\"$\",\"sup\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#user-content-fn-1\",\"id\":\"user-content-fnref-1-2\",\"data-footnote-ref\":true,\"aria-describedby\":\"footnote-label\",\"children\":\"1\"}]}],\" utility.\\nKeeping both running can cause conflicts.\"]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"# systemctl disable dhcpcd.service\\n# wifi-menu\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"This will create and enable a systemd service that will start when the computer\\nboots. Changes to the profile file will not propagate to the service file\\nautomatically. After such changes, it is necessary to reenable the profile:\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"# netctl reenable PROFILE\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"After enabling a profile, it will be started at next boot.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Finally, if you find your wireless is dropping connections, you may find turning\\noff Wi-Fi power management. Simply create this as an executable ( chmod +x\\n\",[\"$\",\"code\",null,{\"children\":\"/etc/pm/wireless\"}],\" and add the following contents:\"]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"#!/bin/sh\\niwconfig wlp2s0 power off\\n\"}]}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"done\",\"children\":\"Done!\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Now when you reboot, you should be all set to go start customizing to your\\nheart’s content, adding applications as you’d like, and playing around with your\\nnew Arch Linux box with Awesome.s\"}],\"\\n\",[\"$\",\"h2\",null,{\"id\":\"fine-tuning\",\"children\":\"Fine Tuning\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Power settings took quite a bit of tweaking. Without these setting, the laptop\\nran very hot, and drained battery life very fast. I would recommend following\\nthese steps to improve battery life. There still may be room for improvement,\\nthough.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"One more thing: If you search “MacBook Pro and Arch Linux” you’ll probably read\\nsome things about disabling ACPI interrupts that were causing overheating and\\nhigh CPU usage. If you have updated to the latest version of OS X 10.10\\n“Yosemite” then you should be OK to skip.\"}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"display-color-profile\",\"children\":\"Display Color Profile\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"I noticed that colors seemed washed-out in Arch Linux, so this task will attempt\\nto color-correct the display. Luckily a utility \",[\"$\",\"code\",null,{\"children\":\"xcalib\"}],\" exists that can load\\ncolor profiles from OS X as X options. This should give you true color-parity\\nbetween operating systems.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"First, boot into OS X and copy the color profiles located in\\n\",[\"$\",\"code\",null,{\"children\":\"/Library/ColorSync/Profiles/Displays\"}],\" to somewhere so you can boot into\\nGNU/Linux and copy them into your home directory. I created a directory named\\n\",[\"$\",\"code\",null,{\"children\":\"~/.colorprofiles\"}],\" for these files.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Second, install the \",[\"$\",\"code\",null,{\"children\":\"xcalib\"}],\" package from the Arch AUR.\"]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"yaourt -S xcalib\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Finally you can activate it by running:\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"xcalib ~/.colorprofiles/FILENAME.icc\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Where \",[\"$\",\"code\",null,{\"children\":\"FILENAME\"}],\" is the path to your color profile file.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"To load this color profile when X starts, I also added this command to the\\n\",[\"$\",\"code\",null,{\"children\":\".xinitrc\"}],\" file in my home directory. Just make sure you replace \",[\"$\",\"code\",null,{\"children\":\"FILENAME\"}],\" with\\nthe name of your color-profile \",[\"$\",\"code\",null,{\"children\":\".icc\"}],\" file exported from OS X.\"]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"if [ `type -P xcalib` ]; then\\n  # Use the color profile\\n  xcalib ~/.colorprofiles/FILENAME.icc\\nfi;\\n\"}]}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"display-color-correction\",\"children\":\"Display Color Correction\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"If you spend as many hours looking at the display as I do, you’ll quickly\\nappreciate a display that adapts its colors to the time of day.\\n\",[\"$\",\"a\",null,{\"href\":\"https://justgetflux.com\",\"children\":\"F.lux\"}],\" adjusts monitor color temperature adaptively to\\nease eye strain.\"]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"yaourt -S xfluxd\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Then edit \",[\"$\",\"code\",null,{\"children\":\"/etc/xfluxd.conf\"}],\" to set your rough lat/long coordinates (in decimal\\nformat) in order to correctly shift the color correction with the sunrise and\\nsunset.\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Finally, enable and start the \",[\"$\",\"code\",null,{\"children\":\"xfluxd\"}],\" service. \",[\"$\",\"strong\",null,{\"children\":\"Note\"}],\" you should run this as\\nyour normal user, not as root.\"]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"systemctl enable --user xfluxd\\nsystemctl start --user xfluxd\\n\"}]}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"power-management\",\"children\":\"Power Management\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"The power management from Arch out of the box is not very good. There are a few\\ngood tools out there, but \",[\"$\",\"code\",null,{\"children\":\"PowerTOP\"}],\" is nice because of its benchmarking\\nutilities\",[\"$\",\"sup\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#user-content-fn-2\",\"id\":\"user-content-fnref-2\",\"data-footnote-ref\":true,\"aria-describedby\":\"footnote-label\",\"children\":\"8\"}]}],\".\"]}],\"\\n\",[\"$\",\"blockquote\",null,{\"children\":[\"\\n\",[\"$\",\"p\",null,{\"children\":\"PowerTOP is a tool provided by Intel to enable various powersaving modes in\\nuserspace, kernel and hardware. It is possible to monitor processes and show\\nwhich of them are utilizing the CPU and wake it from its Idle-States, allowing\\nyou to identify applications with particular high power demands.\"}],\"\\n\"]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"yaourt -S powertop\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"You may want to put your laptop on battery power and calibrate powertop:\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"# powertop --calibrate\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"That’ll cause the screen to blackout from time to time. Just let it run. It\\ntakes a few minutes then your screen will come back on.\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"You can create a systemd service that will launch powertop’s autotune settings\\non startup.\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"# /etc/systemd/system/powertop.service\\n\\n[Unit]\\nDescription=Powertop tunings\\n\\n[Service]\\nType=oneshot\\nExecStart=/usr/bin/powertop --auto-tune\\n\\n[Install]\\nWantedBy=multi-user.target\\n\\nAnd enable it to automatically start at boot time, then start it for your\\ncurrent boot session.\\n\"}]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"# systemctl enable powertop.service\\n# systemctl start powertop.service\\n\"}]}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"laptop-mode-tools\",\"children\":\"Laptop Mode Tools\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Laptop Mode Tools\",[\"$\",\"sup\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#user-content-fn-6\",\"id\":\"user-content-fnref-6\",\"data-footnote-ref\":true,\"aria-describedby\":\"footnote-label\",\"children\":\"9\"}]}],\" is a\\nlaptop power saving package for Linux systems. It is the primary way to enable\\nthe Laptop Mode feature of the Linux kernel, which allows you to tweak a number\\nof other power-related settings using a simple configuration file. Combined with\\n\",[\"$\",\"code\",null,{\"children\":\"acpid\"}],\" and CPU frequency scaling, LMT provides a complete notebook power\\nmanagement suite.\"]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"$$ yaourt -S laptop-mode-tools\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"If you want to enable laptop mode even on AC power, because you run the laptop\\nattached to an external keyboard and monitor, edit:\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"# /etc/laptop-mode/laptop-mode.conf`:\\n...\\nENABLE_LAPTOP_MODE_ON_AC=1\\n...\\nENABLE_LAPTOP_MODE_WHEN_LID_CLOSED=1\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"We’re going to disable LMT from handling CPU frequency scaling since we’ve setup\\n\",[\"$\",\"code\",null,{\"children\":\"cpupower\"}],\" to handle that:\"]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"# /etc/laptop-mode/conf.d/cpufreq.conf\\n...\\n# CONTROL_CPU_FREQUENCY=\\\"AUTO\\\"\\nCONTROL_CPU_FREQUENCY=0\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"and disable Intel pstate handling as well:\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"# /etc/laptop-mode/conf.d/intel_pstate.conf\\n# CONTROL_INTEL_PSTATE=\\\"auto\\\"\\nCONTROL_INTEL_PSTATE=0\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Finally, enable and start the systemd service:\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"# systemctl enable laptop-mode.service\\n# systemctl start  laptop-mode.service\\n\"}]}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"acpid\",\"children\":\"acpid\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"A very useful tool is from the \",[\"$\",\"code\",null,{\"children\":\"acpi\"}],\" package, which provides battery\\ninformation using the command \",[\"$\",\"code\",null,{\"children\":\"acpi -v\"}],\". To install:\"]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"# pacman -S acpi\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[[\"$\",\"code\",null,{\"children\":\"acpid\"}],\" is an extensible daemon for handling ACPI events. It can run commands\\nwhen the laptop lid is closed, etc.\"]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"# pacman -S acpid\\n# systemctl enable acpid.service\\n# systemctl start  acpid.service\\n\"}]}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"cpu-frequency-scaling\",\"children\":\"CPU Frequency Scaling\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Another utility that will help with CPU frequency scaling is \",[\"$\",\"code\",null,{\"children\":\"cpupower\"}],\", it\\nprovides useful CLI utilities and a systemd service to change the CPU governor\\nat boot.\"]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"$$ yaourt -S cpupower\\n# systemctl enable cpupower\\n# systemctl start cpupower\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"I use cpupower to modulate the CPU’s speeds. This keeps CPU in check from maxing\\nout at all times. My cpupower config file at \",[\"$\",\"code\",null,{\"children\":\"/etc/default/cpupower\"}],\" has the\\nfollowing line changed:\"]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"governor='powersave'\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"You should adjust this setting to your own needs.\"}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"temperature-management\",\"children\":\"Temperature Management\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Intel provides a daemon that will keep tabs on the CPUs’ temperature and adjust\\nsettings to keep it from getting too hot, its called \",[\"$\",\"code\",null,{\"children\":\"thermald\"}],\".\"]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"$$ yaourt -S thermald\\n# systemctl enable thermald.service\\n# systemctl start thermald.service\\n\"}]}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"fan-control\",\"children\":\"Fan Control\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Finally, the kernel doesn’t seem to have very fine control over the MacBook’s\\nfan. The following script helps add fine-tuning for the fan that will increase\\nits baseline speed and ramp it up gently, so it’s not an all-or-nothing kind of\\nsetup.\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"$$ yaourt -S mbpfan-git\\n# systemctl enable mbpfan.service\\n# systemctl start mbpfan.service\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"By default the service runs in verbose mode which adds tons of output to the\\nsystem journal. It basically works by measuring the CPU temp, adjusting the fan\\nspeed accordingly, and then sleeping for a given number of seconds. With verbose\\nmode on, it logs its wakeup every few seconds. That means a lot of writing to\\nthe journal. So I changed the service under\\n\",[\"$\",\"code\",null,{\"children\":\"/usr/lib/systemd/system/mbpfan.service\"}],\" so the following line reads like so:\"]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"ExecStart=/usr/sbin/mbpfan -f\\n\"}]}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"apple-keyboard\",\"children\":\"Apple Keyboard\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"To get the \",[\"$\",\"code\",null,{\"children\":\"fn\"}],\" keys working in X, we will install \",[\"$\",\"code\",null,{\"children\":\"xbindkeys\"}],\" which helps bind\\nkeyboard keys to commands. We will bind keys for volume, keyboard and display\\nbrightness.\"]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"# pacman -S xbindkeys\\nyaourt -S xorg-xbacklight kbdlight\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Create your configuration file for xbindkeys: \",[\"$\",\"code\",null,{\"children\":\".xbindkeysrc\"}]]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"# Increase volume 5% with Apple volume up\\n\\\"amixer set Master playback 5%+\\\"\\n    m:0x0 + c:123\\n    XF86AudioRaiseVolume\\n# Increase volume 5% with F12\\n\\\"amixer set Master playback 5%+\\\"\\n    m:0x0 + c:96\\n\\n\\n# Decrease volume 5% with Apple volume down\\n\\\"amixer set Master playback 5%-\\\"\\n    m:0x0 + c:122\\n    XF86AudioLowerVolume\\n# Decrease volume 5% with F11\\n\\\"amixer set Master playback 5%-\\\"\\n    m:0x0 + c:95\\n\\n\\n# Mute with Apple mute\\n\\\"amixer set Master toggle\\\"\\n    m:0x0 + c:121\\n    XF86AudioMute\\n# Mute with F10\\n\\\"amixer set Master toggle\\\"\\n    m:0x0 + c:76\\n\\n\\n# Suspend system\\n\\\"systemctl suspend\\\"\\n    m:0x0 + Mod4 + c:107\\n    Mod4 + XF86Eject\\n\\n\\n# Dim keyboard\\n\\\"kbdlight down\\\"\\n    m:0x0 + c:237\\n    XF86KbdBrightnessUp\\n\\n\\n# Brighten keyboard\\n\\\"kbdlight up\\\"\\n    m:0x0 + c:238\\n    XF86KbdBrightnessDown\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Next we’ll auto-start xbindkeys when X starts, add this to your \",[\"$\",\"code\",null,{\"children\":\".xinitrc\"}],\" file:\"]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"if [ `type -P xbindkeys` ]; then\\n  # Load custom keyboard key bindings\\n  xbindkeys\\nfi;\\n\"}]}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"apple-trackpad\",\"children\":\"Apple Trackpad\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Finally\",[\"$\",\"sup\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"#user-content-fn-3\",\"id\":\"user-content-fnref-3\",\"data-footnote-ref\":true,\"aria-describedby\":\"footnote-label\",\"children\":\"10\"}]}],\", we’ll setup a\\nBluetooth Apple Trackpad. To do this, we’ll install some bluetooth core\\nutilities\"]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"children\":\"# pacman -S bluez bluez-utils\\n# modprobe btusb  # Make sure bluetooth kernel module is loaded\\n# systemctl enable bluetooth.service  # Start bluetooth on reboot\\n# systemctl start bluetooth.service\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"To actually connect to the Trackpad, we’ll use the \",[\"$\",\"code\",null,{\"children\":\"bluetoothctl\"}],\" interactive\\nutility to scan-for, discover, pair and connect to the Trackpad. (If your\\nTrackpad is already paired with another device, make sure to turn it off, then\\nlong-hold the power button until the LED flashes.)\"]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"$$ bluetoothctl\\n\u003e power on\\n\u003e scan on\\n\u003e agent on\\n\u003e devices    # You should see the MAC address of your Trackpad appear if its in discoverable mode\\n\u003e pair mac 28:37:37:2B:42:7A\\n\u003e connect 28:37:37:2B:42:7A\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"Then we’ll setup some \",[\"$\",\"code\",null,{\"children\":\"udev\"}],\" rules so USB Bluetooth is activated and loade when\\nthe system boots up.\"]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"# /etc/udev/rules.d/10-local.rules\\n# Set bluetooth power up\\nACTION==\\\"add\\\", KERNEL==\\\"hci0\\\", RUN+=\\\"/usr/bin/hciconfig hci0 up\\\"\\n\"}]}],\"\\n\",[\"$\",\"h2\",null,{\"id\":\"conclusion\",\"children\":\"Conclusion\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Wrapping up, I have nothing to add other than what you do with your system is up\\nto you.\"}],\"\\n\",[\"$\",\"h2\",null,{\"id\":\"references\",\"children\":\"References\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"The following articles were very useful in providing some help and inspiration.\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"https://mchladek.me/post/arch-mbp/\",\"children\":\"Installing Arch Linux on a MacBook Pro - Michael Chladek\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"http://zanshin.net/2015/02/05/arch-linux-on-a-macbook-pro-part-1-creating-a-usb-installer/\",\"children\":\"Introductory MacBook Arch Guide - Zanshin\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"http://loicpefferkorn.net/2015/01/arch-linux-on-macbook-pro-retina-2014-with-dm-crypt-lvm-and-suspend-to-disk/\",\"children\":\"Arch Linux on MacBook Pro Retina 2014 with DM-Crypt, LVM and suspend to disk - Loïc Pefferkorn\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"https://wiki.archlinux.org/index.php/MacBook\",\"children\":\"ArchWiki MacBook\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"https://wiki.archlinux.org/index.php/MacBookPro11,x\",\"children\":\"ArchWiki MacBookPro11,x\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"https://medium.com/@philpl/arch-linux-running-on-my-macbook-2ea525ebefe3#.ai90cnihe\",\"children\":\"Arch Linux Running on my MacBook - Phil Plückthun\"}]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"https://www.youtube.com/watch?v=Fzmm87oVQ6c\",\"children\":\"My personal fight against the modern laptop\"}]}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Any changes to this article will be annotated with a footnote and explained\\nhere.\"}],\"\\n\",[\"$\",\"section\",null,{\"data-footnotes\":true,\"className\":\"footnotes\",\"children\":[[\"$\",\"h2\",null,{\"className\":\"sr-only\",\"id\":\"footnote-label\",\"children\":\"Footnotes\"}],\"\\n\",[\"$\",\"ol\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"id\":\"user-content-fn-1\",\"children\":[\"\\n\",[\"$\",\"p\",null,{\"children\":[\"March 6, 2016: Previously used \",[\"$\",\"code\",null,{\"children\":\"NetworkManager\"}],\" to detect\\nand connect to WiFi networks, but have changed to use\\n\",[\"$\",\"code\",null,{\"children\":\"netctl\"}],\" and \",[\"$\",\"code\",null,{\"children\":\"wifi-menu\"}],\" as these commands are\\nmore low-level and have fewer dependencies. \",[\"$\",\"a\",null,{\"href\":\"#user-content-fnref-1\",\"data-footnote-backref\":true,\"className\":\"data-footnote-backref\",\"aria-label\":\"Back to content\",\"children\":\"↩\"}],\" \",[\"$\",\"a\",null,{\"href\":\"#user-content-fnref-1-2\",\"data-footnote-backref\":true,\"className\":\"data-footnote-backref\",\"aria-label\":\"Back to content\",\"children\":[\"↩\",[\"$\",\"sup\",null,{\"children\":\"2\"}]]}]]}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",null,{\"id\":\"user-content-fn-4\",\"children\":[\"\\n\",[\"$\",\"p\",null,{\"children\":[\"March 14, 2016: Thanks\\n\",[\"$\",\"a\",null,{\"href\":\"https://www.reddit.com/r/archlinux/comments/493k4n/installing_encrypted_arch_linux_on_an_apple/d0y36h4?context=3\",\"children\":\"Fr0gm4n\"}],\"\\nfor suggestions simplifying the writing of \",[\"$\",\"code\",null,{\"children\":\"iso\"}],\"\\nimages to USB. \",[\"$\",\"a\",null,{\"href\":\"#user-content-fnref-4\",\"data-footnote-backref\":true,\"className\":\"data-footnote-backref\",\"aria-label\":\"Back to content\",\"children\":\"↩\"}]]}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",null,{\"id\":\"user-content-fn-7\",\"children\":[\"\\n\",[\"$\",\"p\",null,{\"children\":[\"April 2, 2016: Thanks\\n\",[\"$\",\"a\",null,{\"href\":\"https://www.reddit.com/r/archlinux/comments/493k4n/installing_encrypted_arch_linux_on_an_apple/d1mleow?context=3\",\"children\":\"Perceptes\"}],\"\\nfor helping to clarify the text explaining how to configure the bootloader. \",[\"$\",\"a\",null,{\"href\":\"#user-content-fnref-7\",\"data-footnote-backref\":true,\"className\":\"data-footnote-backref\",\"aria-label\":\"Back to content\",\"children\":\"↩\"}]]}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",null,{\"id\":\"user-content-fn-9\",\"children\":[\"\\n\",[\"$\",\"p\",null,{\"children\":[\"December 2, 2016: Thanks to Joshua Brown for clarifications to writing the bootloader line. \",[\"$\",\"a\",null,{\"href\":\"#user-content-fnref-9\",\"data-footnote-backref\":true,\"className\":\"data-footnote-backref\",\"aria-label\":\"Back to content\",\"children\":\"↩\"}]]}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",null,{\"id\":\"user-content-fn-8\",\"children\":[\"\\n\",[\"$\",\"p\",null,{\"children\":[\"July 28, 2016: Updated to support Macbookpro 11,3 devices with NVidia cards. This device uses NVIDIA GeForce GT 750M (Codename NVE7/GK107). \",[\"$\",\"a\",null,{\"href\":\"#user-content-fnref-8\",\"data-footnote-backref\":true,\"className\":\"data-footnote-backref\",\"aria-label\":\"Back to content\",\"children\":\"↩\"}]]}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",null,{\"id\":\"user-content-fn-10\",\"children\":[\"\\n\",[\"$\",\"p\",null,{\"children\":[\"February 6, 2017: If anyone has a solution to the loss of Infinality bundle\\ntypography, please drop me a line. \",[\"$\",\"a\",null,{\"href\":\"#user-content-fnref-10\",\"data-footnote-backref\":true,\"className\":\"data-footnote-backref\",\"aria-label\":\"Back to content\",\"children\":\"↩\"}]]}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",null,{\"id\":\"user-content-fn-5\",\"children\":[\"\\n\",[\"$\",\"p\",null,{\"children\":[\"March 18, 2016: Changed references to \",[\"$\",\"code\",null,{\"children\":\".Xinitrc\"}],\" to the\\ncorrect filename, \",[\"$\",\"code\",null,{\"children\":\".xinitrc\"}],\". \",[\"$\",\"a\",null,{\"href\":\"#user-content-fnref-5\",\"data-footnote-backref\":true,\"className\":\"data-footnote-backref\",\"aria-label\":\"Back to content\",\"children\":\"↩\"}]]}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",null,{\"id\":\"user-content-fn-2\",\"children\":[\"\\n\",[\"$\",\"p\",null,{\"children\":[\"March 8, 2016: Previously omitted the \",[\"$\",\"code\",null,{\"children\":\"-S\"}],\" option in\\nyaourt, fixed. \",[\"$\",\"a\",null,{\"href\":\"#user-content-fnref-2\",\"data-footnote-backref\":true,\"className\":\"data-footnote-backref\",\"aria-label\":\"Back to content\",\"children\":\"↩\"}]]}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",null,{\"id\":\"user-content-fn-6\",\"children\":[\"\\n\",[\"$\",\"p\",null,{\"children\":[\"March 24, 2016: Added two new sections documenting Laptop Mode Tools\\nand \",[\"$\",\"code\",null,{\"children\":\"acpid\"}],\". \",[\"$\",\"a\",null,{\"href\":\"#user-content-fnref-6\",\"data-footnote-backref\":true,\"className\":\"data-footnote-backref\",\"aria-label\":\"Back to content\",\"children\":\"↩\"}]]}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",null,{\"id\":\"user-content-fn-3\",\"children\":[\"\\n\",[\"$\",\"p\",null,{\"children\":[\"March 8, 2016: Added a section covering the Apple Trackpad. \",[\"$\",\"a\",null,{\"href\":\"#user-content-fnref-3\",\"data-footnote-backref\":true,\"className\":\"data-footnote-backref\",\"aria-label\":\"Back to content\",\"children\":\"↩\"}]]}],\"\\n\"]}],\"\\n\"]}],\"\\n\"]}]]}],[\"$\",\"footer\",null,{\"className\":\"license_copyright__EpMnZ\",\"children\":[\"This is licensed under a Creative Commons \",\"cc-by-nc-sa\",\" International License\"]}]]}]\n"])</script><script>self.__next_f.push([1,"c:[[\"$\",\"meta\",\"0\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}],[\"$\",\"meta\",\"1\",{\"charSet\":\"utf-8\"}],[\"$\",\"title\",\"2\",{\"children\":\"Installing (encrypted) Arch Linux on an Apple MacBook Pro\"}],[\"$\",\"meta\",\"3\",{\"name\":\"description\",\"content\":\"A howto guide for installing encrypted Arch Linux on an Apple MacBook Pro with battery optimization and the Awesome window manager.\"}],[\"$\",\"link\",\"4\",{\"rel\":\"author\",\"href\":\"https://0xadada.pub\"}],[\"$\",\"meta\",\"5\",{\"name\":\"author\",\"content\":\"0xADADA\"}],[\"$\",\"meta\",\"6\",{\"name\":\"keywords\",\"content\":\"projects,open-source,linux\"}],[\"$\",\"link\",\"7\",{\"rel\":\"alternate\",\"type\":\"application/rss+xml\",\"href\":\"https://0xadada.pub/rss.xml\"}],[\"$\",\"meta\",\"8\",{\"property\":\"og:title\",\"content\":\"Installing (encrypted) Arch Linux on an Apple MacBook Pro\"}],[\"$\",\"meta\",\"9\",{\"property\":\"og:description\",\"content\":\"A howto guide for installing encrypted Arch Linux on an Apple MacBook Pro with battery optimization and the Awesome window manager.\"}],[\"$\",\"meta\",\"10\",{\"property\":\"og:url\",\"content\":\"https://0xadada.pub/2016/03/05/install-encrypted-arch-linux-on-apple-macbook-pro/\"}],[\"$\",\"meta\",\"11\",{\"property\":\"og:site_name\",\"content\":\"0xADADA\"}],[\"$\",\"meta\",\"12\",{\"property\":\"og:locale\",\"content\":\"en_US\"}],[\"$\",\"meta\",\"13\",{\"property\":\"og:image\",\"content\":\"https://0xadada.pub/static/images/meta/avatar.svg\"}],[\"$\",\"meta\",\"14\",{\"property\":\"og:image:width\",\"content\":\"660\"}],[\"$\",\"meta\",\"15\",{\"property\":\"og:image:height\",\"content\":\"660\"}],[\"$\",\"meta\",\"16\",{\"property\":\"og:type\",\"content\":\"article\"}],[\"$\",\"meta\",\"17\",{\"name\":\"twitter:card\",\"content\":\"summary_large_image\"}],[\"$\",\"meta\",\"18\",{\"name\":\"twitter:title\",\"content\":\"Installing (encrypted) Arch Linux on an Apple MacBook Pro\"}],[\"$\",\"meta\",\"19\",{\"name\":\"twitter:description\",\"content\":\"A howto guide for installing encrypted Arch Linux on an Apple MacBook Pro with battery optimization and the Awesome window manager.\"}],[\"$\",\"meta\",\"20\",{\"name\":\"twitter:image\",\"content\":\"https://0xadada.pub/static/images/meta/avatar.svg\"}],[\"$\",\"meta\",\"21\",{\"name\":\"twitter:image:width\",\"content\":\"660\"}],[\"$\",\"meta\",\"22\",{\"name\":\"twitter:image:height\",\"content\":\"660\"}],[\"$\",\"link\",\"23\",{\"rel\":\"icon\",\"href\":\"/favicon.ico\",\"type\":\"image/x-icon\",\"sizes\":\"48x48\"}],[\"$\",\"link\",\"24\",{\"rel\":\"apple-touch-icon\",\"href\":\"/apple-icon.png?b764b3a1dbf00a82\",\"type\":\"image/png\",\"sizes\":\"180x180\"}]]\n"])</script><script>self.__next_f.push([1,"5:null\n"])</script><script>self.__next_f.push([1,""])</script></body></html>